---
title: "Projet_bis"
author: "Yasmine Boulkaid, Cassandra Jan & Illana Rabasquinho"
date: "2024-04-09"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

#Librairies
```{r, echo=FALSE}
# Définir un miroir CRAN
options(repos = "https://cloud.r-project.org")

#install.packages("FactoMineR")
#install.packages("factoextra")
#install.packages("readxl")
#install.packages("gridExtra")

library(readxl)
library(gridExtra)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(conflicted)
library(dplyr)
library(tidyverse)
library(ggrepel)
```


### Mise en forme des donnees ###
```{r}
data <- read.csv("etude_sur_les_traitements_de_lendometriose_bis.csv")
n <- length(data)

head(data)
```

### On renomme les variables ###
```{r}

### Questions préliminaires ###
names(data)[names(data) == "Étude.sur.les.traitements.de.l.endométriose"] <- "ID"
names(data)[names(data) == "X"] <- "Age"
names(data)[names(data) == "X.1"] <- "Stade"
names(data)[names(data) == "X.2"] <- "Diagnostic"
names(data)[names(data) == "X.3"] <- "Tabac"
names(data)[names(data) == "X.4"] <- "Alcool"
names(data)[names(data) == "X.5"] <- "TH"
names(data)[names(data) == "X.6"] <- "CM"
names(data)[names(data) == "X.7"] <- "Autre"
names(data)[names(data) == "X.8"] <- "Aucun"
names(data)[names(data) == "X.9"] <- "Lesquels_M"


### Questions générales ###
Renommage_Questions_Generales <- function(data,nb,TM){
  names(data)[names(data) == paste("X.", nb, sep="")] <- paste("Encore_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+1, sep="")] <- paste("Depuis_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+2, sep="")] <- paste("Debut_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+3, sep="")] <- paste("Combien_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+4, sep="")] <- paste("Pas_efficace_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+5, sep="")] <- paste("ES_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+6, sep="")] <- paste("Cout_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+7, sep="")] <- paste("Autre_Cause_Fin_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+8, sep="")] <- paste("Douleur_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+9, sep="")] <- paste("Evolution_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+10, sep="")] <- paste("Pre_op_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+11, sep="")] <- paste("Post_op_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+12, sep="")] <- paste("Pas_op_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+13, sep="")] <- paste("Prise_", TM, sep="")
  return(data)
}
  

### Effets secondaires ###
Renommage_Effets_Secondaires <- function(data,nb,TM,ES){
  names(data)[names(data) == paste("X.", nb+14, sep="")] <- paste("Subi_ES_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+15, sep="")] <- paste("Tete_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+16, sep="")] <- paste("Fatigue_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+17, sep="")] <- paste("Nausee_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+18, sep="")] <- paste("Humeur_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+19, sep="")] <- paste("Libido_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+20, sep="")] <- paste("Sang_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+21, sep="")] <- paste("Poids_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+22, sep="")] <- paste("Allergie_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+23, sep="")] <- paste("Thrombose_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+24, sep="")] <- paste("Autre_ES_", TM, sep="")
  
  a = 0
  f = 0
  
  for (i in seq_along(ES)){
    es <- ES[i]
    if (es != "Poids" && es != "Allergie"){
      names(data)[names(data) == paste("X.",nb+25+a*2, sep="")] <- paste("Apparition_",es,"_",TM, sep="")
      a <- a+1
    }
    if (es != "Thrombose" && es != "Poids" && es != "Allergie"){
      names(data)[names(data) == paste("X.",nb+26+f*2, sep="")] <- paste("Frequence_",es,"_",TM, sep="")
      f <- f+1
    }
  }
  return(data)
}


### Traitements non médicamenteux ###
Renommage_Pris_En_Parallele <- function(data,nb,TM,TNM){
  names(data)[names(data) == paste("X.", nb+38, sep="")] <- paste("Mobilite_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+39, sep="")] <- paste("Nutrition_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+40, sep="")] <- paste("Stress_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+41, sep="")] <- paste("Phyto_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+42, sep="")] <- paste("Acup_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+43, sep="")] <- paste("Hypnose_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+44, sep="")] <- paste("Bouillotte_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+45, sep="")] <- paste("CBD_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+46, sep="")] <- paste("Tens_", TM, sep="")
  names(data)[names(data) == paste("X.", nb+47, sep="")] <- paste("Aucun_", TM, sep="")
  
    for (i in seq_along(TNM)){
    tnm <- TNM[i]
    names(data)[names(data) == paste("X.",nb+48+(i-1)*4, sep="")] <- paste("Combien_",tnm,"_", TM, sep="")
    names(data)[names(data) == paste("X.",nb+49+(i-1)*4, sep="")] <- paste("Douleur_",tnm,"_", TM, sep="")
    names(data)[names(data) == paste("X.",nb+50+(i-1)*4, sep="")] <- paste("Evolution_",tnm,"_", TM, sep="")
    names(data)[names(data) == paste("X.",nb+51+(i-1)*4, sep="")] <- paste("Prise_",tnm,"_", TM, sep="")
    }
  return(data)
}


## Traitement Hormonal ##
data <- Renommage_Questions_Generales(data,10,"TH")

data <- Renommage_Effets_Secondaires(data,10,"TH",c("Tete","Fatigue","Nausee","Humeur","Libido","Sang","Poids","Allergie","Thrombose"))

data <- Renommage_Pris_En_Parallele(data,10,"TH",c("Mobilite","Nutrition","Stress","Phyto","Acup","Hypnose","Bouillotte","CBD","Tens"))


## Cure de Ménopause Artificielle ##
data <- Renommage_Questions_Generales(data,94,"CM")

data <- Renommage_Effets_Secondaires(data,94,"CM",c("Tete","Fatigue","Nausee","Humeur","Libido","Sang","Poids","Allergie","Thrombose"))

data <- Renommage_Pris_En_Parallele(data,94,"CM",c("Mobilite","Nutrition","Stress","Phyto","Acup","Hypnose","Bouillotte","CBD","Tens"))


## Traitements Non Médicamenteux Seuls ##
names(data)[names(data) == "X.178"] <- "Mobilite_NM"
names(data)[names(data) == "X.179"] <- "Nutrition_NM"
names(data)[names(data) == "X.180"] <- "Stress_NM"
names(data)[names(data) == "X.181"] <- "Phyto_NM"
names(data)[names(data) == "X.182"] <- "Acup_NM"
names(data)[names(data) == "X.183"] <- "Hypnose_NM"
names(data)[names(data) == "X.184"] <- "Bouillotte_NM"
names(data)[names(data) == "X.185"] <- "CBD_NM"
names(data)[names(data) == "X.186"] <- "Tens_NM"
names(data)[names(data) == "X.187"] <- "Aucun_NM"

data <- Renommage_Questions_Generales(data,188,"Mobilite_NM")
data <- Renommage_Questions_Generales(data,202,"Nutrition_NM")
data <- Renommage_Questions_Generales(data,216,"Stress_NM")
data <- Renommage_Questions_Generales(data,230,"Phyto_NM")
data <- Renommage_Questions_Generales(data,244,"Acup_NM")
data <- Renommage_Questions_Generales(data,258,"Hypnose_NM")
data <- Renommage_Questions_Generales(data,272,"Bouillotte_NM")
data <- Renommage_Questions_Generales(data,286,"CBD_NM")
data <- Renommage_Questions_Generales(data,300,"Tens_NM")


# Autres NM #
names(data)[names(data) == "X.314"] <- "Autres_NM"
names(data)[names(data) == "X.315"] <- "Lesquels_NM"


### Questions finales ###
names(data)[names(data) == "X.316"] <- "Remarques"
names(data)[names(data) == "X.317"] <- "Email"

head(data)

```


### Changement de la nature des variables ###
```{r}
### Supression des deux premières lignes ###
data <- data[-c(1:2), ]


### Questions préliminaires ###
data$Age = as.integer(data$Age)
data$Stade <- factor(data$Stade, levels = c("Stade I (superficielle)", "Stade II (modérée)", "Stade III (moyenne)", "Stade IV (profonde)"), ordered = TRUE)
data$Diagnostic = as.integer(data$Diagnostic)
data$Tabac <- factor(data$Tabac, levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), ordered = TRUE)
data$Alcool <- factor(data$Alcool, levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), ordered = TRUE)

TH <- ifelse(data$TH == "X", "y", "n")
data$TH <- factor(TH, levels = c("y", "n"), labels = c("yes", "no"))

CM <- ifelse(data$CM == "X", "y", "n")
data$CM <- factor(CM, levels = c("y", "n"), labels = c("yes", "no"))



### Questions générales TH ###

Depuis_TH <- ifelse(data$Depuis_TH == "", "0", data$Depuis_TH)
data$Depuis_TH <- factor(Depuis_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_TH <- ifelse(data$Combien_TH == "", "0", data$Combien_TH)
data$Combien_TH <- factor(Combien_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Duree_TH <- factor(ifelse(is.na(data$Depuis_TH), as.character(data$Combien_TH), as.character(data$Depuis_TH)))

Douleur_TH <- ifelse(data$Douleur_TH == "", "0", data$Douleur_TH)
data$Douleur_TH <- factor(Douleur_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_TH <- ifelse(data$Evolution_TH == "", "0", data$Evolution_TH)
data$Evolution_TH <- factor(Evolution_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)

Tete_TH <- ifelse(data$Tete_TH == "X", "y", "n")
data$Tete_TH <- factor(Tete_TH, levels = c("y", "n"), labels = c("yes", "no"))

Fatigue_TH <- ifelse(data$Fatigue_TH == "X", "y", "n")
data$Fatigue_TH <- factor(Fatigue_TH, levels = c("y", "n"), labels = c("yes", "no"))

Nausee_TH <- ifelse(data$Nausee_TH == "X", "y", "n")
data$Nausee_TH <- factor(Nausee_TH, levels = c("y", "n"), labels = c("yes", "no"))

Humeur_TH <- ifelse(data$Humeur_TH == "X", "y", "n")
data$Humeur_TH <- factor(Humeur_TH, levels = c("y", "n"), labels = c("yes", "no"))

Libido_TH <- ifelse(data$Libido_TH == "X", "y", "n")
data$Libido_TH <- factor(Libido_TH, levels = c("y", "n"), labels = c("yes", "no"))

Sang_TH <- ifelse(data$Sang_TH == "X", "y", "n")
data$Sang_TH <- factor(Sang_TH, levels = c("y", "n"), labels = c("yes", "no"))

Poids_TH <- ifelse(data$Poids_TH == "X", "y", "n")
data$Poids_TH <- factor(Poids_TH, levels = c("y", "n"), labels = c("yes", "no"))

Allergie_TH <- ifelse(data$Allergie_TH == "X", "y", "n")
data$Allergie_TH <- factor(Allergie_TH, levels = c("y", "n"), labels = c("yes", "no"))

Thrombose_TH <- ifelse(data$Thrombose_TH == "X", "y", "n")
data$Thrombose_TH <- factor(Thrombose_TH, levels = c("y", "n"), labels = c("yes", "no"))

### Effets secondaires TH ###
Subi_ES_TH <- ifelse(data$Subi_ES_TH == "Oui", "y", "n")
data$Subi_ES_TH <- factor(Subi_ES_TH, levels = c("y", "n"), labels = c("yes", "no"))

Apparition_Tete_TH <- ifelse(data$Apparition_Tete_TH == "", "0", data$Apparition_Tete_TH)
data$Apparition_Tete_TH <- factor(Apparition_Tete_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Tete_TH <- ifelse(data$Frequence_Tete_TH == "", "0", data$Frequence_Tete_TH)
data$Frequence_Tete_TH <- factor(Frequence_Tete_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Fatigue_TH <- ifelse(data$Apparition_Fatigue_TH == "", "0", data$Apparition_Fatigue_TH)
data$Apparition_Fatigue_TH <- factor(Apparition_Fatigue_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Fatigue_TH <- ifelse(data$Frequence_Fatigue_TH == "", "0", data$Frequence_Fatigue_TH)
data$Frequence_Fatigue_TH <- factor(Frequence_Fatigue_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Nausee_TH <- ifelse(data$Apparition_Nausee_TH == "", "0", data$Apparition_Nausee_TH)
data$Apparition_Nausee_TH <- factor(Apparition_Nausee_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Nausee_TH <- ifelse(data$Frequence_Nausee_TH == "", "0", data$Frequence_Nausee_TH)
data$Frequence_Nausee_TH <- factor(Frequence_Nausee_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Humeur_TH <- ifelse(data$Apparition_Humeur_TH == "", "0", data$Apparition_Humeur_TH)
data$Apparition_Humeur_TH <- factor(Apparition_Humeur_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Humeur_TH <- ifelse(data$Frequence_Humeur_TH == "", "0", data$Frequence_Humeur_TH)
data$Frequence_Humeur_TH <- factor(Frequence_Humeur_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Libido_TH <- ifelse(data$Apparition_Libido_TH == "", "0", data$Apparition_Libido_TH)
data$Apparition_Libido_TH <- factor(Apparition_Libido_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Libido_TH <- ifelse(data$Frequence_Libido_TH == "", "0", data$Frequence_Libido_TH)
data$Frequence_Libido_TH <- factor(Frequence_Libido_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Sang_TH <- ifelse(data$Apparition_Sang_TH == "", "0", data$Apparition_Sang_TH)
data$Apparition_Sang_TH <- factor(Apparition_Sang_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Sang_TH <- ifelse(data$Frequence_Sang_TH == "", "0", data$Frequence_Sang_TH)
data$Frequence_Sang_TH <- factor(Frequence_Sang_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Thrombose_TH <- ifelse(data$Apparition_Thrombose_TH == "", "0", data$Apparition_Thrombose_TH)
data$Apparition_Thrombose_TH <- factor(Apparition_Thrombose_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

### Traitements non médicamenteux TH ###
Mobilite_TH <- ifelse(data$Mobilite_TH == "X", "y", "n")
data$Mobilite_TH <- factor(Mobilite_TH, levels = c("y", "n"), labels = c("yes", "no"))

Nutrition_TH <- ifelse(data$Nutrition_TH == "X", "y", "n")
data$Nutrition_TH <- factor(Nutrition_TH, levels = c("y", "n"), labels = c("yes", "no"))

Stress_TH <- ifelse(data$Stress_TH == "X", "y", "n")
data$Stress_TH <- factor(Stress_TH, levels = c("y", "n"), labels = c("yes", "no"))

Phyto_TH <- ifelse(data$Phyto_TH == "X", "y", "n")
data$Phyto_TH <- factor(Phyto_TH, levels = c("y", "n"), labels = c("yes", "no"))

Acup_TH <- ifelse(data$Acup_TH == "X", "y", "n")
data$Acup_TH <- factor(Acup_TH, levels = c("y", "n"), labels = c("yes", "no"))

Hypnose_TH <- ifelse(data$Hypnose_TH == "X", "y", "n")
data$Hypnose_TH <- factor(Hypnose_TH, levels = c("y", "n"), labels = c("yes", "no"))

Bouillotte_TH <- ifelse(data$Bouillotte_TH == "X", "y", "n")
data$Bouillotte_TH <- factor(Bouillotte_TH, levels = c("y", "n"), labels = c("yes", "no"))

CBD_TH <- ifelse(data$CBD_TH == "X", "y", "n")
data$CBD_TH <- factor(CBD_TH, levels = c("y", "n"), labels = c("yes", "no"))

Tens_TH <- ifelse(data$Tens_TH == "X", "y", "n")
data$Tens_TH <- factor(Tens_TH, levels = c("y", "n"), labels = c("yes", "no"))

Aucun_TH <- ifelse(data$Aucun_TH == "X", "y", "n")
data$Aucun_TH <- factor(Aucun_TH, levels = c("y", "n"), labels = c("yes", "no"))

# Mobilité TH #
Combien_Mobilite_TH <- ifelse(data$Combien_Mobilite_TH == "", "0", data$Combien_Mobilite_TH)
data$Combien_Mobilite_TH <- factor(Combien_Mobilite_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Mobilite_TH <- ifelse(data$Douleur_Mobilite_TH == "", "0", data$Douleur_Mobilite_TH)
data$Douleur_Mobilite_TH <- factor(Douleur_Mobilite_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Mobilite_TH <- ifelse(data$Evolution_Mobilite_TH == "", "0", data$Evolution_Mobilite_TH)
data$Evolution_Mobilite_TH <- factor(Evolution_Mobilite_TH, levels = c("Augmentation des lésions", "Pas d'impact sur les lésions", "Réduction des lésions", "Ne sais pas"), ordered = FALSE)


# Nutrition TH #
Combien_Nutrition_TH <- ifelse(data$Combien_Nutrition_TH == "", "0", data$Combien_Nutrition_TH)
data$Combien_Nutrition_TH <- factor(Combien_Nutrition_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Nutrition_TH <- ifelse(data$Douleur_Nutrition_TH == "", "0", data$Douleur_Nutrition_TH)
data$Douleur_Nutrition_TH <- factor(Douleur_Nutrition_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Nutrition_TH <- ifelse(data$Evolution_Nutrition_TH == "", "0", data$Evolution_Nutrition_TH)
data$Evolution_Nutrition_TH <- factor(Evolution_Nutrition_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Stress TH #
Combien_Stress_TH <- ifelse(data$Combien_Stress_TH == "", "0", data$Combien_Stress_TH)
data$Combien_Stress_TH <- factor(Combien_Stress_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Stress_TH <- ifelse(data$Douleur_Stress_TH == "", "0", data$Douleur_Stress_TH)
data$Douleur_Stress_TH <- factor(Douleur_Stress_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Stress_TH <- ifelse(data$Evolution_Stress_TH == "", "0", data$Evolution_Stress_TH)
data$Evolution_Stress_TH <- factor(Evolution_Stress_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Phyto TH #
Combien_Phyto_TH <- ifelse(data$Combien_Phyto_TH == "", "0", data$Combien_Phyto_TH)
data$Combien_Phyto_TH <- factor(Combien_Phyto_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Phyto_TH <- ifelse(data$Douleur_Phyto_TH == "", "0", data$Douleur_Phyto_TH)
data$Douleur_Phyto_TH <- factor(Douleur_Phyto_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Phyto_TH <- ifelse(data$Evolution_Phyto_TH == "", "0", data$Evolution_Phyto_TH)
data$Evolution_Phyto_TH <- factor(Evolution_Phyto_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Acup TH #
Combien_Acup_TH <- ifelse(data$Combien_Acup_TH == "", "0", data$Combien_Acup_TH)
data$Combien_Acup_TH <- factor(Combien_Acup_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Acup_TH <- ifelse(data$Douleur_Acup_TH == "", "0", data$Douleur_Acup_TH)
data$Douleur_Acup_TH <- factor(Douleur_Acup_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Acup_TH <- ifelse(data$Evolution_Acup_TH == "", "0", data$Evolution_Acup_TH)
data$Evolution_Acup_TH <- factor(Evolution_Acup_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)



# Hypnose TH #
Combien_Hypnose_TH <- ifelse(data$Combien_Hypnose_TH == "", "0", data$Combien_Hypnose_TH)
data$Combien_Hypnose_TH <- factor(Combien_Hypnose_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Hypnose_TH <- ifelse(data$Douleur_Hypnose_TH == "", "0", data$Douleur_Hypnose_TH)
data$Douleur_Hypnose_TH <- factor(Douleur_Hypnose_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Hypnose_TH <- ifelse(data$Evolution_Hypnose_TH == "", "0", data$Evolution_Hypnose_TH)
data$Evolution_Hypnose_TH <- factor(Evolution_Hypnose_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Bouillotte TH #
Combien_Bouillotte_TH <- ifelse(data$Combien_Bouillotte_TH == "", "0", data$Combien_Bouillotte_TH)
data$Combien_Bouillotte_TH <- factor(Combien_Bouillotte_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Bouillotte_TH <- ifelse(data$Douleur_Bouillotte_TH == "", "0", data$Douleur_Bouillotte_TH)
data$Douleur_Bouillotte_TH <- factor(Douleur_Bouillotte_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Bouillotte_TH <- ifelse(data$Evolution_Bouillotte_TH == "", "0", data$Evolution_Bouillotte_TH)
data$Evolution_Bouillotte_TH <- factor(Evolution_Bouillotte_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# CBD TH #
Combien_CBD_TH <- ifelse(data$Combien_CBD_TH == "", "0", data$Combien_CBD_TH)
data$Combien_CBD_TH <- factor(Combien_CBD_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_CBD_TH <- ifelse(data$Douleur_CBD_TH == "", "0", data$Douleur_CBD_TH)
data$Douleur_CBD_TH <- factor(Douleur_CBD_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_CBD_TH <- ifelse(data$Evolution_CBD_TH == "", "0", data$Evolution_CBD_TH)
data$Evolution_CBD_TH <- factor(Evolution_CBD_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Tens TH #
Combien_Tens_TH <- ifelse(data$Combien_Tens_TH == "", "0", data$Combien_Tens_TH)
data$Combien_Tens_TH <- factor(Combien_Tens_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Tens_TH <- ifelse(data$Douleur_Tens_TH == "", "0", data$Douleur_Tens_TH)
data$Douleur_Tens_TH <- factor(Douleur_Tens_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Tens_TH <- ifelse(data$Evolution_Tens_TH == "", "0", data$Evolution_Tens_TH)
data$Evolution_Tens_TH <- factor(Evolution_Tens_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)

Depuis_CM <- ifelse(data$Depuis_CM == "", "0", data$Depuis_CM)
data$Depuis_CM <- factor(Depuis_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_CM <- ifelse(data$Combien_CM == "", "0", data$Combien_CM)
data$Combien_CM <- factor(Combien_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Duree_CM <- factor(ifelse(is.na(data$Depuis_CM), as.character(data$Combien_CM), as.character(data$Depuis_CM)))

Douleur_CM <- ifelse(data$Douleur_CM == "", "0", data$Douleur_CM)
data$Douleur_CM <- factor(Douleur_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_CM <- ifelse(data$Evolution_CM == "", "0", data$Evolution_CM)
data$Evolution_CM <- factor(Evolution_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)

### Effets secondaires CM ###
Subi_ES_CM <- ifelse(data$Subi_ES_CM == "Oui", "y", "n")
data$Subi_ES_CM <- factor(Subi_ES_CM, levels = c("y", "n"), labels = c("yes", "no"))

Tete_CM <- ifelse(data$Tete_CM == "X", "y", "n")
data$Tete_CM <- factor(Tete_CM, levels = c("y", "n"), labels = c("yes", "no"))

Fatigue_CM <- ifelse(data$Fatigue_CM == "X", "y", "n")
data$Fatigue_CM <- factor(Fatigue_CM, levels = c("y", "n"), labels = c("yes", "no"))

Nausee_CM <- ifelse(data$Nausee_CM == "X", "y", "n")
data$Nausee_CM <- factor(Nausee_CM, levels = c("y", "n"), labels = c("yes", "no"))

Humeur_CM <- ifelse(data$Humeur_CM == "X", "y", "n")
data$Humeur_CM <- factor(Humeur_CM, levels = c("y", "n"), labels = c("yes", "no"))

Libido_CM <- ifelse(data$Libido_CM == "X", "y", "n")
data$Libido_CM <- factor(Libido_CM, levels = c("y", "n"), labels = c("yes", "no"))

Sang_CM <- ifelse(data$Sang_CM == "X", "y", "n")
data$Sang_CM <- factor(Sang_CM, levels = c("y", "n"), labels = c("yes", "no"))

Poids_CM <- ifelse(data$Poids_CM == "X", "y", "n")
data$Poids_CM <- factor(Poids_CM, levels = c("y", "n"), labels = c("yes", "no"))

Allergie_CM <- ifelse(data$Allergie_CM == "X", "y", "n")
data$Allergie_CM <- factor(Allergie_CM, levels = c("y", "n"), labels = c("yes", "no"))

Thrombose_CM <- ifelse(data$Thrombose_CM == "X", "y", "n")
data$Thrombose_CM <- factor(Thrombose_CM, levels = c("y", "n"), labels = c("yes", "no"))

Apparition_Tete_CM <- ifelse(data$Apparition_Tete_CM == "", "0", data$Apparition_Tete_CM)
data$Apparition_Tete_CM <- factor(Apparition_Tete_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Tete_CM <- ifelse(data$Frequence_Tete_CM == "", "0", data$Frequence_Tete_CM)
data$Frequence_Tete_CM <- factor(Frequence_Tete_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Fatigue_CM <- ifelse(data$Apparition_Fatigue_CM == "", "0", data$Apparition_Fatigue_CM)
data$Apparition_Fatigue_CM <- factor(Apparition_Fatigue_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Fatigue_CM <- ifelse(data$Frequence_Fatigue_CM == "", "0", data$Frequence_Fatigue_CM)
data$Frequence_Fatigue_CM <- factor(Frequence_Fatigue_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Nausee_CM <- ifelse(data$Apparition_Nausee_CM == "", "0", data$Apparition_Nausee_CM)
data$Apparition_Nausee_CM <- factor(Apparition_Nausee_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Nausee_CM <- ifelse(data$Frequence_Nausee_CM == "", "0", data$Frequence_Nausee_CM)
data$Frequence_Nausee_CM <- factor(Frequence_Nausee_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Humeur_CM <- ifelse(data$Apparition_Humeur_CM == "", "0", data$Apparition_Humeur_CM)
data$Apparition_Humeur_CM <- factor(Apparition_Humeur_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Humeur_CM <- ifelse(data$Frequence_Humeur_CM == "", "0", data$Frequence_Humeur_CM)
data$Frequence_Humeur_CM <- factor(Frequence_Humeur_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Libido_CM <- ifelse(data$Apparition_Libido_CM == "", "0", data$Apparition_Libido_CM)
data$Apparition_Libido_CM <- factor(Apparition_Libido_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Libido_CM <- ifelse(data$Frequence_Libido_CM == "", "0", data$Frequence_Libido_CM)
data$Frequence_Libido_CM <- factor(Frequence_Libido_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Sang_CM <- ifelse(data$Apparition_Sang_CM == "", "0", data$Apparition_Sang_CM)
data$Apparition_Sang_CM <- factor(Apparition_Sang_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Sang_CM <- ifelse(data$Frequence_Sang_CM == "", "0", data$Frequence_Sang_CM)
data$Frequence_Sang_CM <- factor(Frequence_Sang_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Thrombose_CM <- ifelse(data$Apparition_Thrombose_CM == "", "0", data$Apparition_Thrombose_CM)
data$Apparition_Thrombose_CM <- factor(Apparition_Thrombose_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

### Traitements non médicamenteux CM ###
Mobilite_CM <- ifelse(data$Mobilite_CM == "X", "y", "n")
data$Mobilite_CM <- factor(Mobilite_CM, levels = c("y", "n"), labels = c("yes", "no"))

Nutrition_CM <- ifelse(data$Nutrition_CM == "X", "y", "n")
data$Nutrition_CM <- factor(Nutrition_CM, levels = c("y", "n"), labels = c("yes", "no"))

Stress_CM <- ifelse(data$Stress_CM == "X", "y", "n")
data$Stress_CM <- factor(Stress_CM, levels = c("y", "n"), labels = c("yes", "no"))

Phyto_CM <- ifelse(data$Phyto_CM == "X", "y", "n")
data$Phyto_CM <- factor(Phyto_CM, levels = c("y", "n"), labels = c("yes", "no"))

Acup_CM <- ifelse(data$Acup_CM == "X", "y", "n")
data$Acup_CM <- factor(Acup_CM, levels = c("y", "n"), labels = c("yes", "no"))

Hypnose_CM <- ifelse(data$Hypnose_CM == "X", "y", "n")
data$Hypnose_CM <- factor(Hypnose_CM, levels = c("y", "n"), labels = c("yes", "no"))

Bouillotte_CM <- ifelse(data$Bouillotte_CM == "X", "y", "n")
data$Bouillotte_CM <- factor(Bouillotte_CM, levels = c("y", "n"), labels = c("yes", "no"))

CBD_CM <- ifelse(data$CBD_CM == "X", "y", "n")
data$CBD_CM <- factor(CBD_CM, levels = c("y", "n"), labels = c("yes", "no"))

Tens_CM <- ifelse(data$Tens_CM == "X", "y", "n")
data$Tens_CM <- factor(Tens_CM, levels = c("y", "n"), labels = c("yes", "no"))

Aucun_CM <- ifelse(data$Aucun_CM == "X", "y", "n")
data$Aucun_CM <- factor(Aucun_CM, levels = c("y", "n"), labels = c("yes", "no"))

# Mobilité CM #
Combien_Mobilite_CM <- ifelse(data$Combien_Mobilite_CM == "", "0", data$Combien_Mobilite_CM)
data$Combien_Mobilite_CM <- factor(Combien_Mobilite_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Mobilite_CM <- ifelse(data$Douleur_Mobilite_CM == "", "0", data$Douleur_Mobilite_CM)
data$Douleur_Mobilite_CM <- factor(Douleur_Mobilite_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Mobilite_CM <- ifelse(data$Evolution_Mobilite_CM == "", "0", data$Evolution_Mobilite_CM)
data$Evolution_Mobilite_CM <- factor(Evolution_Mobilite_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Nutrition CM #
Combien_Nutrition_CM <- ifelse(data$Combien_Nutrition_CM == "", "0", data$Combien_Nutrition_CM)
data$Combien_Nutrition_CM <- factor(Combien_Nutrition_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Nutrition_CM <- ifelse(data$Douleur_Nutrition_CM == "", "0", data$Douleur_Nutrition_CM)
data$Douleur_Nutrition_CM <- factor(Douleur_Nutrition_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Nutrition_CM <- ifelse(data$Evolution_Nutrition_CM == "", "0", data$Evolution_Nutrition_CM)
data$Evolution_Nutrition_CM <- factor(Evolution_Nutrition_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Stress CM #
Combien_Stress_CM <- ifelse(data$Combien_Stress_CM == "", "0", data$Combien_Stress_CM)
data$Combien_Stress_CM <- factor(Combien_Stress_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Stress_CM <- ifelse(data$Douleur_Stress_CM == "", "0", data$Douleur_Stress_CM)
data$Douleur_Stress_CM <- factor(Douleur_Stress_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Stress_CM <- ifelse(data$Evolution_Stress_CM == "", "0", data$Evolution_Stress_CM)
data$Evolution_Stress_CM <- factor(Evolution_Stress_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Phyto CM #
Combien_Phyto_CM <- ifelse(data$Combien_Phyto_CM == "", "0", data$Combien_Phyto_CM)
data$Combien_Phyto_CM <- factor(Combien_Phyto_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Phyto_CM <- ifelse(data$Douleur_Phyto_CM == "", "0", data$Douleur_Phyto_CM)
data$Douleur_Phyto_CM <- factor(Douleur_Phyto_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Phyto_CM <- ifelse(data$Evolution_Phyto_CM == "", "0", data$Evolution_Phyto_CM)
data$Evolution_Phyto_CM <- factor(Evolution_Phyto_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Acup CM #
Combien_Acup_CM <- ifelse(data$Combien_Acup_CM == "", "0", data$Combien_Acup_CM)
data$Combien_Acup_CM <- factor(Combien_Acup_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Acup_CM <- ifelse(data$Douleur_Acup_CM == "", "0", data$Douleur_Acup_CM)
data$Douleur_Acup_CM <- factor(Douleur_Acup_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Acup_CM <- ifelse(data$Evolution_Acup_CM == "", "0", data$Evolution_Acup_CM)
data$Evolution_Acup_CM <- factor(Evolution_Acup_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Hypnose CM #
Combien_Hypnose_CM <- ifelse(data$Combien_Hypnose_CM == "", "0", data$Combien_Hypnose_CM)
data$Combien_Hypnose_CM <- factor(Combien_Hypnose_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Hypnose_CM <- ifelse(data$Douleur_Hypnose_CM == "", "0", data$Douleur_Hypnose_CM)
data$Douleur_Hypnose_CM <- factor(Douleur_Hypnose_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Hypnose_CM <- ifelse(data$Evolution_Hypnose_CM == "", "0", data$Evolution_Hypnose_CM)
data$Evolution_Hypnose_CM <- factor(Evolution_Hypnose_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Bouillotte CM #
Combien_Bouillotte_CM <- ifelse(data$Combien_Bouillotte_CM == "", "0", data$Combien_Bouillotte_CM)
data$Combien_Bouillotte_CM <- factor(Combien_Bouillotte_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Bouillotte_CM <- ifelse(data$Douleur_Bouillotte_CM == "", "0", data$Douleur_Bouillotte_CM)
data$Douleur_Bouillotte_CM <- factor(Douleur_Bouillotte_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Bouillotte_CM <- ifelse(data$Evolution_Bouillotte_CM == "", "0", data$Evolution_Bouillotte_CM)
data$Evolution_Bouillotte_CM <- factor(Evolution_Bouillotte_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# CBD CM #
Combien_CBD_CM <- ifelse(data$Combien_CBD_CM == "", "0", data$Combien_CBD_CM)
data$Combien_CBD_CM <- factor(Combien_CBD_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_CBD_CM <- ifelse(data$Douleur_CBD_CM == "", "0", data$Douleur_CBD_CM)
data$Douleur_CBD_CM <- factor(Douleur_CBD_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_CBD_CM <- ifelse(data$Evolution_CBD_CM == "", "0", data$Evolution_CBD_CM)
data$Evolution_CBD_CM <- factor(Evolution_CBD_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Tens CM #
Combien_Tens_CM <- ifelse(data$Combien_Tens_CM == "", "0", data$Combien_Tens_CM)
data$Combien_Tens_CM <- factor(Combien_Tens_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Tens_CM <- ifelse(data$Douleur_Tens_CM == "", "0", data$Douleur_Tens_CM)
data$Douleur_Tens_CM <- factor(Douleur_Tens_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = FALSE)

Evolution_Tens_CM <- ifelse(data$Evolution_Tens_CM == "", "0", data$Evolution_Tens_CM)
data$Evolution_Tens_CM <- factor(Evolution_Tens_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)

### Traitements non médicamenteux seuls ###
Mobilite_NM <- ifelse(data$Mobilite_NM == "X", "y", "n")
data$Mobilite_NM <- factor(Mobilite_NM, levels = c("y", "n"), labels = c("yes", "no"))

Nutrition_NM <- ifelse(data$Nutrition_NM == "X", "y", "n")
data$Nutrition_NM <- factor(Nutrition_NM, levels = c("y", "n"), labels = c("yes", "no"))

Stress_NM <- ifelse(data$Stress_NM == "X", "y", "n")
data$Stress_NM <- factor(Stress_NM, levels = c("y", "n"), labels = c("yes", "no"))

Phyto_NM <- ifelse(data$Phyto_NM == "X", "y", "n")
data$Phyto_NM <- factor(Phyto_NM, levels = c("y", "n"), labels = c("yes", "no"))

Acup_NM <- ifelse(data$Acup_NM == "X", "y", "n")
data$Acup_NM <- factor(Acup_NM, levels = c("y", "n"), labels = c("yes", "no"))

Hypnose_NM <- ifelse(data$Hypnose_NM == "X", "y", "n")
data$Hypnose_NM <- factor(Hypnose_NM, levels = c("y", "n"), labels = c("yes", "no"))

Bouillotte_NM <- ifelse(data$Bouillotte_NM == "X", "y", "n")
data$Bouillotte_NM <- factor(Bouillotte_NM, levels = c("y", "n"), labels = c("yes", "no"))

CBD_NM <- ifelse(data$CBD_NM == "X", "y", "n")
data$CBD_NM <- factor(CBD_NM, levels = c("y", "n"), labels = c("yes", "no"))

Tens_NM <- ifelse(data$Tens_NM == "X", "y", "n")
data$Tens_NM <- factor(Tens_NM, levels = c("y", "n"), labels = c("yes", "no"))

Aucun_NM <- ifelse(data$Aucun_NM == "X", "y", "n")
data$Aucun_NM <- factor(Aucun_NM, levels = c("y", "n"), labels = c("yes", "no"))


# Mobilité NM #

Depuis_Mobilite_NM <- ifelse(data$Depuis_Mobilite_NM == "", "0", data$Depuis_Mobilite_NM)
data$Depuis_Mobilite_NM <- factor(Depuis_Mobilite_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Mobilite_NM <- ifelse(data$Combien_Mobilite_NM == "", "0", data$Combien_Mobilite_NM)
data$Combien_Mobilite_NM <- factor(Combien_Mobilite_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Mobilite_NM <- ifelse(data$Douleur_Mobilite_NM == "", "0", data$Douleur_Mobilite_NM)
data$Douleur_Mobilite_NM <- factor(Douleur_Mobilite_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Mobilite_NM <- ifelse(data$Evolution_Mobilite_NM == "", "0", data$Evolution_Mobilite_NM)
data$Evolution_Mobilite_NM <- factor(Evolution_Mobilite_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)

# Nutrition NM #

Depuis_Nutrition_NM <- ifelse(data$Depuis_Nutrition_NM == "", "0", data$Depuis_Nutrition_NM)
data$Depuis_Nutrition_NM <- factor(Depuis_Nutrition_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Nutrition_NM <- ifelse(data$Combien_Nutrition_NM == "", "0", data$Combien_Nutrition_NM)
data$Combien_Nutrition_NM <- factor(Combien_Nutrition_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Nutrition_NM <- ifelse(data$Douleur_Nutrition_NM == "", "0", data$Douleur_Nutrition_NM)
data$Douleur_Nutrition_NM <- factor(Douleur_Nutrition_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Nutrition_NM <- ifelse(data$Evolution_Nutrition_NM == "", "0", data$Evolution_Nutrition_NM)
data$Evolution_Nutrition_NM <- factor(Evolution_Nutrition_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Stress NM #

Depuis_Stress_NM <- ifelse(data$Depuis_Stress_NM == "", "0", data$Depuis_Stress_NM)
data$Depuis_Stress_NM <- factor(Depuis_Stress_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Stress_NM <- ifelse(data$Combien_Stress_NM == "", "0", data$Combien_Stress_NM)
data$Combien_Stress_NM <- factor(Combien_Stress_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Stress_NM <- ifelse(data$Douleur_Stress_NM == "", "0", data$Douleur_Stress_NM)
data$Douleur_Stress_NM <- factor(Douleur_Stress_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Stress_NM <- ifelse(data$Evolution_Stress_NM == "", "0", data$Evolution_Stress_NM)
data$Evolution_Stress_NM <- factor(Evolution_Stress_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Phyto NM #

Depuis_Phyto_NM <- ifelse(data$Depuis_Phyto_NM == "", "0", data$Depuis_Phyto_NM)
data$Depuis_Phyto_NM <- factor(Depuis_Phyto_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Phyto_NM <- ifelse(data$Combien_Phyto_NM == "", "0", data$Combien_Phyto_NM)
data$Combien_Phyto_NM <- factor(Combien_Phyto_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Phyto_NM <- ifelse(data$Douleur_Phyto_NM == "", "0", data$Douleur_Phyto_NM)
data$Douleur_Phyto_NM <- factor(Douleur_Phyto_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Phyto_NM <- ifelse(data$Evolution_Phyto_NM == "", "0", data$Evolution_Phyto_NM)
data$Evolution_Phyto_NM <- factor(Evolution_Phyto_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Acup NM #

Depuis_Acup_NM <- ifelse(data$Depuis_Acup_NM == "", "0", data$Depuis_Acup_NM)
data$Depuis_Acup_NM <- factor(Depuis_Acup_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Acup_NM <- ifelse(data$Combien_Acup_NM == "", "0", data$Combien_Acup_NM)
data$Combien_Acup_NM <- factor(Combien_Acup_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Acup_NM <- ifelse(data$Douleur_Acup_NM == "", "0", data$Douleur_Acup_NM)
data$Douleur_Acup_NM <- factor(Douleur_Acup_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Acup_NM <- ifelse(data$Evolution_Acup_NM == "", "0", data$Evolution_Acup_NM)
data$Evolution_Acup_NM <- factor(Evolution_Acup_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Hypnose NM #

Depuis_Hypnose_NM <- ifelse(data$Depuis_Hypnose_NM == "", "0", data$Depuis_Hypnose_NM)
data$Depuis_Hypnose_NM <- factor(Depuis_Hypnose_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Hypnose_NM <- ifelse(data$Combien_Hypnose_NM == "", "0", data$Combien_Hypnose_NM)
data$Combien_Hypnose_NM <- factor(Combien_Hypnose_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Hypnose_NM <- ifelse(data$Douleur_Hypnose_NM == "", "0", data$Douleur_Hypnose_NM)
data$Douleur_Hypnose_NM <- factor(Douleur_Hypnose_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Hypnose_NM <- ifelse(data$Evolution_Hypnose_NM == "", "0", data$Evolution_Hypnose_NM)
data$Evolution_Hypnose_NM <- factor(Evolution_Hypnose_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Bouillotte NM #

Depuis_Bouillotte_NM <- ifelse(data$Depuis_Bouillotte_NM == "", "0", data$Depuis_Bouillotte_NM)
data$Depuis_Bouillotte_NM <- factor(Depuis_Bouillotte_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Bouillotte_NM <- ifelse(data$Combien_Bouillotte_NM == "", "0", data$Combien_Bouillotte_NM)
data$Combien_Bouillotte_NM <- factor(Combien_Bouillotte_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Bouillotte_NM <- ifelse(data$Douleur_Bouillotte_NM == "", "0", data$Douleur_Bouillotte_NM)
data$Douleur_Bouillotte_NM <- factor(Douleur_Bouillotte_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Bouillotte_NM <- ifelse(data$Evolution_Bouillotte_NM == "", "0", data$Evolution_Bouillotte_NM)
data$Evolution_Bouillotte_NM <- factor(Evolution_Bouillotte_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# CBD NM #

Depuis_CBD_NM <- ifelse(data$Depuis_CBD_NM == "", "0", data$Depuis_CBD_NM)
data$Depuis_CBD_NM <- factor(Depuis_CBD_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_CBD_NM <- ifelse(data$Combien_CBD_NM == "", "0", data$Combien_CBD_NM)
data$Combien_CBD_NM <- factor(Combien_CBD_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)


Douleur_CBD_NM <- ifelse(data$Douleur_CBD_NM == "", "0", data$Douleur_CBD_NM)
data$Douleur_CBD_NM <- factor(Douleur_CBD_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_CBD_NM <- ifelse(data$Evolution_CBD_NM == "", "0", data$Evolution_CBD_NM)
data$Evolution_CBD_NM <- factor(Evolution_CBD_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)


# Tens NM #

Depuis_Tens_NM <- ifelse(data$Depuis_Tens_NM == "", "0", data$Depuis_Tens_NM)
data$Depuis_Tens_NM <- factor(Depuis_Tens_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Combien_Tens_NM <- ifelse(data$Combien_Tens_NM == "", "0", data$Combien_Tens_NM)
data$Combien_Tens_NM <- factor(Combien_Tens_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = FALSE)

Douleur_Tens_NM <- ifelse(data$Douleur_Tens_NM == "", "0", data$Douleur_Tens_NM)
data$Douleur_Tens_NM <- factor(Douleur_Tens_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = FALSE)

Evolution_Tens_NM <- ifelse(data$Evolution_Tens_NM == "", "0", data$Evolution_Tens_NM)
data$Evolution_Tens_NM <- factor(Evolution_Tens_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = FALSE)
```


### Ajout des ID ####
```{r}
library(dplyr)

### On réaffecte les identifiants par numéros croissants en commençant à 1 ###

data <- data %>%
  mutate(ID = row_number())  

data$ID <- as.integer(data$ID)

head(data)
```


### Ajour d'un compteur ###
```{r}
data <- data %>%
  mutate(Compt = 0) %>%
  select(ID, Compt, everything())

for (i in 1:nrow(data)){
  if(data[i,"TH"] == 'yes'){
    data[i,"Compt"] <- data[i,"Compt"] + 1
  }
  if(data[i,"CM"] == 'yes'){
    data[i,"Compt"] <- data[i,"Compt"] + 1
  }
  if(data[i,"Aucun_NM"] == 'no'){
    data[i,"Compt"] <- data[i,"Compt"] + 1
  }
}

head(data)
```


### Creation de 3 dataframes pour les trois types d'individus : TH, CM, NM ####
```{r}
Data1 <- data[data$TH == 'yes', ]
Data2 <- data[data$CM == 'yes', ]
Data3 <- data[data$Aucun_NM == 'no', ]
```


### Creation des vecteurs de Duree de prise du traitement ####
```{r}
Duree_M <- factor(ifelse(is.na(Data3$Depuis_Mobilite_NM), as.character(data$Combien_Mobilite_NM), as.character(data$Depuis_Mobilite_NM)))


Duree_N <- factor(ifelse(is.na(Data3$Depuis_Nutrition_NM), as.character(data$Combien_Nutrition_NM), as.character(data$Depuis_Nutrition_NM)))


Duree_S <- factor(ifelse(is.na(Data3$Depuis_Stress_NM), as.character(data$Combien_Stress_NM), as.character(data$Depuis_Stress_NM)))


Duree_P <- factor(ifelse(is.na(Data3$Depuis_Phyto_NM), as.character(data$Combien_Phyto_NM), as.character(data$Depuis_Phyto_NM)))


Duree_A <- factor(ifelse(is.na(Data3$Depuis_Acup_NM), as.character(data$Combien_Acup_NM), as.character(data$Depuis_Acup_NM)))


Duree_H <- factor(ifelse(is.na(Data3$Depuis_Hypnose_NM), as.character(data$Combien_Hypnose_NM), as.character(data$Depuis_Hypnose_NM)))


Duree_B <- factor(ifelse(is.na(Data3$Depuis_Bouillotte_NM), as.character(data$Combien_Bouillotte_NM), as.character(data$Depuis_Bouillotte_NM)))

Duree_C <- factor(ifelse(is.na(Data3$Depuis_CBD_NM), as.character(data$Combien_CBD_NM), as.character(data$Depuis_CBD_NM)))

Duree_T <- factor(ifelse(is.na(Data3$Depuis_Tens_NM), as.character(data$Combien_Tens_NM), as.character(data$Depuis_Tens_NM)))

```


### Creation de 3 dataframe ayant tous les memes noms de variables : reaffectation des variables dans les bonnes colonnes pour l'AMC ###
```{r}
data1 <- data.frame(
  ID = Data1$ID,
  Compt= Data1$Compt,
  Age = Data1$Age,
  Stade = Data1$Stade,
  Alcool = Data1$Alcool,
  Tabac = Data1$Tabac,
  TM = "TH",
  Duree_TM = Duree_TH[complete.cases(Duree_TH)],
  Douleur_TM = Data1$Douleur_TH,
  Evolution_TM = Data1$Evolution_TH,
  Subi_ES = Data1$Subi_ES_TH,
  Tete = Data1$Tete_TH,
  Apparition_Tete = Data1$Apparition_Tete_TH,
  Freq_Tete = Data1$Frequence_Tete_TH,
  Fatigue = Data1$Fatigue_TH,
  Apparition_Fatigue = Data1$Apparition_Fatigue_TH,
  Freq_Fatigue = Data1$Frequence_Fatigue_TH,
  Nausee = Data1$Nausee_TH,
  Apparition_Nausee = Data1$Apparition_Nausee_TH,
  Freq_Nausee = Data1$Frequence_Nausee_TH,
  Humeur = Data1$Humeur_TH,
  Apparition_Humeur = Data1$Apparition_Humeur_TH,
  Freq_Humeur = Data1$Frequence_Humeur_TH,
  Libido = Data1$Libido_TH,
  Apparition_Libido = Data1$Apparition_Libido_TH,
  Freq_Libido = Data1$Frequence_Libido_TH,
  Sang = Data1$Sang_TH,
  Apparition_Sang = Data1$Apparition_Sang_TH,
  Freq_Sang = Data1$Frequence_Sang_TH,
  Poids = Data1$Poids_TH,
  Allergie = Data1$Allergie_TH,
  Thrombose = Data1$Thrombose_TH,
  Mobilite = Data1$Mobilite_TH,
  Duree_Mobilite = Data1$Combien_Mobilite_TH,
  Douleur_Mobilite = Data1$Douleur_Mobilite_TH,
  Evolution_Mobilite = Data1$Evolution_Mobilite_TH,
  Nutrition = Data1$Nutrition_TH,
  Duree_Nutrition = Data1$Combien_Nutrition_TH,
  Douleur_Nutrition = Data1$Douleur_Nutrition_TH,
  Evolution_Nutrition = Data1$Evolution_Nutrition_TH,
  Stress = Data1$Stress_TH,
  Duree_Stress = Data1$Combien_Stress_TH,
  Douleur_Stress = Data1$Douleur_Stress_TH,
  Evolution_Stress = Data1$Evolution_Stress_TH,
  Phyto = Data1$Phyto_TH,
  Duree_Phyto = Data1$Combien_Phyto_TH,
  Douleur_Phyto = Data1$Douleur_Phyto_TH,
  Evolution_Phyto = Data1$Evolution_Phyto_TH,
  Acup = Data1$Acup_TH,
  Duree_Acup = Data1$Combien_Acup_TH,
  Douleur_Acup = Data1$Douleur_Acup_TH,
  Evolution_Acup = Data1$Evolution_Acup_TH,
  Hypnose = Data1$Hypnose_TH,
  Duree_Hypnose = Data1$Combien_Hypnose_TH,
  Douleur_Hypnose = Data1$Douleur_Hypnose_TH,
  Evolution_Hypnose = Data1$Evolution_Hypnose_TH,
  Bouillotte = Data1$Bouillotte_TH,
  Duree_Bouillotte = Data1$Combien_Hypnose_TH,
  Douleur_Bouillotte = Data1$Douleur_Bouillotte_TH,
  Evolution_Bouillotte= Data1$Evolution_Bouillotte_TH,
  CBD = Data1$CBD_TH,
  Duree_CBD = Data1$Combien_CBD_TH,
  Douleur_CBD = Data1$Douleur_CBD_TH,
  Evolution_CBD = Data1$Evolution_CBD_TH,
  Tens = Data1$Tens_TH,
  Duree_Tens = Data1$Combien_Tens_TH,
  Douleur_Tens = Data1$Douleur_Tens_TH,
  Evolution_Tens = Data1$Evolution_Tens_TH,
  Aucun = Data1$Aucun_TH
)
```

```{r}
data2 <- data.frame(
  ID = Data2$ID,
  Compt= Data2$Compt,
  Age = Data2$Age,
  Stade = Data2$Stade,
  Alcool = Data2$Alcool,
  Tabac = Data2$Tabac,
  TM = "CM",
  Duree_TM = Duree_CM[complete.cases(Duree_CM)],
  Douleur_TM = Data2$Douleur_CM,
  Evolution_TM = Data2$Evolution_CM,
  Subi_ES = Data2$Subi_ES_CM,
  Tete = Data2$Tete_CM,
  Apparition_Tete = Data2$Apparition_Tete_CM,
  Freq_Tete = Data2$Frequence_Tete_CM,
  Fatigue = Data2$Fatigue_CM,
  Apparition_Fatigue = Data2$Apparition_Fatigue_CM,
  Freq_Fatigue = Data2$Frequence_Fatigue_CM,
  Nausee = Data2$Nausee_CM,
  Apparition_Nausee = Data2$Apparition_Nausee_CM,
  Freq_Nausee = Data2$Frequence_Nausee_CM,
  Humeur = Data2$Humeur_CM,
  Apparition_Humeur = Data2$Apparition_Humeur_CM,
  Freq_Humeur = Data2$Frequence_Humeur_CM,
  Libido = Data2$Libido_CM,
  Apparition_Libido = Data2$Apparition_Libido_CM,
  Freq_Libido = Data2$Frequence_Libido_CM,
  Sang = Data2$Sang_CM,
  Apparition_Sang = Data2$Apparition_Sang_CM,
  Freq_Sang = Data2$Frequence_Sang_CM,
  Poids = Data2$Poids_CM,
  Allergie = Data2$Allergie_CM,
  Thrombose = Data2$Thrombose_CM,
  Mobilite = Data2$Mobilite_CM,
  Duree_Mobilite = Data2$Combien_Mobilite_CM,
  Douleur_Mobilite = Data2$Douleur_Mobilite_CM,
  Evolution_Mobilite = Data2$Evolution_Mobilite_CM,
  Nutrition = Data2$Nutrition_CM,
  Duree_Nutrition = Data2$Combien_Nutrition_CM,
  Douleur_Nutrition = Data2$Douleur_Nutrition_CM,
  Evolution_Nutrition = Data2$Evolution_Nutrition_CM,
  Stress = Data2$Stress_CM,
  Duree_Stress = Data2$Combien_Stress_CM,
  Douleur_Stress = Data2$Douleur_Stress_CM,
  Evolution_Stress = Data2$Evolution_Stress_CM,
  Phyto = Data2$Phyto_CM,
  Duree_Phyto = Data2$Combien_Phyto_CM,
  Douleur_Phyto = Data2$Douleur_Phyto_CM,
  Evolution_Phyto = Data2$Evolution_Phyto_CM,
  Acup = Data2$Acup_CM,
  Duree_Acup = Data2$Combien_Acup_CM,
  Douleur_Acup = Data2$Douleur_Acup_CM,
  Evolution_Acup = Data2$Evolution_Acup_CM,
  Hypnose = Data2$Hypnose_CM,
  Duree_Hypnose = Data2$Combien_Hypnose_CM,
  Douleur_Hypnose = Data2$Douleur_Hypnose_CM,
  Evolution_Hypnose = Data2$Evolution_Hypnose_CM,
  Bouillotte = Data2$Bouillotte_CM,
  Duree_Bouillotte = Data2$Combien_Bouillotte_CM,
  Douleur_Bouillotte = Data2$Douleur_Bouillotte_CM,
  Evolution_Bouillotte = Data2$Evolution_Bouillotte_CM,
  CBD = Data2$CBD_CM,
  Duree_CBD = Data2$Combien_CBD_CM,
  Douleur_CBD = Data2$Douleur_CBD_CM,
  Evolution_CBD = Data2$Evolution_CBD_CM,
  Tens = Data2$Tens_CM,
  Duree_Tens = Data2$Combien_Tens_CM,
  Douleur_Tens = Data2$Douleur_Tens_CM,
  Evolution_Tens = Data2$Evolution_Tens_CM,
  Aucun = Data2$Aucun_CM
)

```

```{r}
data3 <- data.frame(
  ID = Data3$ID,
  Compt= Data3$Compt,
  Age = Data3$Age,
  Stade = Data3$Stade,
  Alcool = Data3$Alcool,
  Tabac = Data3$Tabac,
  TM = rep("NM", nrow(Data3)),
  Duree_TM = rep(NA, nrow(Data3)),
  Douleur_TM = rep(NA, nrow(Data3)),
  Evolution_TM = rep(NA, nrow(Data3)),
  Subi_ES = rep(NA, nrow(Data3)),
  Tete = rep(NA, nrow(Data3)),
  Apparition_Tete = rep(NA, nrow(Data3)),
  Freq_Tete = rep(NA, nrow(Data3)),
  Fatigue = rep(NA, nrow(Data3)),
  Apparition_Fatigue = rep(NA, nrow(Data3)),
  Freq_Fatigue = rep(NA, nrow(Data3)),
  Nausee = rep(NA, nrow(Data3)),
  Apparition_Nausee = rep(NA, nrow(Data3)),
  Freq_Nausee = rep(NA, nrow(Data3)),
  Humeur = rep(NA, nrow(Data3)),
  Apparition_Humeur = rep(NA, nrow(Data3)),
  Freq_Humeur = rep(NA, nrow(Data3)),
  Libido = rep(NA, nrow(Data3)),
  Apparition_Libido = rep(NA, nrow(Data3)),
  Freq_Libido = rep(NA, nrow(Data3)),
  Sang = rep(NA, nrow(Data3)),
  Apparition_Sang = rep(NA, nrow(Data3)),
  Freq_Sang = rep(NA, nrow(Data3)),
  Poids = rep(NA, nrow(Data3)),
  Allergie = rep(NA, nrow(Data3)),
  Thrombose = rep(NA, nrow(Data3)),
  Mobilite = Data3$Mobilite_NM,
  Duree_Mobilite = Duree_M,
  Douleur_Mobilite = Data3$Douleur_Mobilite_NM,
  Evolution_Mobilite = Data3$Evolution_Mobilite_NM,
  Nutrition = Data3$Nutrition_NM,
  Duree_Nutrition = Duree_N,
  Douleur_Nutrition = Data3$Douleur_Nutrition_NM,
  Evolution_Nutrition = Data3$Evolution_Nutrition_NM,
  Stress = Data3$Stress_NM,
  Duree_Stress = Duree_S,
  Douleur_Stress = Data3$Douleur_Stress_NM,
  Evolution_Stress = Data3$Evolution_Stress_NM,
  Phyto = Data3$Phyto_NM,
  Duree_Phyto = Duree_P,
  Douleur_Phyto = Data3$Douleur_Phyto_NM,
  Evolution_Phyto = Data3$Evolution_Phyto_NM,
  Acup = Data3$Acup_NM,
  Duree_Acup = Duree_A,
  Douleur_Acup = Data3$Douleur_Acup_NM,
  Evolution_Acup = Data3$Evolution_Acup_NM,
  Hypnose = Data3$Hypnose_NM,
  Duree_Hypnose = Duree_H,
  Douleur_Hypnose = Data3$Douleur_Hypnose_NM,
  Evolution_Hypnose = Data3$Evolution_Hypnose_NM,
  Bouillotte = Data3$Bouillotte_NM,
  Duree_Bouillotte = Duree_B,
  Douleur_Bouillotte = Data3$Douleur_Bouillotte_NM,
  Evolution_Bouillotte = Data3$Evolution_Bouillotte_NM,
  CBD = Data3$CBD_NM,
  Duree_CBD = Duree_C,
  Douleur_CBD = Data3$Douleur_CBD_NM,
  Evolution_CBD = Data3$Evolution_CBD_NM,
  Tens = Data3$Tens_NM,
  Duree_Tens = Duree_T,
  Douleur_Tens = Data3$Douleur_Tens_NM,
  Evolution_Tens = Data3$Evolution_Tens_NM,
  Aucun = rep(NA, nrow(Data3))
)


```


### Creation du data pour l'AMC ###
```{r}
Data_AMC_test <- bind_rows(data1,data2,data3)

```


### Creation des variables combinatoires entre traitements medicamenteux et non medicamenteux ###
```{r}
# Mobilite

Data_AMC_test$TH_Mob <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Mobilite == "yes", "yes", "no")
Data_AMC_test$CM_Mob <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Mobilite == "yes", "yes", "no")
Data_AMC_test$NM_Mob <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Mobilite == "yes", "yes", "no")

# Nutrition

Data_AMC_test$TH_Nut <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Nutrition == "yes", "yes", "no")
Data_AMC_test$CM_Nut <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Nutrition == "yes", "yes", "no")
Data_AMC_test$NM_Nut <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Nutrition == "yes", "yes", "no")

# Stress

Data_AMC_test$TH_Str <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Stress == "yes", "yes", "no")
Data_AMC_test$CM_Str <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Stress == "yes", "yes", "no")
Data_AMC_test$NM_Str <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Stress == "yes", "yes", "no")

# Phytothérapie

Data_AMC_test$TH_Phyto <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Phyto == "yes", "yes", "no")
Data_AMC_test$CM_Phyto <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Phyto == "yes", "yes", "no")
Data_AMC_test$NM_Phyto <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Phyto == "yes", "yes", "no")

# Hypnose

Data_AMC_test$TH_Hyp <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Hypnose == "yes", "yes", "no")
Data_AMC_test$CM_Hyp <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Hypnose == "yes", "yes", "no")
Data_AMC_test$NM_Hyp <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Hypnose == "yes", "yes", "no")

# Acupuncture

Data_AMC_test$TH_Acup <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Acup == "yes", "yes", "no")
Data_AMC_test$CM_Acup <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Acup == "yes", "yes", "no")
Data_AMC_test$NM_Acup <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Acup == "yes", "yes", "no")

# Bouillotte

Data_AMC_test$TH_Bou <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Bouillotte == "yes", "yes", "no")
Data_AMC_test$CM_Bou <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Bouillotte == "yes", "yes", "no")
Data_AMC_test$NM_Bou <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Bouillotte == "yes", "yes", "no")

# CBD

Data_AMC_test$TH_CBD <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$CBD == "yes", "yes", "no")
Data_AMC_test$CM_CBD <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$CBD == "yes", "yes", "no")
Data_AMC_test$NM_CBD <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$CBD == "yes", "yes", "no")

# Tens

Data_AMC_test$TH_Tens <- ifelse(Data_AMC_test$TM == "TH" & Data_AMC_test$Tens == "yes", "yes", "no")
Data_AMC_test$CM_Tens <- ifelse(Data_AMC_test$TM == "CM" & Data_AMC_test$Tens == "yes", "yes", "no")
Data_AMC_test$NM_Tens <- ifelse(Data_AMC_test$TM == "NM" & Data_AMC_test$Tens == "yes", "yes", "no")

```

```{r}
Data_AMC_test$TH_seul <- ifelse(
  Data_AMC_test$TH_Mob == "no" & 
  Data_AMC_test$TH_Nut == "no" & 
  Data_AMC_test$TH_Str == "no" & 
  Data_AMC_test$TH_Phyto == "no" & 
  Data_AMC_test$TH_Hyp == "no" & 
  Data_AMC_test$TH_Acup == "no" & 
  Data_AMC_test$TH_Bou == "no" & 
  Data_AMC_test$TH_CBD == "no" & 
  Data_AMC_test$TH_Tens == "no" &
  Data_AMC_test$TM == "TH",
  "yes", 
  "no"
)

Data_AMC_test$CM_seul <- ifelse(
  Data_AMC_test$CM_Mob == "no" & 
  Data_AMC_test$CM_Nut == "no" & 
  Data_AMC_test$CM_Str == "no" & 
  Data_AMC_test$CM_Phyto == "no" & 
  Data_AMC_test$CM_Hyp == "no" & 
  Data_AMC_test$CM_Acup == "no" & 
  Data_AMC_test$CM_Bou == "no" & 
  Data_AMC_test$CM_CBD == "no" & 
  Data_AMC_test$CM_Tens == "no" &
  Data_AMC_test$TM == "CM",
  "yes", 
  "no"
)
```


### Creation des echelles de douleur par traitements ###
```{r}
# Douleur Mobilité
Data_AMC_test$D_Mob <- ifelse(Data_AMC_test$Douleur_Mobilite == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Mobilite == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Mobilite == "Diminution de la douleur" | Data_AMC_test$Douleur_Mobilite == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Mobilite == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Mobilite)))

# Douleur Nutrition
Data_AMC_test$D_Nut <- ifelse(Data_AMC_test$Douleur_Nutrition == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Nutrition == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Nutrition == "Diminution de la douleur" | Data_AMC_test$Douleur_Nutrition == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Nutrition == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Nutrition)))

# Douleur Stress
Data_AMC_test$D_Str <- ifelse(Data_AMC_test$Douleur_Stress == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Stress == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Stress == "Diminution de la douleur" | Data_AMC_test$Douleur_Stress == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Stress == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Stress)))

# Douleur Phytothérapie
Data_AMC_test$D_Phyto <- ifelse(Data_AMC_test$Douleur_Phyto == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Phyto == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Phyto == "Diminution de la douleur" | Data_AMC_test$Douleur_Phyto == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Phyto == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Phyto)))

# Douleur Acupuncture
Data_AMC_test$D_Acup <- ifelse(Data_AMC_test$Douleur_Acup == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Acup == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Acup == "Diminution de la douleur" | Data_AMC_test$Douleur_Acup == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Acup == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Acup)))

# Douleur Hypnose
Data_AMC_test$D_Hyp <- ifelse(Data_AMC_test$Douleur_Hypnose == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Hypnose == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Hypnose == "Diminution de la douleur" | Data_AMC_test$Douleur_Hypnose == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Hypnose == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Hypnose)))

# Douleur Bouillotte
Data_AMC_test$D_Bou <- ifelse(Data_AMC_test$Douleur_Bouillotte == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Bouillotte == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Bouillotte == "Diminution de la douleur" | Data_AMC_test$Douleur_Bouillotte == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Bouillotte == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Bouillotte)))

# Douleur CBD
Data_AMC_test$D_CBD <- ifelse(Data_AMC_test$Douleur_CBD == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_CBD == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_CBD == "Diminution de la douleur" | Data_AMC_test$Douleur_CBD == "Réduction légère de la douleur" | Data_AMC_test$Douleur_CBD == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_CBD)))

# Douleur Tens
Data_AMC_test$D_Tens <- ifelse(Data_AMC_test$Douleur_Tens == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_Tens == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_Tens == "Diminution de la douleur" | Data_AMC_test$Douleur_Tens == "Réduction légère de la douleur" | Data_AMC_test$Douleur_Tens == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_Tens)))

# Douleur TM
Data_AMC_test$D_TM <- ifelse(Data_AMC_test$Douleur_TM == "Augmentation de la douleur","-",
                              ifelse(Data_AMC_test$Douleur_TM == "Pas d'impact sur la douleur","0",
                                     ifelse(Data_AMC_test$Douleur_TM == "Réduction légère de la douleur" | Data_AMC_test$Douleur_TM == "Réduction importante de la douleur","+",Data_AMC_test$Douleur_TM)))
```

```{r}
class(Data_AMC_test$Evolution_Mobilite)
typeof(Data_AMC_test$Evolution_Mobilite)
summary(Data_AMC_test$Evolution_Mobilite)

```


```{r}
levels(Data_AMC_test$Evolution_Mobilite)
print("sep")
levels(Data_AMC_test$Evolution_Nutrition)
print("sep")
levels(Data_AMC_test$Evolution_Stress)
print("sep")
levels(Data_AMC_test$Evolution_Phyto)
print("sep")
levels(Data_AMC_test$Evolution_Hypnose)
print("sep")
levels(Data_AMC_test$Evolution_Bouillotte)
print("sep")
levels(Data_AMC_test$Evolution_CBD)
print("sep")
levels(Data_AMC_test$Evolution_Tens)
print("sep")
levels(Data_AMC_test$Evolution_Acup)
print("sep")
levels(Data_AMC_test$Evolution_TM)
```

### Creation des echelles d'evolution par traitements ###

```{r}
Data_AMC_test <- Data_AMC_test %>%
  mutate(
    E_Mob = case_when(
      Evolution_Mobilite %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Augmentation des lésions") ~ "-",
      Evolution_Mobilite %in% c("Pas d'évolution", "Pas d'impact sur les lésions") ~ "0",
      Evolution_Mobilite %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Réduction des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Mobilite)
    ),
    
    E_Nut = case_when(
      Evolution_Nutrition %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_Nutrition == "Pas d'évolution" ~ "0",
      Evolution_Nutrition %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Nutrition)
    ),
    
    E_Str = case_when(
      Evolution_Stress %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_Stress == "Pas d'évolution" ~ "0",
      Evolution_Stress %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Stress)
    ),
    
    E_Phyto = case_when(
      Evolution_Phyto %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_Phyto == "Pas d'évolution" ~ "0",
      Evolution_Phyto %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Phyto)
    ),
    
     E_Acup = case_when(
      Evolution_Acup %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_Acup == "Pas d'évolution" ~ "0",
      Evolution_Acup %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Acup)
    ),
    
    E_Hyp = case_when(
      Evolution_Hypnose %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_Hypnose == "Pas d'évolution" ~ "0",
      Evolution_Hypnose %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Hypnose)
    ),
    
    E_Bou = case_when(
      Evolution_Bouillotte %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_Bouillotte == "Pas d'évolution" ~ "0",
      Evolution_Bouillotte %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Bouillotte)
    ),
    
    E_CBD = case_when(
      Evolution_CBD %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_CBD == "Pas d'évolution" ~ "0",
      Evolution_CBD %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_CBD)
    ),
    
    E_Tens = case_when(
      Evolution_Tens %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_Tens == "Pas d'évolution" ~ "0",
      Evolution_Tens %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_Tens)
    ),
    
     E_TM = case_when(
      Evolution_TM %in% c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes") ~ "-",
      Evolution_TM == "Pas d'évolution" ~ "0",
      Evolution_TM %in% c("Réduction modérée des lésions", "Réduction importante voire disparition des lésions") ~ "+",
      TRUE ~ as.character(Evolution_TM)
    ),
  )


```





### ACM de tous les combos avec TM et habillages selon les effets secondaires (ES) ###
```{r}
Data_AMC_TM = subset(Data_AMC_test, TM != "NM")
Data_AMC_TH = subset(Data_AMC_test, TM == "TH")
Data_AMC_CM = subset(Data_AMC_test, TM == "CM")
Data_AMC_NM = subset(Data_AMC_test, TM == "NM")

# Variables utilisees pour l'AMC sans les quali sup
colonnes_combos_TM <- which(seq_along(Data_AMC_TM) %in% c(70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95)) #83 retiree CM_Hyp car une seule modalite #97, 98

# Variables utilisees pour l'AMC avec les quali sup = type ES
colonnes_combos_TM_ES <- which(seq_along(Data_AMC_TM) %in% c(12, 15, 18, 21, 24, 27, 30, 31, 32, 70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95)) #, 97, 98

# Variables utilisees pour l'AMC sans les quali sup focus sur TH/CM
colonnes_combos_focus_TM <- which(seq_along(Data_AMC_TM) %in% c(7, 70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95)) #97, 98

#ACM sans les ES
mca.combos= MCA(Data_AMC_TM[colonnes_combos_TM], graph=FALSE)
fviz_mca_biplot(mca.combos) + ggtitle("ACM des traitements en prise conjointe")

#ACM avec les ES
mca.combos.ES = MCA(Data_AMC_TM[colonnes_combos_TM_ES],quali.sup=1:9, graph=FALSE)
fviz_mca_biplot(mca.combos.ES) + ggtitle("ACM des traitements en prise conjointe avec les ES en quali sup")

#ACM sans les ES focus sur TH/CM
mca.combos.focus = MCA(Data_AMC_TM[colonnes_combos_focus_TM], quali.sup=1, graph=FALSE)
fviz_mca_biplot(mca.combos) + ggtitle("ACM des traitements en prise conjointe avec les TM en quali sup")

```

## Graphe des variables de tous les combos TM : habillage = pris/pas pris
```{r}
fviz_mca_var(mca.combos, 
             col.var = rep(c("no","yes"),17), 
             title = "Graph of variables",
             repel = TRUE) + ggtitle("Graphe des variables en fonction de la prise ou non des combos")
```

## Graphe de variables de tous les combos TM : habillage = qualité de représentation
```{r}
fviz_mca_var(mca.combos, 
             col.var = "cos2", 
             select.var = list(name = NULL, cos2 = 10, contrib = NULL),
             title = "Graph of variables",
             repel = TRUE) + ggtitle("Graphe des variables combos TM en fonction qualité de représentation")
```

Le graphe des variables qui sépare le fait de prendre un combo d'un traitement médicamenteux en parallèle d'un non médicamenteux, semble permettre de distinguer la prise de combo ou non : avoir pris une cure de ménopause artificielle (CM) en parallèle d'un traitement NM semble corrélé positivement à la fois à la première et à le seconde dimension. Avoir pris un traitement hormonal (TH) en parallèle de traitements NM semble corrélé positivement à la seconde dimension et négativement à la première. Enfin l'absence de pris d'un combo quel qu'il soit n'est corrélé à aucune des deux dimensions.

Par ailleurs en habillant les variables par rapport à leur contribution on constate que certains combos tels que la Mobilite (aussi bien avec TH que CM) ou la Bouillotte (avec TH et CM) ont la plus forte contribution et respectent le observations précédentes.
De plus l'absence de prise d'un combo (modalité "no") quel qu'il soit contribue très peu aux résultats de l'ACM.

# Contribution des combos
```{r}
fviz_cos2(mca.combos, choice = "var", axes = 1:2) + ggtitle("Contribution des combos à l'ACM")
```
On constate que les variables qui contribuent le plus sont celles qui sont le mieux représentées globalement.


## Graphe des individus en fonction de leur qualité de représentation
```{r}
fviz_mca_ind(mca.combos,col.ind = "cos2", repel = FALSE) + ggtitle("Graphe des individus en fonction du TM")
```

On remarque que les individus bien représentés sont situés à différents endroits du graphe : sur les deux "extrémités" et au centre => bonne dispersion


## Graphe des individus en fonction du type de TM pris
```{r}
fviz_mca_ind(mca.combos.focus,habillage = 1, repel = FALSE) + ggtitle("Graphe des individus en fonction du TM")
```
L'habillage en fonction du type de traitement médicamenteux pris (CM ou TH) permet clairement de distinguer les combos en deux clusters : un combo avec TH est corrélé négativement avec la première dimension tandis qu'un combo avec CM est corrélé posititvement confirmant nos observations précédentes.


## Graphe des individus avec habillage selon apparition d'ES ##
```{r}
# Variables utilisees pour l'AMC avec les quali sup ES
colonnes_TM_ES <- which(seq_along(Data_AMC_TM) %in% c(11, 70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95, 97, 98))

#AMC avec quali sup douleur
mca.TM.ES = MCA(Data_AMC_TM[colonnes_TM_ES], quali.sup=1, graph=FALSE)
fviz_mca_biplot(mca.TM.ES)
```

```{r}
print(fviz_mca_ind(mca.TM.ES, habillage = 1, repel = FALSE))
```


## Graphe des individus en fonction du type d'effet secondaire
```{r}
for (i in 1:9){
  print(fviz_mca_biplot(mca.combos.ES, invisible=c("var","quali.sup"), habillage = i, repel = FALSE) + ggtitle(paste("Graphe des individus en fonction de l'ES "),names(Data_AMC_TM[colonnes_combos_TM_ES[i]])))
}
```

## Graphe des indis pour TM : habillage = frequence des ES
```{r}
colonnes_combos_TM_freq <- which(seq_along(Data_AMC_TM) %in% c(14, 17, 20, 23, 26, 29, 70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95))

mca.combos.TM.freq= MCA(Data_AMC_TM[colonnes_combos_TM_freq], quali.sup=1:6, graph=FALSE)

```

```{r}
# Extraire les coordonnées des variables
ind_TM_freq <- rownames(mca.combos.TM.freq$ind$coord)

# Créer un dataframe vide
df_TM_freq <- data.frame(matrix(nrow = length(ind_TM_freq), ncol = 0))

# Ajouter les coord
coord_TM_freq <- mca.combos.TM.freq$ind$coord
df_TM_freq <- cbind(df_TM_freq, coord_TM_freq)

# Définir les variables
df_TM_freq$Freq_Tete <- Data_AMC_TM$Freq_Tete
df_TM_freq$Freq_Fatigue <- Data_AMC_TM$Freq_Fatigue
df_TM_freq$Freq_Nausee <- Data_AMC_TM$Freq_Nausee
df_TM_freq$Freq_Humeur <- Data_AMC_TM$Freq_Humeur
df_TM_freq$Freq_Libido <- Data_AMC_TM$Freq_Libido
df_TM_freq$Freq_Sang <- Data_AMC_TM$Freq_Sang

print(df_TM_freq)

# Définir une palette de couleurs personnalisée pour chaque variable
custom_palette_TM_freq <- list(
  Freq_Tete = c("Plusieurs fois par jour" = "#960018", "Plusieurs fois par semaine" = "#ED7F10", "Plusieurs fois par mois" = "#FFD700", "Plusieurs fois par an" = "#3AF24B", "Moins d'une fois par an" = "#26C4EC"),
  Freq_Fatigue = c("Plusieurs fois par jour" = "#960018", "Plusieurs fois par semaine" = "#ED7F10", "Plusieurs fois par mois" = "#FFD700", "Plusieurs fois par an" = "#3AF24B", "Moins d'une fois par an" = "#26C4EC"),
  Freq_Nausee = c("Plusieurs fois par jour" = "#960018", "Plusieurs fois par semaine" = "#ED7F10", "Plusieurs fois par mois" = "#FFD700", "Plusieurs fois par an" = "#3AF24B", "Moins d'une fois par an" = "#26C4EC"),
  Freq_Humeur = c("Plusieurs fois par jour" = "#960018", "Plusieurs fois par semaine" = "#ED7F10", "Plusieurs fois par mois" = "#FFD700", "Plusieurs fois par an" = "#3AF24B", "Moins d'une fois par an" = "#26C4EC"),
  Freq_Libido = c("Plusieurs fois par jour" = "#960018", "Plusieurs fois par semaine" = "#ED7F10", "Plusieurs fois par mois" = "#FFD700", "Plusieurs fois par an" = "#3AF24B", "Moins d'une fois par an" = "#26C4EC"),
  Freq_Sang = c("Plusieurs fois par jour" = "#960018", "Plusieurs fois par semaine" = "#ED7F10", "Plusieurs fois par mois" = "#FFD700", "Plusieurs fois par an" = "#3AF24B", "Moins d'une fois par an" = "#26C4EC")
)

# Tracer les variables sur un graphe en utilisant les dimensions 1 et 2 de l'ACM
for (var in c("Freq_Tete","Freq_Fatigue","Freq_Nausee","Freq_Humeur","Freq_Libido","Freq_Sang")){
  titre <- paste("Graphe des individus des TM avec habillage en fonction de ", var)
  print(
    ggplot(df_TM_freq, aes(x = `Dim 1`, y = `Dim 2`, color = df_TM_freq[[var]], label = rownames(df_TM_freq))) +
      geom_point(size=3) +
      geom_text(aes(color = df_TM_freq[[var]]), hjust = 0, vjust = 0, size = 3) +  # Ajouter les noms des individus avec la couleur du point correspondant
      scale_color_manual(values = custom_palette_TM_freq[[var]], na.value = "transparent") +  # Utiliser la palette de couleurs personnalisée
      theme_minimal() +
      labs(title = titre,
           x = "Dim 1",
           y = "Dim 2",
           color = "Frequence des ES")
  )
}
```


## Graphe des indis pour TM : habillage = apparition des ES
```{r}
colonnes_combos_TM_app <- which(seq_along(Data_AMC_TM) %in% c(13, 16, 19, 22, 25, 28, 70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95))

mca.combos.TM.app= MCA(Data_AMC_TM[colonnes_combos_TM_app], quali.sup=1:6, graph=FALSE)

```

```{r}
# Extraire les coordonnées des variables
ind_TM_app <- rownames(mca.combos.TM.app$ind$coord)

# Créer un dataframe vide
df_TM_app <- data.frame(matrix(nrow = length(ind_TM_app), ncol = 0))

# Ajouter les coord
coord_TM_app <- mca.combos.TM.app$ind$coord
df_TM_app <- cbind(df_TM_app, coord_TM_app)

# Définir les variables
df_TM_app$Apparition_Tete <- Data_AMC_TM$Apparition_Tete
df_TM_app$Apparition_Fatigue <- Data_AMC_TM$Apparition_Fatigue
df_TM_app$Apparition_Nausee <- Data_AMC_TM$Apparition_Nausee
df_TM_app$Apparition_Humeur <- Data_AMC_TM$Apparition_Humeur
df_TM_app$Apparition_Libido <- Data_AMC_TM$Apparition_Libido
df_TM_app$Apparition_Sang <- Data_AMC_TM$Apparition_Sang

# Définir une palette de couleurs personnalisée pour chaque variable
custom_palette_TM_app <- list(
  Apparition_Tete = c("Moins de 3 mois" = "#ED7F10", "Entre 3 et 6 mois" = "#FFD700", "Entre 6 mois et 2 ans" = "#3AF24B", "Entre 2 et 5 ans" = "#003366", "Plus de 5 ans" = "#A10684"),
  Apparition_Fatigue = c("Moins de 3 mois" = "#ED7F10", "Entre 3 et 6 mois" = "#FFD700", "Entre 6 mois et 2 ans" = "#3AF24B", "Entre 2 et 5 ans" = "#003366", "Plus de 5 ans" = "#A10684"),
  Apparition_Nausee = c("Moins de 3 mois" = "#ED7F10", "Entre 3 et 6 mois" = "#FFD700", "Entre 6 mois et 2 ans" = "#3AF24B", "Entre 2 et 5 ans" = "#003366", "Plus de 5 ans" = "#A10684"),
  Apparition_Humeur = c("Moins de 3 mois" = "#ED7F10", "Entre 3 et 6 mois" = "#FFD700", "Entre 6 mois et 2 ans" = "#3AF24B", "Entre 2 et 5 ans" = "#003366", "Plus de 5 ans" = "#A10684"),
  Apparition_Libido = c("Moins de 3 mois" = "#ED7F10", "Entre 3 et 6 mois" = "#FFD700", "Entre 6 mois et 2 ans" = "#3AF24B", "Entre 2 et 5 ans" = "#003366", "Plus de 5 ans" = "#A10684"),
  Apparition_Sang = c("Moins de 3 mois" = "#ED7F10", "Entre 3 et 6 mois" = "#FFD700", "Entre 6 mois et 2 ans" = "#3AF24B", "Entre 2 et 5 ans" = "#003366", "Plus de 5 ans" = "#A10684")
)

# Tracer les variables sur un graphe en utilisant les dimensions 1 et 2 de l'ACM
for (var in c("Apparition_Tete","Apparition_Fatigue","Apparition_Nausee","Apparition_Humeur","Apparition_Libido","Apparition_Sang")){
  titre <- paste("Graphe des individus des TM avec habillage en fonction de ", var)
  print(
    ggplot(df_TM_app, aes(x = `Dim 1`, y = `Dim 2`, color = df_TM_app[[var]], label = rownames(df_TM_app))) +
      geom_point(size=3) +
      geom_text(aes(color = df_TM_app[[var]]), hjust = 0, vjust = 0, size = 3) +  # Ajouter les noms des individus avec la couleur du point correspondant
      scale_color_manual(values = custom_palette_TM_app[[var]], na.value = "transparent") +  # Utiliser la palette de couleurs personnalisée
      theme_minimal() +
      labs(title = titre,
           x = "Dim 1",
           y = "Dim 2",
           color = "Apparition des ES")
  )
}
```


## Graphe des indis pour TM : habillage = durée TM
```{r}
colonnes_combos_TM_duree <- which(seq_along(Data_AMC_TM) %in% c(8, 34, 38, 42, 46, 50, 54, 58, 62, 66, 70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95))

mca.combos.TM.duree= MCA(Data_AMC_TM[colonnes_combos_TM_duree], quali.sup=1:10, graph=FALSE)
```

```{r}
# Extraire les coordonnées des variables
ind_TM_duree <- rownames(mca.combos.TM.duree$ind$coord)

# Créer un dataframe vide
df_TM_duree <- data.frame(matrix(nrow = length(ind_TM_duree), ncol = 0))

# Ajouter les coord
coord_TM_duree <- mca.combos.TM.duree$ind$coord
df_TM_duree <- cbind(df_TM_duree, coord_TM_duree)

# Définir les variables
df_TM_duree$Duree_TM <- Data_AMC_TM$Duree_TM


# Définir une palette de couleurs personnalisée pour chaque variable
custom_palette_TM_duree <- list(
  Duree_TM = c("Moins de 3 mois" = "#ED7F10", "Entre 3 et 6 mois" = "#FFD700", "Entre 6 mois et 2 ans" = "#3AF24B", "Entre 2 et 5 ans" = "#003366", "Plus de 5 ans" = "#A10684")
)

# Tracer les variables sur un graphe en utilisant les dimensions 1 et 2 de l'ACM
for (var in c("Duree_TM")){
  titre <- paste("Graphe des individus des TM avec habillage en fonction de la duree du TM ")
  print(
    ggplot(df_TM_duree, aes(x = `Dim 1`, y = `Dim 2`, color = df_TM_duree[[var]], label = rownames(df_TM_duree))) +
      geom_point(size=3) +
      geom_text(aes(color = df_TM_duree[[var]]), hjust = 0, vjust = 0, size = 3) +  # Ajouter les noms des individus avec la couleur du point correspondant
      scale_color_manual(values = custom_palette_TM_duree[[var]], na.value = "transparent") +  # Utiliser la palette de couleurs personnalisée
      theme_minimal() +
      labs(title = titre,
           x = "Dim 1",
           y = "Dim 2",
           color = "Duree traitement")
  )
}
```






### ACM de tous les combos et habillages selon l'échelle de douleur ###
```{r}
# Variables utilisees pour l'AMC avec les quali sup douleur
colonnes_combos_D <- which(seq_along(Data_AMC_test) %in% c(7,70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108))

# Variables utilisees pour l'AMC avec les quali sup douleur/TH
colonnes_combos_TH_D <- which(seq_along(Data_AMC_TH) %in% c(70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108))

# Variables utilisees pour l'AMC avec les quali sup douleur/CM
colonnes_combos_CM_D <- which(seq_along(Data_AMC_CM) %in% c(71, 74, 77, 80, 86, 89, 92, 95, 98, 99, 100, 101, 102, 103, 105, 106, 107, 108))

# Variables utilisees pour l'AMC avec les quali sup douleur/NM
colonnes_combos_NM_D <- which(seq_along(Data_AMC_NM) %in% c(72, 75, 78, 81, 84, 87, 90, 93, 96, 99, 100, 101, 102, 103, 104, 105, 106, 107))

#AMC avec quali sup douleur ts les traitements
mca.combos.D = MCA(Data_AMC_test[colonnes_combos_D], quali.sup=c(1,30:39), graph=FALSE)
fviz_mca_biplot(mca.combos.D) + ggtitle("ACM de tous les combos de traitements avec l'echelle de douleur en quali sup")

#AMC avec quali sup douleur TH
mca.combos.TH.D = MCA(Data_AMC_TH[colonnes_combos_TH_D], graph=FALSE, quali.sup=11:20)
fviz_mca_biplot(mca.combos.TH.D) + ggtitle("ACM des combos avec TH avec l'echelle de douleur en quali sup")

#AMC avec quali sup douleur CM
mca.combos.CM.D = MCA(Data_AMC_CM[colonnes_combos_CM_D], quali.sup=10:18, graph=FALSE)
fviz_mca_biplot(mca.combos.CM.D) + ggtitle("ACM des combos avec CM avec l'echelle de douleur en quali sup")

#AMC avec quali sup douleur NM
mca.combos.NM.D = MCA(Data_AMC_NM[colonnes_combos_NM_D], quali.sup=10:18, graph=FALSE)
fviz_mca_biplot(mca.combos.NM.D) + ggtitle("ACM des NM seuls avec l'echelle de douleur en quali sup")
```

## Graphe des individus avec habillage = traitement (TH/CM/NM)
```{r}
# Variables utilisees pour l'AMC avec quali sup TH/CM/NM
colonnes_combos_T <- which(seq_along(Data_AMC_test) %in% c(7,70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98))

#AMC avec quali sup TH/CM/NM
mca.combos.T = MCA(Data_AMC_test[colonnes_combos_T], quali.sup=c(1), graph=FALSE)
fviz_mca_ind(mca.combos.T, habillage=1) + ggtitle("ACM de tous les combos de traitements avec l'echelle de douleur en quali sup")
```

## Graphe des variable avec habillage = qualité de représentation
```{r}
#Affichage des var : habillage = qualité de représentation
fviz_mca_var(mca.combos.D, invisible=c("quali.sup"), repel=TRUE, col.var="cos2") + ggtitle("Graphe des var de tous les combos de traitements avec l'echelle de douleur en quali sup")
```

## Graphe des variable avec habillage = traitement (TH/CM/NM)
```{r}
# Extraire les coordonnées des variables
var <- rownames(mca.combos.T$var$coord)

# Créer un dataframe vide
df <- data.frame(matrix(nrow = length(var), ncol = 0))

# Définir les noms de lignes du dataframe
rownames(df) <- var

# Ajouter les coord
coord <- mca.combos.T$var$coord
df <- cbind(df, coord)

# Définir la variable "Traitement" en fonction du préfixe du nom de chaque individu
df$Traitement <- substring(rownames(df), 1, 2)

# Afficher le dataframe
#head(df)

# Tracer les variables sur un graphe en utilisant les dimensions 1 et 2 de l'ACM
ggplot(df, aes(x = `Dim 1`, y = `Dim 2`, color = Traitement)) +
  geom_point(size=3) +
  theme_minimal() +
  labs(title = "Variables habillées en fonction du traitement",
       x = "Dim 1",
       y = "Dim 2")

```

## Graphe des individus pour tous les traitements : habillage = echelle douleur en fonction du NM Version 2
```{r}
# Extraire les coordonnées des variables
ind <- rownames(mca.combos.D$ind$coord)

# Créer un dataframe vide
df <- data.frame(matrix(nrow = length(ind), ncol = 0))

# Définir les noms de lignes du dataframe
#rownames(df) <- ind

# Ajouter les coord
coord <- mca.combos.D$ind$coord
df <- cbind(df, coord)

# Définir les variables
df$D_Mob <- Data_AMC_test$D_Mob
df$D_Nut <- Data_AMC_test$D_Nut
df$D_Str <- Data_AMC_test$D_Str
df$D_Phyto <- Data_AMC_test$D_Phyto
df$D_Acup <- Data_AMC_test$D_Acup
df$D_Hyp <- Data_AMC_test$D_Hyp
df$D_Bou <- Data_AMC_test$D_Bou
df$D_CBD <- Data_AMC_test$D_CBD
df$D_Tens <- Data_AMC_test$D_Tens

# Afficher le dataframe
#head(df)

# Définir une palette de couleurs personnalisée pour chaque variable
custom_palette <- list(
  D_Mob = c("+" = "#b3e93e", "0" = "#ffec1b", "-" = "#f15854"),
  D_Nut = c("+" = "#b3e93e", "0" = "#ffec1b", "-" = "#f15854"),
  D_Str = c("+" = "#b3e93e", "0" = "#ffec1b", "-" = "#f15854"),
  D_Phyto = c("+" = "#b3e93e", "0" = "#ffec1b"),
  D_Acup = c("+" = "#b3e93e", "0" = "#ffec1b", "-" = "#f15854"),
  D_Hyp = c("+" = "#b3e93e", "0" = "#ffec1b"),
  D_Bou = c("+" = "#b3e93e", "0" = "#ffec1b"),
  D_CBD = c("+" = "#b3e93e", "0" = "#ffec1b", "-" = "#f15854"),
  D_Tens = c("+" = "#b3e93e", "0" = "#ffec1b", "-" = "#f15854")
)

# Tracer les variables sur un graphe en utilisant les dimensions 1 et 2 de l'ACM
for (var in c("D_Mob","D_Nut","D_Str","D_Phyto","D_Acup","D_Hyp","D_Bou","D_CBD","D_Tens")){
  titre <- paste("Graphe des individus de tous les combos avec habillage \nen fonction de la douleur du combo TM avec ", var)
  print(
    ggplot(df, aes(x = `Dim 1`, y = `Dim 2`, color = df[[var]], label = rownames(df))) +
      geom_point(size=3) +
      geom_text(aes(color = df[[var]]), hjust = 0, vjust = 0, size = 3) +  # Ajouter les noms des individus avec la couleur du point correspondant
      scale_color_manual(values = custom_palette[[var]], na.value = "transparent") +  # Utiliser la palette de couleurs personnalisée
      theme_minimal() +
      labs(title = titre,  # Utiliser le titre créé
           x = "Dim 1",
           y = "Dim 2",
           color = "Efficacité sur la douleur")  # Modifier le nom de la légende
  )
}

```
Mobilite = Pas de lien entre type de traitement et efficacite douleur
Nutrition = Pas de lien
Gestion Stress = Globalement pas d'impact sur CM / n'empire qu'avec TH (mais très peu de point)
Phyto = N'améliore pas TH (26 personnes ont testé le combo)
Acup -> difficile tirer conclusions (trop peu de cas)
Hypnose = Pas de lien
Bouillotte = Pas de lien avec type traitement mais globalement très efficace
CBD = Pas de lien
Bouillotte = Pas de lien mais gloablement très efficace


## Graphe des individus pour tous les traitements : habillage = echelle douleur en fonction du NM Version 1
```{r}
# General
for (i in 30:38){
  variable_nom <- names(Data_AMC_test[colonnes_combos_D[i]])[1]
  titre <- paste("Graphe des individus de tous les combos avec habillage \nen fonction de la douleur du combo TM avec ", variable_nom)
  print(fviz_mca_ind(mca.combos.D, habillage = i, repel = FALSE) + ggtitle(titre))
}
```


## Graphe des indis pour tous les traitements : habillage = duree du TM
```{r}
colonnes_combos_duree <- which(seq_along(Data_AMC_TM) %in% c(8, 34, 38, 42, 46, 50, 54, 58, 62, 66, 70, 71, 73, 74, 76, 77, 79, 80, 82, 85, 86, 88, 89, 91, 92, 94, 95))

mca.combos.duree= MCA(Data_AMC_TM[colonnes_combos_duree], quali.sup=c(1,10), graph=FALSE)
```


## Graphe des indis pour tous les traitements : habillage = evolution NM
```{r}
colonnes_combos_Evol <- which(seq_along(Data_AMC_test) %in% c(70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118))

mca.combos.TT.Evol = MCA(Data_AMC_test[colonnes_combos_Evol], graph=FALSE, quali.sup=29:38)

```

```{r}
# Extraire les coordonnées des variables
ind_TT_evol <- rownames(mca.combos.TT.Evol$ind$coord)

# Créer un dataframe vide
df_TT_evol <- data.frame(matrix(nrow = length(ind_TT_evol), ncol = 0))

# Ajouter les coord
coord_TT_evol <- mca.combos.TT.Evol$ind$coord
df_TT_evol <- cbind(df_TT_evol, coord_TT_evol)

# Définir les variables
df_TT_evol$E_TM <- Data_AMC_test$E_TM
df_TT_evol$E_Mob <- Data_AMC_test$E_Mob
df_TT_evol$E_Nut <- Data_AMC_test$E_Nut
df_TT_evol$E_Str <- Data_AMC_test$E_Str
df_TT_evol$E_Phyto <- Data_AMC_test$E_Phyto
df_TT_evol$E_Acup <- Data_AMC_test$E_Acup
df_TT_evol$E_Hyp <- Data_AMC_test$E_Hyp
df_TT_evol$E_Bou <- Data_AMC_test$E_Bou
df_TT_evol$E_CBD <- Data_AMC_test$E_CBD
df_TT_evol$E_Tens <- Data_AMC_test$E_Tens

# Définir une palette de couleurs personnalisée pour chaque variable
custom_palette_TM_app <- list(
  E_TM = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Mob = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Nut = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Str =c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Phyto =c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Hyp = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Acup = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Bou = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_CBD = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018"),
  E_Tens = c("+" = "#3AF24B", "0" = "#FFD700", "-" = "#960018")
)


# Tracer les variables sur un graphe en utilisant les dimensions 1 et 2 de l'ACM
for (var in c("E_TM", "E_Mob","E_Nut","E_Str","E_Phyto","E_Acup","E_Hyp","E_Bou","E_CBD","E_Tens")){
  titre <- paste("Graphe des individus des TM avec habillage en fonction de ", var)
  print(
    ggplot(df_TT_evol, aes(x = `Dim 1`, y = `Dim 2`, color = df_TT_evol[[var]], label = rownames(df_TT_evol))) +
      geom_point(size=3) +
      geom_text(aes(color = df_TT_evol[[var]]), hjust = 0, vjust = 0, size = 3) +  # Ajouter les noms des individus avec la couleur du point correspondant
      scale_color_manual(values = custom_palette_TM_app[[var]], na.value = "transparent") +  # Utiliser la palette de couleurs personnalisée
      theme_minimal() +
      labs(title = titre,
           x = "Dim 1",
           y = "Dim 2",
           color = "Evolution maladie")
  )
}
```







### ACM sur les TH uniquement

## Biplot pour les TH en fonction de combos pris / pas pris
```{r}
# Variables utilisees pour l'AMC avec quali.sup = combos
colonnes_combos_TH <- which(seq_along(Data_AMC_TH) %in% c(70, 73, 76, 79, 82, 85, 88, 91, 94, 97))

#AMC avec quali.sup = combos
mca.combos.TH = MCA(Data_AMC_TH[colonnes_combos_TH], graph=FALSE)
fviz_mca_biplot(mca.combos.TH) + ggtitle("ACM en fonction des combos")
```

## Graphe des variables pour les TH avec habillage = qualité de représentation (5 les plus représentés)
```{r}
fviz_mca_var(mca.combos.TH, select.var = list(cos2 = 5), col.var = "cos2") + ggtitle("ACM en fonction des combos")
```


## Graphe des individus pour les TH avec habillage = combo pris/pas pris
```{r}
for (i in 1:10){
  print(fviz_mca_ind(mca.combos.TH, habillage = i, repel = FALSE) + ggtitle(paste("Graphe des individus avec habillage en fonction du combo TH et "),names(Data_AMC_TH[colonnes_combos_TH[i]]))) # , axes = c(3, 4) pour changer les dimensions
}
```

## Graphe des individus pour TH : habillage = echelle douleur en fonction du NM en combo
```{r}
# Pour TH
for (i in 11:20){
  print(fviz_mca_ind(mca.combos.TH.D,  habillage = i, repel = FALSE) + ggtitle(paste("Graphe des individus des combos avec TH avec habillage \nen fonction de la douleur du combo TH avec "),names(Data_AMC_TH[colonnes_combos_TH_D[i]])) )
}

```





### ACM sur les CM uniquement

## Biplot pour les CM en fonction de combos pris / pas pris
```{r}
# Variables utilisees pour l'AMC
colonnes_combos_CM <- which(seq_along(Data_AMC_CM) %in% c(71, 74, 77, 80, 86, 89, 92, 95, 98))

#AMC avec quali.sup = combos
mca.combos.CM = MCA(Data_AMC_CM[colonnes_combos_CM], graph=FALSE)
fviz_mca_biplot(mca.combos.CM) + ggtitle("ACM en fonction des combos avec CM")
```

## Graphe des variables pour les CM avec habillage = qualité de représentation (5 les plus représentés)
```{r}
fviz_mca_var(mca.combos.CM, select.var = list(cos2 = 5), col.var = "cos2") + ggtitle("ACM en fonction des combos")
```

## Graphe des individus pour les CM avec habillage = combo pris/pas pris
```{r}
for (i in 1:9){
  print(fviz_mca_ind(mca.combos.CM, habillage = i, repel = FALSE) + ggtitle(paste("Graphe des individus avec habillage en fonction du combo CM et "),names(Data_AMC_CM[colonnes_combos_CM[i]]))) # , axes = c(3, 4) pour changer les dimensions
}
```

## Graphe des individus pour CM : habillage = echelle douleur en fonction du NM en combo
```{r}
# Pour CM
for (i in 10:18){
  print(fviz_mca_ind(mca.combos.CM.D, habillage = i, repel = FALSE)) # , axes = c(3, 4) pour changer les dimensions
}
```





### ACM sur les NM uniquement 

## Graphe des individus pour NM : habillage = echelle douleur
```{r}
# Pour NM
for (i in 10:18){
  print(fviz_mca_ind(mca.combos.NM.D, habillage = i, repel = FALSE)) # , axes = c(3, 4) pour changer les dimensions
}
```






### ACM des effets secondaires et habillages selon le TM ###

```{r}
# Variables utilisees pour l'AMC avec les quali sup ES
colonnes_ES <- which(seq_along(Data_AMC_TM) %in% c(7, 12, 15, 18, 21, 24, 27, 30, 31, 32))

#AMC avec quali sup douleur
mca.ES = MCA(Data_AMC_TM[colonnes_ES], quali.sup=1, graph=FALSE)
fviz_mca_biplot(mca.ES)
```

```{r}
print(fviz_mca_ind(mca.ES, habillage = 1, repel = FALSE))
```

```{r}
for (i in 2:10){
  print(fviz_mca_ind(mca.ES, habillage = i, repel = FALSE))
}
```


