---
title: "Projet_tutore_R"
author: "Yasmine Boulkaid, Cassandra Jan & Illana Rabasquinho"
date: "2024-03-21"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

# Introduction
## Librairies
```{r, echo=FALSE}
# Définir un miroir CRAN
options(repos = "https://cloud.r-project.org")

#install.packages("FactoMineR")
#install.packages("factoextra")
#install.packages("readxl")
#install.packages("gridExtra")

library(readxl)
library(gridExtra)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(conflicted)
library(dplyr)
library(tidyverse)
```

## Mise en forme des données
```{r, echo=FALSE}
# Renommer toutes les variables

data <- read.csv("etude_sur_les_traitements_de_lendometriose.csv")
n <- length(data)

### Questions préliminaires ###
names(data)[names(data) == "X"] <- "Age"
names(data)[names(data) == "X.1"] <- "Stade"
names(data)[names(data) == "X.2"] <- "Diagnostic"
names(data)[names(data) == "X.3"] <- "Tabac"
names(data)[names(data) == "X.4"] <- "Alcool"
names(data)[names(data) == "X.5"] <- "TH"
names(data)[names(data) == "X.6"] <- "CM"
names(data)[names(data) == "X.7"] <- "Autre"
names(data)[names(data) == "X.8"] <- "Aucun"
names(data)[names(data) == "X.9"] <- "Lesquels_M"

### Questions générales TH ###
names(data)[names(data) == "X.10"] <- "Encore_TH"
names(data)[names(data) == "X.11"] <- "Depuis_TH"
names(data)[names(data) == "X.12"] <- "Debut_TH"
names(data)[names(data) == "X.13"] <- "Combien_TH"
names(data)[names(data) == "X.14"] <- "Pas_efficace_TH"
names(data)[names(data) == "X.15"] <- "ES_TH"
names(data)[names(data) == "X.16"] <- "Cout_TH"
names(data)[names(data) == "X.17"] <- "Autre_Cause_Fin_TH"
names(data)[names(data) == "X.18"] <- "Douleur_TH"
names(data)[names(data) == "X.19"] <- "Evolution_TH"
names(data)[names(data) == "X.20"] <- "Pre_op_TH"
names(data)[names(data) == "X.21"] <- "Post_op_TH"
names(data)[names(data) == "X.22"] <- "Pas_op_TH"
names(data)[names(data) == "X.23"] <- "Prise_TH"

### Effets secondaires TH ###
names(data)[names(data) == "X.24"] <- "Subi_ES_TH"
names(data)[names(data) == "X.25"] <- "Tete_TH"
names(data)[names(data) == "X.26"] <- "Fatigue_TH"
names(data)[names(data) == "X.27"] <- "Nausee_TH"
names(data)[names(data) == "X.28"] <- "Humeur_TH"
names(data)[names(data) == "X.29"] <- "Libido_TH"
names(data)[names(data) == "X.30"] <- "Sang_TH"
names(data)[names(data) == "X.31"] <- "Poids_TH"
names(data)[names(data) == "X.32"] <- "Allergie_TH"
names(data)[names(data) == "X.33"] <- "Thrombose_TH"
names(data)[names(data) == "X.34"] <- "Autre_ES_TH"
names(data)[names(data) == "X.35"] <- "Apparition_Tete_TH"
names(data)[names(data) == "X.36"] <- "Frequence_Tete_TH"
names(data)[names(data) == "X.37"] <- "Apparition_Fatigue_TH"
names(data)[names(data) == "X.38"] <- "Frequence_Fatigue_TH"
names(data)[names(data) == "X.39"] <- "Apparition_Nausee_TH"
names(data)[names(data) == "X.40"] <- "Frequence_Nausee_TH"
names(data)[names(data) == "X.41"] <- "Apparition_Humeur_TH"
names(data)[names(data) == "X.42"] <- "Frequence_Humeur_TH"
names(data)[names(data) == "X.43"] <- "Apparition_Libido_TH"
names(data)[names(data) == "X.44"] <- "Frequence_Libido_TH"
names(data)[names(data) == "X.45"] <- "Apparition_Sang_TH"
names(data)[names(data) == "X.46"] <- "Frequence_Sang_TH"
names(data)[names(data) == "X.47"] <- "Apparition_Thrombose_TH"

### Traitements non médicamenteux TH ###
names(data)[names(data) == "X.48"] <- "Mobilite_TH"
names(data)[names(data) == "X.49"] <- "Nutrition_TH"
names(data)[names(data) == "X.50"] <- "Stress_TH"
names(data)[names(data) == "X.51"] <- "Phyto_TH"
names(data)[names(data) == "X.52"] <- "Acup_TH"
names(data)[names(data) == "X.53"] <- "Hypnose_TH"
names(data)[names(data) == "X.54"] <- "Bouillotte_TH"
names(data)[names(data) == "X.55"] <- "CBD_TH"
names(data)[names(data) == "X.56"] <- "Tens_TH"
names(data)[names(data) == "X.57"] <- "Aucun_TH"

# Mobilité TH #
names(data)[names(data) == "X.58"] <- "Combien_Mobilite_TH"
names(data)[names(data) == "X.59"] <- "Douleur_Mobilite_TH"
names(data)[names(data) == "X.60"] <- "Evolution_Mobilite_TH"
names(data)[names(data) == "X.61"] <- "Prise_Mobilite_TH"

# Nutrition TH #
names(data)[names(data) == "X.62"] <- "Combien_Nutrition_TH"
names(data)[names(data) == "X.63"] <- "Douleur_Nutrition_TH"
names(data)[names(data) == "X.64"] <- "Evolution_Nutrition_TH"
names(data)[names(data) == "X.65"] <- "Prise_Nutrition_TH"

# Stress TH #
names(data)[names(data) == "X.66"] <- "Combien_Stress_TH"
names(data)[names(data) == "X.67"] <- "Douleur_Stress_TH"
names(data)[names(data) == "X.68"] <- "Evolution_Stress_TH"
names(data)[names(data) == "X.69"] <- "Prise_Stress_TH"

# Phyto TH #
names(data)[names(data) == "X.70"] <- "Combien_Phyto_TH"
names(data)[names(data) == "X.71"] <- "Douleur_Phyto_TH"
names(data)[names(data) == "X.72"] <- "Evolution_Phyto_TH"
names(data)[names(data) == "X.73"] <- "Prise_Phyto_TH"

# Acup TH #
names(data)[names(data) == "X.74"] <- "Combien_Acup_TH"
names(data)[names(data) == "X.75"] <- "Douleur_Acup_TH"
names(data)[names(data) == "X.76"] <- "Evolution_Acup_TH"
names(data)[names(data) == "X.77"] <- "Prise_Acup_TH"

# Hypnose TH #
names(data)[names(data) == "X.78"] <- "Combien_Hypnose_TH"
names(data)[names(data) == "X.79"] <- "Douleur_Hypnose_TH"
names(data)[names(data) == "X.80"] <- "Evolution_Hypnose_TH"
names(data)[names(data) == "X.81"] <- "Prise_Hypnose_TH"

# Bouillotte TH #
names(data)[names(data) == "X.82"] <- "Combien_Bouillotte_TH"
names(data)[names(data) == "X.83"] <- "Douleur_Bouillotte_TH"
names(data)[names(data) == "X.84"] <- "Evolution_Bouillotte_TH"
names(data)[names(data) == "X.85"] <- "Prise_Bouillotte_TH"

# CBD TH #
names(data)[names(data) == "X.86"] <- "Combien_CBD_TH"
names(data)[names(data) == "X.87"] <- "Douleur_CBD_TH"
names(data)[names(data) == "X.88"] <- "Evolution_CBD_TH"
names(data)[names(data) == "X.89"] <- "Prise_CBD_TH"

# Tens TH #
names(data)[names(data) == "X.90"] <- "Combien_Tens_TH"
names(data)[names(data) == "X.91"] <- "Douleur_Tens_TH"
names(data)[names(data) == "X.92"] <- "Evolution_Tens_TH"
names(data)[names(data) == "X.93"] <- "Prise_Tens_TH"

### Questions générales CM ###
names(data)[names(data) == "X.94"] <- "Encore_CM"
names(data)[names(data) == "X.95"] <- "Depuis_CM"
names(data)[names(data) == "X.96"] <- "Debut_CM"
names(data)[names(data) == "X.97"] <- "Combien_CM"
names(data)[names(data) == "X.98"] <- "Pas_efficace_CM"
names(data)[names(data) == "X.99"] <- "ES_CM"
names(data)[names(data) == "X.100"] <- "Cout_CM"
names(data)[names(data) == "X.101"] <- "Autre_Cause_Fin_CM"
names(data)[names(data) == "X.102"] <- "Douleur_CM"
names(data)[names(data) == "X.103"] <- "Evolution_CM"
names(data)[names(data) == "X.104"] <- "Pre_op_CM"
names(data)[names(data) == "X.105"] <- "Post_op_CM"
names(data)[names(data) == "X.106"] <- "Pas_op_CM"
names(data)[names(data) == "X.107"] <- "Prise_CM"

### Effets secondaires CM ###
names(data)[names(data) == "X.108"] <- "Subi_ES_CM"
names(data)[names(data) == "X.109"] <- "Tete_CM"
names(data)[names(data) == "X.110"] <- "Fatigue_CM"
names(data)[names(data) == "X.111"] <- "Nausee_CM"
names(data)[names(data) == "X.112"] <- "Humeur_CM"
names(data)[names(data) == "X.113"] <- "Libido_CM"
names(data)[names(data) == "X.114"] <- "Sang_CM"
names(data)[names(data) == "X.115"] <- "Poids_CM"
names(data)[names(data) == "X.116"] <- "Allergie_CM"
names(data)[names(data) == "X.117"] <- "Thrombose_CM"
names(data)[names(data) == "X.118"] <- "Autre_ES_CM"
names(data)[names(data) == "X.119"] <- "Apparition_Tete_CM"
names(data)[names(data) == "X.120"] <- "Frequence_Tete_CM"
names(data)[names(data) == "X.121"] <- "Apparition_Fatigue_CM"
names(data)[names(data) == "X.122"] <- "Frequence_Fatigue_CM"
names(data)[names(data) == "X.123"] <- "Apparition_Nausee_CM"
names(data)[names(data) == "X.124"] <- "Frequence_Nausee_CM"
names(data)[names(data) == "X.125"] <- "Apparition_Humeur_CM"
names(data)[names(data) == "X.126"] <- "Frequence_Humeur_CM"
names(data)[names(data) == "X.127"] <- "Apparition_Libido_CM"
names(data)[names(data) == "X.128"] <- "Frequence_Libido_CM"
names(data)[names(data) == "X.129"] <- "Apparition_Sang_CM"
names(data)[names(data) == "X.130"] <- "Frequence_Sang_CM"
names(data)[names(data) == "X.131"] <- "Apparition_Thrombose_CM"

### Traitements non médicamenteux CM ###
names(data)[names(data) == "X.132"] <- "Mobilite_CM"
names(data)[names(data) == "X.133"] <- "Nutrition_CM"
names(data)[names(data) == "X.134"] <- "Stress_CM"
names(data)[names(data) == "X.135"] <- "Phyto_CM"
names(data)[names(data) == "X.136"] <- "Acup_CM"
names(data)[names(data) == "X.137"] <- "Hypnose_CM"
names(data)[names(data) == "X.138"] <- "Bouillotte_CM"
names(data)[names(data) == "X.139"] <- "CBD_CM"
names(data)[names(data) == "X.140"] <- "Tens_CM"
names(data)[names(data) == "X.141"] <- "Aucun_CM"

# Mobilite CM #
names(data)[names(data) == "X.142"] <- "Combien_Mobilite_CM"
names(data)[names(data) == "X.143"] <- "Douleur_Mobilite_CM"
names(data)[names(data) == "X.144"] <- "Evolution_Mobilite_CM"
names(data)[names(data) == "X.145"] <- "Prise_Mobilite_CM"

# Nutrition CM #
names(data)[names(data) == "X.146"] <- "Combien_Nutrition_CM"
names(data)[names(data) == "X.147"] <- "Douleur_Nutrition_CM"
names(data)[names(data) == "X.148"] <- "Evolution_Nutrition_CM"
names(data)[names(data) == "X.149"] <- "Prise_Nutrition_CM"

# Stress CM #
names(data)[names(data) == "X.150"] <- "Combien_Stress_CM"
names(data)[names(data) == "X.151"] <- "Douleur_Stress_CM"
names(data)[names(data) == "X.152"] <- "Evolution_Stress_CM"
names(data)[names(data) == "X.153"] <- "Prise_Stress_CM"

# Phyto CM #
names(data)[names(data) == "X.154"] <- "Combien_Phyto_CM"
names(data)[names(data) == "X.155"] <- "Douleur_Phyto_CM"
names(data)[names(data) == "X.156"] <- "Evolution_Phyto_CM"
names(data)[names(data) == "X.157"] <- "Prise_Phyto_CM"

# Acup CM #
names(data)[names(data) == "X.158"] <- "Combien_Acup_CM"
names(data)[names(data) == "X.159"] <- "Douleur_Acup_CM"
names(data)[names(data) == "X.160"] <- "Evolution_Acup_CM"
names(data)[names(data) == "X.161"] <- "Prise_Acup_CM"

# Hypnose CM #
names(data)[names(data) == "X.162"] <- "Combien_Hypnose_CM"
names(data)[names(data) == "X.163"] <- "Douleur_Hypnose_CM"
names(data)[names(data) == "X.164"] <- "Evolution_Hypnose_CM"
names(data)[names(data) == "X.165"] <- "Prise_Hypnose_CM"

# Bouillotte CM #
names(data)[names(data) == "X.166"] <- "Combien_Bouillotte_CM"
names(data)[names(data) == "X.167"] <- "Douleur_Bouillotte_CM"
names(data)[names(data) == "X.168"] <- "Evolution_Bouillotte_CM"
names(data)[names(data) == "X.169"] <- "Prise_Bouillotte_CM"

# CBD CM #
names(data)[names(data) == "X.170"] <- "Combien_CBD_CM"
names(data)[names(data) == "X.171"] <- "Douleur_CBD_CM"
names(data)[names(data) == "X.172"] <- "Evolution_CBD_CM"
names(data)[names(data) == "X.173"] <- "Prise_CBD_CM"

# Tens CM #
names(data)[names(data) == "X.174"] <- "Combien_Tens_CM"
names(data)[names(data) == "X.175"] <- "Douleur_Tens_CM"
names(data)[names(data) == "X.176"] <- "Evolution_Tens_CM"
names(data)[names(data) == "X.177"] <- "Prise_Tens_CM"

### Traitements non médicamenteux seuls ###
names(data)[names(data) == "X.178"] <- "Mobilite_NM"
names(data)[names(data) == "X.179"] <- "Nutrition_NM"
names(data)[names(data) == "X.180"] <- "Stress_NM"
names(data)[names(data) == "X.181"] <- "Phyto_NM"
names(data)[names(data) == "X.182"] <- "Acup_NM"
names(data)[names(data) == "X.183"] <- "Hypnose_NM"
names(data)[names(data) == "X.184"] <- "Bouillotte_NM"
names(data)[names(data) == "X.185"] <- "CBD_NM"
names(data)[names(data) == "X.186"] <- "Tens_NM"
names(data)[names(data) == "X.187"] <- "Aucun_NM"

# Mobilite NM #
names(data)[names(data) == "X.188"] <- "Encore_Mobilite_NM"
names(data)[names(data) == "X.189"] <- "Depuis_Mobilite_NM"
names(data)[names(data) == "X.190"] <- "Debut_Mobilite_NM"
names(data)[names(data) == "X.191"] <- "Combien_Mobilite_NM"
names(data)[names(data) == "X.192"] <- "Pas_efficace_Mobilite_NM"
names(data)[names(data) == "X.193"] <- "ES_Mobilite_NM"
names(data)[names(data) == "X.194"] <- "Cout_Mobilite_NM"
names(data)[names(data) == "X.195"] <- "Autre_Cause_Fin_Mobilite_NM"
names(data)[names(data) == "X.196"] <- "Douleur_Mobilite_NM"
names(data)[names(data) == "X.197"] <- "Evolution_Mobilite_NM"
names(data)[names(data) == "X.198"] <- "Pre_op_Mobilite_NM"
names(data)[names(data) == "X.199"] <- "Post_op_Mobilite_NM"
names(data)[names(data) == "X.200"] <- "Pas_op_Mobilite_NM"
names(data)[names(data) == "X.201"] <- "Prise_Mobilite_NM"

# Nutrition NM #
names(data)[names(data) == "X.202"] <- "Encore_Nutrition_NM"
names(data)[names(data) == "X.203"] <- "Depuis_Nutrition_NM"
names(data)[names(data) == "X.204"] <- "Debut_Nutrition_NM"
names(data)[names(data) == "X.205"] <- "Combien_Nutrition_NM"
names(data)[names(data) == "X.206"] <- "Pas_efficace_Nutrition_NM"
names(data)[names(data) == "X.207"] <- "ES_Nutrition_NM"
names(data)[names(data) == "X.208"] <- "Cout_Nutrition_NM"
names(data)[names(data) == "X.209"] <- "Autre_Cause_Fin_Nutrition_NM"
names(data)[names(data) == "X.210"] <- "Douleur_Nutrition_NM"
names(data)[names(data) == "X.211"] <- "Evolution_Nutrition_NM"
names(data)[names(data) == "X.212"] <- "Pre_op_Nutrition_NM"
names(data)[names(data) == "X.213"] <- "Post_op_Nutrition_NM"
names(data)[names(data) == "X.214"] <- "Pas_op_Nutrition_NM"
names(data)[names(data) == "X.215"] <- "Prise_Nutrition_NM"

# Stress NM #
names(data)[names(data) == "X.216"] <- "Encore_Stress_NM"
names(data)[names(data) == "X.217"] <- "Depuis_Stress_NM"
names(data)[names(data) == "X.218"] <- "Debut_Stress_NM"
names(data)[names(data) == "X.219"] <- "Combien_Stress_NM"
names(data)[names(data) == "X.220"] <- "Pas_efficace_Stress_NM"
names(data)[names(data) == "X.221"] <- "ES_Stress_NM"
names(data)[names(data) == "X.222"] <- "Cout_Stress_NM"
names(data)[names(data) == "X.223"] <- "Autre_Cause_Fin_Stress_NM"
names(data)[names(data) == "X.224"] <- "Douleur_Stress_NM"
names(data)[names(data) == "X.225"] <- "Evolution_Stress_NM"
names(data)[names(data) == "X.226"] <- "Pre_op_Stress_NM"
names(data)[names(data) == "X.227"] <- "Post_op_Stress_NM"
names(data)[names(data) == "X.228"] <- "Pas_op_Stress_NM"
names(data)[names(data) == "X.229"] <- "Prise_Stress_NM"

# Phyto NM #
names(data)[names(data) == "X.230"] <- "Encore_Phyto_NM"
names(data)[names(data) == "X.231"] <- "Depuis_Phyto_NM"
names(data)[names(data) == "X.232"] <- "Debut_Phyto_NM"
names(data)[names(data) == "X.233"] <- "Combien_Phyto_NM"
names(data)[names(data) == "X.234"] <- "Pas_efficace_Phyto_NM"
names(data)[names(data) == "X.235"] <- "ES_Phyto_NM"
names(data)[names(data) == "X.236"] <- "Cout_Phyto_NM"
names(data)[names(data) == "X.237"] <- "Autre_Cause_Fin_Phyto_NM"
names(data)[names(data) == "X.238"] <- "Douleur_Phyto_NM"
names(data)[names(data) == "X.239"] <- "Evolution_Phyto_NM"
names(data)[names(data) == "X.240"] <- "Pre_op_Phyto_NM"
names(data)[names(data) == "X.241"] <- "Post_op_Phyto_NM"
names(data)[names(data) == "X.242"] <- "Pas_op_Phyto_NM"
names(data)[names(data) == "X.243"] <- "Prise_Phyto_NM"

# Acup NM #
names(data)[names(data) == "X.244"] <- "Encore_Acup_NM"
names(data)[names(data) == "X.245"] <- "Depuis_Acup_NM"
names(data)[names(data) == "X.246"] <- "Debut_Acup_NM"
names(data)[names(data) == "X.247"] <- "Combien_Acup_NM"
names(data)[names(data) == "X.248"] <- "Pas_efficace_Acup_NM"
names(data)[names(data) == "X.249"] <- "ES_Acup_NM"
names(data)[names(data) == "X.250"] <- "Cout_Acup_NM"
names(data)[names(data) == "X.251"] <- "Autre_Cause_Fin_Acup_NM"
names(data)[names(data) == "X.252"] <- "Douleur_Acup_NM"
names(data)[names(data) == "X.253"] <- "Evolution_Acup_NM"
names(data)[names(data) == "X.254"] <- "Pre_op_Acup_NM"
names(data)[names(data) == "X.255"] <- "Post_op_Acup_NM"
names(data)[names(data) == "X.256"] <- "Pas_op_Acup_NM"
names(data)[names(data) == "X.257"] <- "Prise_Acup_NM"

# Hypnose NM #
names(data)[names(data) == "X.258"] <- "Encore_Hypnose_NM"
names(data)[names(data) == "X.259"] <- "Depuis_Hypnose_NM"
names(data)[names(data) == "X.260"] <- "Debut_Hypnose_NM"
names(data)[names(data) == "X.261"] <- "Combien_Hypnose_NM"
names(data)[names(data) == "X.262"] <- "Pas_efficace_Hypnose_NM"
names(data)[names(data) == "X.263"] <- "ES_Hypnose_NM"
names(data)[names(data) == "X.264"] <- "Cout_Hypnose_NM"
names(data)[names(data) == "X.265"] <- "Autre_Cause_Fin_Hypnose_NM"
names(data)[names(data) == "X.266"] <- "Douleur_Hypnose_NM"
names(data)[names(data) == "X.267"] <- "Evolution_Hypnose_NM"
names(data)[names(data) == "X.268"] <- "Pre_op_Hypnose_NM"
names(data)[names(data) == "X.269"] <- "Post_op_Hypnose_NM"
names(data)[names(data) == "X.270"] <- "Pas_op_Hypnose_NM"
names(data)[names(data) == "X.271"] <- "Prise_Hypnose_NM"

# Bouillotte NM #
names(data)[names(data) == "X.272"] <- "Encore_Bouillotte_NM"
names(data)[names(data) == "X.273"] <- "Depuis_Bouillotte_NM"
names(data)[names(data) == "X.274"] <- "Debut_Bouillotte_NM"
names(data)[names(data) == "X.275"] <- "Combien_Bouillotte_NM"
names(data)[names(data) == "X.276"] <- "Pas_efficace_Bouillotte_NM"
names(data)[names(data) == "X.277"] <- "ES_Bouillotte_NM"
names(data)[names(data) == "X.278"] <- "Cout_Bouillotte_NM"
names(data)[names(data) == "X.279"] <- "Autre_Cause_Fin_Bouillotte_NM"
names(data)[names(data) == "X.280"] <- "Douleur_Bouillotte_NM"
names(data)[names(data) == "X.281"] <- "Evolution_Bouillotte_NM"
names(data)[names(data) == "X.282"] <- "Pre_op_Bouillotte_NM"
names(data)[names(data) == "X.283"] <- "Post_op_Bouillotte_NM"
names(data)[names(data) == "X.284"] <- "Pas_op_Bouillotte_NM"
names(data)[names(data) == "X.285"] <- "Prise_Bouillotte_NM"

# CBD NM #
names(data)[names(data) == "X.286"] <- "Encore_CBD_NM"
names(data)[names(data) == "X.287"] <- "Depuis_CBD_NM"
names(data)[names(data) == "X.288"] <- "Debut_CBD_NM"
names(data)[names(data) == "X.289"] <- "Combien_CBD_NM"
names(data)[names(data) == "X.290"] <- "Pas_efficace_CBD_NM"
names(data)[names(data) == "X.291"] <- "ES_CBD_NM"
names(data)[names(data) == "X.292"] <- "Cout_CBD_NM"
names(data)[names(data) == "X.293"] <- "Autre_Cause_Fin_CBD_NM"
names(data)[names(data) == "X.294"] <- "Douleur_CBD_NM"
names(data)[names(data) == "X.295"] <- "Evolution_CBD_NM"
names(data)[names(data) == "X.296"] <- "Pre_op_CBD_NM"
names(data)[names(data) == "X.297"] <- "Post_op_CBD_NM"
names(data)[names(data) == "X.298"] <- "Pas_op_CBD_NM"
names(data)[names(data) == "X.299"] <- "Prise_CBD_NM"

# Tens NM #
names(data)[names(data) == "X.300"] <- "Encore_Tens_NM"
names(data)[names(data) == "X.301"] <- "Depuis_Tens_NM"
names(data)[names(data) == "X.302"] <- "Debut_Tens_NM"
names(data)[names(data) == "X.303"] <- "Combien_Tens_NM"
names(data)[names(data) == "X.304"] <- "Pas_efficace_Tens_NM"
names(data)[names(data) == "X.305"] <- "ES_Tens_NM"
names(data)[names(data) == "X.306"] <- "Cout_Tens_NM"
names(data)[names(data) == "X.307"] <- "Autre_Cause_Fin_Tens_NM"
names(data)[names(data) == "X.308"] <- "Douleur_Tens_NM"
names(data)[names(data) == "X.309"] <- "Evolution_Tens_NM"
names(data)[names(data) == "X.310"] <- "Pre_op_Tens_NM"
names(data)[names(data) == "X.311"] <- "Post_op_Tens_NM"
names(data)[names(data) == "X.312"] <- "Pas_op_Tens_NM"
names(data)[names(data) == "X.313"] <- "Prise_Tens_NM"

# Autres NM #
names(data)[names(data) == "X.314"] <- "Autres_NM"
names(data)[names(data) == "X.315"] <- "Lesquels_NM"

### Questions finales ###
names(data)[names(data) == "X.316"] <- "Remarques"
names(data)[names(data) == "X.317"] <- "Email"

### Supression des deux premières lignes ###
data <- data[-c(1:2), ]

### Questions préliminaires ###
data$Age = as.integer(data$Age)
data$Stade <- factor(data$Stade, levels = c("Stade I (superficielle)", "Stade II (modérée)", "Stade III (moyenne)", "Stade IV (profonde)"), ordered = TRUE)
data$Diagnostic = as.integer(data$Diagnostic)
data$Tabac <- factor(data$Tabac, levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), ordered = TRUE)
data$Alcool <- factor(data$Alcool, levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), ordered = TRUE)

TH <- ifelse(data$TH == "X", "1", "0")
data$TH <- factor(TH, levels = c("1", "0"), labels = c("1", "0"))

CM <- ifelse(data$CM == "X", "1", "0")
data$CM <- factor(CM, levels = c("1", "0"), labels = c("1", "0"))

Autre <- ifelse(data$Autre == "X", "1", "0")
data$Autre <- factor(Autre, levels = c("1", "0"), labels = c("1", "0"))

Aucun <- ifelse(data$Aucun == "X", "1", "0")
data$Aucun <- factor(Aucun, levels = c("1", "0"), labels = c("1", "0"))

data$Lesquels_M <- ifelse(data$Lesquels_M == "", "0", data$Lesquels_M)
#"Lesquels_M" à traiter dans un second temps

head(data)
print(data$TH)
#str(Aucun)

### Questions générales TH ###
Encore_TH <- ifelse(data$Encore_TH == "", "0", data$Encore_TH)
data$Encore_TH <- factor(Encore_TH, levels = c("Oui", "Non"), ordered = TRUE)

Debut_TH <- ifelse(data$Debut_TH == "", "0", data$Debut_TH)
data$Debut_TH = as.integer(Debut_TH)

Depuis_TH <- ifelse(data$Depuis_TH == "", "0", data$Depuis_TH)
data$Depuis_TH <- factor(Depuis_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_TH <- ifelse(data$Combien_TH == "", "0", data$Combien_TH)
data$Combien_TH <- factor(Combien_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_TH <- ifelse(data$Pas_efficace_TH == "X", "1", "0")
data$Pas_efficace_TH <- factor(Pas_efficace_TH, levels = c("1", "0"), labels = c("1", "0"))

ES_TH <- ifelse(data$ES_TH == "X", "1", "0")
data$ES_TH <- factor(ES_TH, levels = c("1", "0"), labels = c("1", "0"))

Cout_TH <- ifelse(data$Cout_TH == "X", "1", "0")
data$Cout_TH <- factor(Cout_TH, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_TH <- ifelse(data$Autre_Cause_Fin_TH == "X", "1", "0")
data$Autre_Cause_Fin_TH <- factor(Autre_Cause_Fin_TH, levels = c("1", "0"), labels = c("1", "0"))

Douleur_TH <- ifelse(data$Douleur_TH == "", "0", data$Douleur_TH)
data$Douleur_TH <- factor(Douleur_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_TH <- ifelse(data$Evolution_TH == "", "0", data$Evolution_TH)
data$Evolution_TH <- factor(Evolution_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_TH <- ifelse(data$Pre_op_TH == "X", "1", "0")
data$Pre_op_TH <- factor(Pre_op_TH, levels = c("1", "0"), labels = c("1", "0"))

Post_op_TH <- ifelse(data$Post_op_TH == "X", "1", "0")
data$Post_op_TH <- factor(Post_op_TH, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_TH <- ifelse(data$Pas_op_TH == "X", "1", "0")
data$Pas_op_TH <- factor(Pas_op_TH, levels = c("1", "0"), labels = c("1", "0"))

Prise_TH <- ifelse(data$Prise_TH == "", "0", data$Prise_TH)
data$Prise_TH <- factor(Prise_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_TH)
#print(Prise_TH)
#print(Pre_op_TH)

### Effets secondaires TH ###
Subi_ES_TH <- ifelse(data$Subi_ES_TH == "", "0", data$Subi_ES_TH)
data$Subi_ES_TH <- factor(Subi_ES_TH, levels = c("Oui", "Non"), ordered = TRUE)

Tete_TH <- ifelse(data$Tete_TH == "X", "1", "0")
data$Tete_TH <- factor(Tete_TH, levels = c("1", "0"), labels = c("1", "0"))

Fatigue_TH <- ifelse(data$Fatigue_TH == "X", "1", "0")
data$Fatigue_TH <- factor(Fatigue_TH, levels = c("1", "0"), labels = c("1", "0"))

Nausee_TH <- ifelse(data$Nausee_TH == "X", "1", "0")
data$Nausee_TH <- factor(Nausee_TH, levels = c("1", "0"), labels = c("1", "0"))

Humeur_TH <- ifelse(data$Humeur_TH == "X", "1", "0")
data$Humeur_TH <- factor(Humeur_TH, levels = c("1", "0"), labels = c("1", "0"))

Libido_TH <- ifelse(data$Libido_TH == "X", "1", "0")
data$Libido_TH <- factor(Libido_TH, levels = c("1", "0"), labels = c("1", "0"))

Sang_TH <- ifelse(data$Sang_TH == "X", "1", "0")
data$Sang_TH <- factor(Sang_TH, levels = c("1", "0"), labels = c("1", "0"))

Poids_TH <- ifelse(data$Poids_TH == "X", "1", "0")
data$Poids_TH <- factor(Poids_TH, levels = c("1", "0"), labels = c("1", "0"))

Allergie_TH <- ifelse(data$Allergie_TH == "X", "1", "0")
data$Allergie_TH <- factor(Allergie_TH, levels = c("1", "0"), labels = c("1", "0"))

Thrombose_TH <- ifelse(data$Thrombose_TH == "X", "1", "0")
data$Thrombose_TH <- factor(Thrombose_TH, levels = c("1", "0"), labels = c("1", "0"))

Autre_ES_TH <- ifelse(data$Autre_ES_TH == "X", "1", "0")
data$Autre_ES_TH <- factor(Autre_ES_TH, levels = c("1", "0"), labels = c("1", "0"))

Apparition_Tete_TH <- ifelse(data$Apparition_Tete_TH == "", "0", data$Apparition_Tete_TH)
data$Apparition_Tete_TH <- factor(Apparition_Tete_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Tete_TH <- ifelse(data$Frequence_Tete_TH == "", "0", data$Frequence_Tete_TH)
data$Frequence_Tete_TH <- factor(Frequence_Tete_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Fatigue_TH <- ifelse(data$Apparition_Fatigue_TH == "", "0", data$Apparition_Fatigue_TH)
data$Apparition_Fatigue_TH <- factor(Apparition_Fatigue_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Fatigue_TH <- ifelse(data$Frequence_Fatigue_TH == "", "0", data$Frequence_Fatigue_TH)
data$Frequence_Fatigue_TH <- factor(Frequence_Fatigue_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Nausee_TH <- ifelse(data$Apparition_Nausee_TH == "", "0", data$Apparition_Nausee_TH)
data$Apparition_Nausee_TH <- factor(Apparition_Nausee_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Nausee_TH <- ifelse(data$Frequence_Nausee_TH == "", "0", data$Frequence_Nausee_TH)
data$Frequence_Nausee_TH <- factor(Frequence_Nausee_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Humeur_TH <- ifelse(data$Apparition_Humeur_TH == "", "0", data$Apparition_Humeur_TH)
data$Apparition_Humeur_TH <- factor(Apparition_Humeur_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Humeur_TH <- ifelse(data$Frequence_Humeur_TH == "", "0", data$Frequence_Humeur_TH)
data$Frequence_Humeur_TH <- factor(Frequence_Humeur_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Libido_TH <- ifelse(data$Apparition_Libido_TH == "", "0", data$Apparition_Libido_TH)
data$Apparition_Libido_TH <- factor(Apparition_Libido_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Libido_TH <- ifelse(data$Frequence_Libido_TH == "", "0", data$Frequence_Libido_TH)
data$Frequence_Libido_TH <- factor(Frequence_Libido_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Sang_TH <- ifelse(data$Apparition_Sang_TH == "", "0", data$Apparition_Sang_TH)
data$Apparition_Sang_TH <- factor(Apparition_Sang_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Sang_TH <- ifelse(data$Frequence_Sang_TH == "", "0", data$Frequence_Sang_TH)
data$Frequence_Sang_TH <- factor(Frequence_Sang_TH, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Thrombose_TH <- ifelse(data$Apparition_Thrombose_TH == "", "0", data$Apparition_Thrombose_TH)
data$Apparition_Thrombose_TH <- factor(Apparition_Thrombose_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

#str(Apparition_Thrombose_TH)
#print(Apparition_Thrombose_TH)

#print("---------------------")

#str(Frequence_Sang_TH)
#print(Frequence_Sang_TH)

### Traitements non médicamenteux TH ###
Mobilite_TH <- ifelse(data$Mobilite_TH == "X", "1", "0")
data$Mobilite_TH <- factor(Mobilite_TH, levels = c("1", "0"), labels = c("1", "0"))

Nutrition_TH <- ifelse(data$Nutrition_TH == "X", "1", "0")
data$Nutrition_TH <- factor(Nutrition_TH, levels = c("1", "0"), labels = c("1", "0"))

Stress_TH <- ifelse(data$Stress_TH == "X", "1", "0")
data$Stress_TH <- factor(Stress_TH, levels = c("1", "0"), labels = c("1", "0"))

Phyto_TH <- ifelse(data$Phyto_TH == "X", "1", "0")
data$Phyto_TH <- factor(Phyto_TH, levels = c("1", "0"), labels = c("1", "0"))

Acup_TH <- ifelse(data$Acup_TH == "X", "1", "0")
data$Acup_TH <- factor(Acup_TH, levels = c("1", "0"), labels = c("1", "0"))

Hypnose_TH <- ifelse(data$Hypnose_TH == "X", "1", "0")
data$Hypnose_TH <- factor(Hypnose_TH, levels = c("1", "0"), labels = c("1", "0"))

Bouillotte_TH <- ifelse(data$Bouillotte_TH == "X", "1", "0")
data$Bouillotte_TH <- factor(Bouillotte_TH, levels = c("1", "0"), labels = c("1", "0"))

CBD_TH <- ifelse(data$CBD_TH == "X", "1", "0")
data$CBD_TH <- factor(CBD_TH, levels = c("1", "0"), labels = c("1", "0"))

Tens_TH <- ifelse(data$Tens_TH == "X", "1", "0")
data$Tens_TH <- factor(Tens_TH, levels = c("1", "0"), labels = c("1", "0"))

Aucun_TH <- ifelse(data$Aucun_TH == "X", "1", "0")
data$Aucun_TH <- factor(Aucun_TH, levels = c("1", "0"), labels = c("1", "0"))

# Mobilité TH #
Combien_Mobilite_TH <- ifelse(data$Combien_Mobilite_TH == "", "0", data$Combien_Mobilite_TH)
data$Combien_Mobilite_TH <- factor(Combien_Mobilite_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Mobilite_TH <- ifelse(data$Douleur_Mobilite_TH == "", "0", data$Douleur_Mobilite_TH)
data$Douleur_Mobilite_TH <- factor(Douleur_Mobilite_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Mobilite_TH <- ifelse(data$Evolution_Mobilite_TH == "", "0", data$Evolution_Mobilite_TH)
data$Evolution_Mobilite_TH <- factor(Evolution_Mobilite_TH, levels = c("Augmentation des lésions", "Pas d'impact sur les lésions", "Réduction des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Mobilite_TH <- ifelse(data$Prise_Mobilite_TH == "", "0", data$Prise_Mobilite_TH)
data$Prise_Mobilite_TH <- factor(Prise_Mobilite_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Nutrition TH #
Combien_Nutrition_TH <- ifelse(data$Combien_Nutrition_TH == "", "0", data$Combien_Nutrition_TH)
data$Combien_Nutrition_TH <- factor(Combien_Nutrition_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Nutrition_TH <- ifelse(data$Douleur_Nutrition_TH == "", "0", data$Douleur_Nutrition_TH)
data$Douleur_Nutrition_TH <- factor(Douleur_Nutrition_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Nutrition_TH <- ifelse(data$Evolution_Nutrition_TH == "", "0", data$Evolution_Nutrition_TH)
data$Evolution_Nutrition_TH <- factor(Evolution_Nutrition_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Nutrition_TH <- ifelse(data$Prise_Nutrition_TH == "", "0", data$Prise_Nutrition_TH)
data$Prise_Nutrition_TH <- factor(Prise_Nutrition_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Stress TH #
Combien_Stress_TH <- ifelse(data$Combien_Stress_TH == "", "0", data$Combien_Stress_TH)
data$Combien_Stress_TH <- factor(Combien_Stress_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Stress_TH <- ifelse(data$Douleur_Stress_TH == "", "0", data$Douleur_Stress_TH)
data$Douleur_Stress_TH <- factor(Douleur_Stress_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Stress_TH <- ifelse(data$Evolution_Stress_TH == "", "0", data$Evolution_Stress_TH)
data$Evolution_Stress_TH <- factor(Evolution_Stress_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Stress_TH <- ifelse(data$Prise_Stress_TH == "", "0", data$Prise_Stress_TH)
data$Prise_Stress_TH <- factor(Prise_Stress_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Phyto TH #
Combien_Phyto_TH <- ifelse(data$Combien_Phyto_TH == "", "0", data$Combien_Phyto_TH)
data$Combien_Phyto_TH <- factor(Combien_Phyto_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Phyto_TH <- ifelse(data$Douleur_Phyto_TH == "", "0", data$Douleur_Phyto_TH)
data$Douleur_Phyto_TH <- factor(Douleur_Phyto_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Phyto_TH <- ifelse(data$Evolution_Phyto_TH == "", "0", data$Evolution_Phyto_TH)
data$Evolution_Phyto_TH <- factor(Evolution_Phyto_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Phyto_TH <- ifelse(data$Prise_Phyto_TH == "", "0", data$Prise_Phyto_TH)
data$Prise_Phyto_TH <- factor(Prise_Phyto_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Acup TH #
Combien_Acup_TH <- ifelse(data$Combien_Acup_TH == "", "0", data$Combien_Acup_TH)
data$Combien_Acup_TH <- factor(Combien_Acup_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Acup_TH <- ifelse(data$Douleur_Acup_TH == "", "0", data$Douleur_Acup_TH)
data$Douleur_Acup_TH <- factor(Douleur_Acup_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Acup_TH <- ifelse(data$Evolution_Acup_TH == "", "0", data$Evolution_Acup_TH)
data$Evolution_Acup_TH <- factor(Evolution_Acup_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Acup_TH <- ifelse(data$Prise_Acup_TH == "", "0", data$Prise_Acup_TH)
data$Prise_Acup_TH <- factor(Prise_Acup_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Hypnose TH #
Combien_Hypnose_TH <- ifelse(data$Combien_Hypnose_TH == "", "0", data$Combien_Hypnose_TH)
data$Combien_Hypnose_TH <- factor(Combien_Hypnose_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Hypnose_TH <- ifelse(data$Douleur_Hypnose_TH == "", "0", data$Douleur_Hypnose_TH)
data$Douleur_Hypnose_TH <- factor(Douleur_Hypnose_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Hypnose_TH <- ifelse(data$Evolution_Hypnose_TH == "", "0", data$Evolution_Hypnose_TH)
data$Evolution_Hypnose_TH <- factor(Evolution_Hypnose_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Hypnose_TH <- ifelse(data$Prise_Hypnose_TH == "", "0", data$Prise_Hypnose_TH)
data$Prise_Hypnose_TH <- factor(Prise_Hypnose_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Bouillotte TH #
Combien_Bouillotte_TH <- ifelse(data$Combien_Bouillotte_TH == "", "0", data$Combien_Bouillotte_TH)
data$Combien_Bouillotte_TH <- factor(Combien_Bouillotte_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Bouillotte_TH <- ifelse(data$Douleur_Bouillotte_TH == "", "0", data$Douleur_Bouillotte_TH)
data$Douleur_Bouillotte_TH <- factor(Douleur_Bouillotte_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Bouillotte_TH <- ifelse(data$Evolution_Bouillotte_TH == "", "0", data$Evolution_Bouillotte_TH)
data$Evolution_Bouillotte_TH <- factor(Evolution_Bouillotte_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Bouillotte_TH <- ifelse(data$Prise_Bouillotte_TH == "", "0", data$Prise_Bouillotte_TH)
data$Prise_Bouillotte_TH <- factor(Prise_Bouillotte_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# CBD TH #
Combien_CBD_TH <- ifelse(data$Combien_CBD_TH == "", "0", data$Combien_CBD_TH)
data$Combien_CBD_TH <- factor(Combien_CBD_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_CBD_TH <- ifelse(data$Douleur_CBD_TH == "", "0", data$Douleur_CBD_TH)
data$Douleur_CBD_TH <- factor(Douleur_CBD_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_CBD_TH <- ifelse(data$Evolution_CBD_TH == "", "0", data$Evolution_CBD_TH)
data$Evolution_CBD_TH <- factor(Evolution_CBD_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_CBD_TH <- ifelse(data$Prise_CBD_TH == "", "0", data$Prise_CBD_TH)
data$Prise_CBD_TH <- factor(Prise_CBD_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Tens TH #
Combien_Tens_TH <- ifelse(data$Combien_Tens_TH == "", "0", data$Combien_Tens_TH)
data$Combien_Tens_TH <- factor(Combien_Tens_TH, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Tens_TH <- ifelse(data$Douleur_Tens_TH == "", "0", data$Douleur_Tens_TH)
data$Douleur_Tens_TH <- factor(Douleur_Tens_TH, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Tens_TH <- ifelse(data$Evolution_Tens_TH == "", "0", data$Evolution_Tens_TH)
data$Evolution_Tens_TH <- factor(Evolution_Tens_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Tens_TH <- ifelse(data$Prise_Tens_TH == "", "0", data$Prise_Tens_TH)
data$Prise_Tens_TH <- factor(Prise_Tens_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#print(data$Douleur_Phyto_TH)

### Questions générales CM ###
Encore_CM <- ifelse(data$Encore_CM == "", "0", data$Encore_CM)
data$Encore_CM <- factor(Encore_CM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_CM <- ifelse(data$Debut_CM == "", "0", data$Debut_CM)
data$Debut_CM = as.integer(Debut_CM)

Depuis_CM <- ifelse(data$Depuis_CM == "", "0", data$Depuis_CM)
data$Depuis_CM <- factor(Depuis_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_CM <- ifelse(data$Combien_CM == "", "0", data$Combien_CM)
data$Combien_CM <- factor(Combien_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_CM <- ifelse(data$Pas_efficace_CM == "X", "1", "0")
data$Pas_efficace_CM <- factor(Pas_efficace_CM, levels = c("1", "0"), labels = c("1", "0"))

ES_CM <- ifelse(data$ES_CM == "X", "1", "0")
data$ES_CM <- factor(ES_CM, levels = c("1", "0"), labels = c("1", "0"))

Cout_CM <- ifelse(data$Cout_CM == "X", "1", "0")
data$Cout_CM <- factor(Cout_CM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_CM <- ifelse(data$Autre_Cause_Fin_CM == "X", "1", "0")
data$Autre_Cause_Fin_CM <- factor(Autre_Cause_Fin_CM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_CM <- ifelse(data$Douleur_CM == "", "0", data$Douleur_CM)
data$Douleur_CM <- factor(Douleur_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_CM <- ifelse(data$Evolution_CM == "", "0", data$Evolution_CM)
data$Evolution_CM <- factor(Evolution_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_CM <- ifelse(data$Pre_op_CM == "X", "1", "0")
data$Pre_op_CM <- factor(Pre_op_CM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_CM <- ifelse(data$Post_op_CM == "X", "1", "0")
data$Post_op_CM <- factor(Post_op_CM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_CM <- ifelse(data$Pas_op_CM == "X", "1", "0")
data$Pas_op_CM <- factor(Pas_op_CM, levels = c("1", "0"), labels = c("1", "0"))

Prise_CM <- ifelse(data$Prise_CM == "", "0", data$Prise_CM)
data$Prise_CM <- factor(Prise_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_CM)
#print(Prise_CM)

### Effets secondaires CM ###
Subi_ES_CM <- ifelse(data$Subi_ES_CM == "", "0", data$Subi_ES_CM)
data$Subi_ES_CM <- factor(Subi_ES_CM, levels = c("Oui", "Non"), ordered = TRUE)

Tete_CM <- ifelse(data$Tete_CM == "X", "1", "0")
data$Tete_CM <- factor(Tete_CM, levels = c("1", "0"), labels = c("1", "0"))

Fatigue_CM <- ifelse(data$Fatigue_CM == "X", "1", "0")
data$Fatigue_CM <- factor(Fatigue_CM, levels = c("1", "0"), labels = c("1", "0"))

Nausee_CM <- ifelse(data$Nausee_CM == "X", "1", "0")
data$Nausee_CM <- factor(Nausee_CM, levels = c("1", "0"), labels = c("1", "0"))

Humeur_CM <- ifelse(data$Humeur_CM == "X", "1", "0")
data$Humeur_CM <- factor(Humeur_CM, levels = c("1", "0"), labels = c("1", "0"))

Libido_CM <- ifelse(data$Libido_CM == "X", "1", "0")
data$Libido_CM <- factor(Libido_CM, levels = c("1", "0"), labels = c("1", "0"))

Sang_CM <- ifelse(data$Sang_CM == "X", "1", "0")
data$Sang_CM <- factor(Sang_CM, levels = c("1", "0"), labels = c("1", "0"))

Poids_CM <- ifelse(data$Poids_CM == "X", "1", "0")
data$Poids_CM <- factor(Poids_CM, levels = c("1", "0"), labels = c("1", "0"))

Allergie_CM <- ifelse(data$Allergie_CM == "X", "1", "0")
data$Allergie_CM <- factor(Allergie_CM, levels = c("1", "0"), labels = c("1", "0"))

Thrombose_CM <- ifelse(data$Thrombose_CM == "X", "1", "0")
data$Thrombose_CM <- factor(Thrombose_CM, levels = c("1", "0"), labels = c("1", "0"))

Autre_ES_CM <- ifelse(data$Autre_ES_CM == "X", "1", "0")
data$Autre_ES_CM <- factor(Autre_ES_CM, levels = c("1", "0"), labels = c("1", "0"))

Apparition_Tete_CM <- ifelse(data$Apparition_Tete_CM == "", "0", data$Apparition_Tete_CM)
data$Apparition_Tete_CM <- factor(Apparition_Tete_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Tete_CM <- ifelse(data$Frequence_Tete_CM == "", "0", data$Frequence_Tete_CM)
data$Frequence_Tete_CM <- factor(Frequence_Tete_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Fatigue_CM <- ifelse(data$Apparition_Fatigue_CM == "", "0", data$Apparition_Fatigue_CM)
data$Apparition_Fatigue_CM <- factor(Apparition_Fatigue_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Fatigue_CM <- ifelse(data$Frequence_Fatigue_CM == "", "0", data$Frequence_Fatigue_CM)
data$Frequence_Fatigue_CM <- factor(Frequence_Fatigue_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Nausee_CM <- ifelse(data$Apparition_Nausee_CM == "", "0", data$Apparition_Nausee_CM)
data$Apparition_Nausee_CM <- factor(Apparition_Nausee_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Nausee_CM <- ifelse(data$Frequence_Nausee_CM == "", "0", data$Frequence_Nausee_CM)
data$Frequence_Nausee_CM <- factor(Frequence_Nausee_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Humeur_CM <- ifelse(data$Apparition_Humeur_CM == "", "0", data$Apparition_Humeur_CM)
data$Apparition_Humeur_CM <- factor(Apparition_Humeur_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Humeur_CM <- ifelse(data$Frequence_Humeur_CM == "", "0", data$Frequence_Humeur_CM)
data$Frequence_Humeur_CM <- factor(Frequence_Humeur_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Libido_CM <- ifelse(data$Apparition_Libido_CM == "", "0", data$Apparition_Libido_CM)
data$Apparition_Libido_CM <- factor(Apparition_Libido_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Libido_CM <- ifelse(data$Frequence_Libido_CM == "", "0", data$Frequence_Libido_CM)
data$Frequence_Libido_CM <- factor(Frequence_Libido_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Sang_CM <- ifelse(data$Apparition_Sang_CM == "", "0", data$Apparition_Sang_CM)
data$Apparition_Sang_CM <- factor(Apparition_Sang_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Frequence_Sang_CM <- ifelse(data$Frequence_Sang_CM == "", "0", data$Frequence_Sang_CM)
data$Frequence_Sang_CM <- factor(Frequence_Sang_CM, levels = c("Plusieurs fois par jour", "Plusieurs fois par semaine", "Plusieurs fois par mois", "Plusieurs fois par an", "Moins d'une fois par an"), ordered = TRUE)

Apparition_Thrombose_CM <- ifelse(data$Apparition_Thrombose_CM == "", "0", data$Apparition_Thrombose_CM)
data$Apparition_Thrombose_CM <- factor(Apparition_Thrombose_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

#str(Apparition_Thrombose_CM)
#print(Apparition_Thrombose_CM)

### Traitements non médicamenteux CM ###
Mobilite_CM <- ifelse(data$Mobilite_CM == "X", "1", "0")
data$Mobilite_CM <- factor(Mobilite_CM, levels = c("1", "0"), labels = c("1", "0"))

Nutrition_CM <- ifelse(data$Nutrition_CM == "X", "1", "0")
data$Nutrition_CM <- factor(Nutrition_CM, levels = c("1", "0"), labels = c("1", "0"))

Stress_CM <- ifelse(data$Stress_CM == "X", "1", "0")
data$Stress_CM <- factor(Stress_CM, levels = c("1", "0"), labels = c("1", "0"))

Phyto_CM <- ifelse(data$Phyto_CM == "X", "1", "0")
data$Phyto_CM <- factor(Phyto_CM, levels = c("1", "0"), labels = c("1", "0"))

Acup_CM <- ifelse(data$Acup_CM == "X", "1", "0")
data$Acup_CM <- factor(Acup_CM, levels = c("1", "0"), labels = c("1", "0"))

Hypnose_CM <- ifelse(data$Hypnose_CM == "X", "1", "0")
data$Hypnose_CM <- factor(Hypnose_CM, levels = c("1", "0"), labels = c("1", "0"))

Bouillotte_CM <- ifelse(data$Bouillotte_CM == "X", "1", "0")
data$Bouillotte_CM <- factor(Bouillotte_CM, levels = c("1", "0"), labels = c("1", "0"))

CBD_CM <- ifelse(data$CBD_CM == "X", "1", "0")
data$CBD_CM <- factor(CBD_CM, levels = c("1", "0"), labels = c("1", "0"))

Tens_CM <- ifelse(data$Tens_CM == "X", "1", "0")
data$Tens_CM <- factor(Tens_CM, levels = c("1", "0"), labels = c("1", "0"))

Aucun_CM <- ifelse(data$Aucun_CM == "X", "1", "0")
data$Aucun_CM <- factor(Aucun_CM, levels = c("1", "0"), labels = c("1", "0"))

# Mobilité CM #
Combien_Mobilite_CM <- ifelse(data$Combien_Mobilite_CM == "", "0", data$Combien_Mobilite_CM)
data$Combien_Mobilite_CM <- factor(Combien_Mobilite_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Mobilite_CM <- ifelse(data$Douleur_Mobilite_CM == "", "0", data$Douleur_Mobilite_CM)
data$Douleur_Mobilite_CM <- factor(Douleur_Mobilite_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Mobilite_CM <- ifelse(data$Evolution_Mobilite_CM == "", "0", data$Evolution_Mobilite_CM)
data$Evolution_Mobilite_CM <- factor(Evolution_Mobilite_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Mobilite_CM <- ifelse(data$Prise_Mobilite_CM == "", "0", data$Prise_Mobilite_CM)
data$Prise_Mobilite_CM <- factor(Prise_Mobilite_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Nutrition CM #
Combien_Nutrition_CM <- ifelse(data$Combien_Nutrition_CM == "", "0", data$Combien_Nutrition_CM)
data$Combien_Nutrition_CM <- factor(Combien_Nutrition_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Nutrition_CM <- ifelse(data$Douleur_Nutrition_CM == "", "0", data$Douleur_Nutrition_CM)
data$Douleur_Nutrition_CM <- factor(Douleur_Nutrition_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Nutrition_CM <- ifelse(data$Evolution_Nutrition_CM == "", "0", data$Evolution_Nutrition_CM)
data$Evolution_Nutrition_CM <- factor(Evolution_Nutrition_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Nutrition_CM <- ifelse(data$Prise_Nutrition_CM == "", "0", data$Prise_Nutrition_CM)
data$Prise_Nutrition_CM <- factor(Prise_Nutrition_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Stress CM #
Combien_Stress_CM <- ifelse(data$Combien_Stress_CM == "", "0", data$Combien_Stress_CM)
data$Combien_Stress_CM <- factor(Combien_Stress_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Stress_CM <- ifelse(data$Douleur_Stress_CM == "", "0", data$Douleur_Stress_CM)
data$Douleur_Stress_CM <- factor(Douleur_Stress_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Stress_CM <- ifelse(data$Evolution_Stress_CM == "", "0", data$Evolution_Stress_CM)
data$Evolution_Stress_CM <- factor(Evolution_Stress_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Stress_CM <- ifelse(data$Prise_Stress_CM == "", "0", data$Prise_Stress_CM)
data$Prise_Stress_CM <- factor(Prise_Stress_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Phyto CM #
Combien_Phyto_CM <- ifelse(data$Combien_Phyto_CM == "", "0", data$Combien_Phyto_CM)
data$Combien_Phyto_CM <- factor(Combien_Phyto_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Phyto_CM <- ifelse(data$Douleur_Phyto_CM == "", "0", data$Douleur_Phyto_CM)
data$Douleur_Phyto_CM <- factor(Douleur_Phyto_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Phyto_CM <- ifelse(data$Evolution_Phyto_CM == "", "0", data$Evolution_Phyto_CM)
data$Evolution_Phyto_CM <- factor(Evolution_Phyto_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Phyto_CM <- ifelse(data$Prise_Phyto_CM == "", "0", data$Prise_Phyto_CM)
data$Prise_Phyto_CM <- factor(Prise_Phyto_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Acup CM #
Combien_Acup_CM <- ifelse(data$Combien_Acup_CM == "", "0", data$Combien_Acup_CM)
data$Combien_Acup_CM <- factor(Combien_Acup_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Acup_CM <- ifelse(data$Douleur_Acup_CM == "", "0", data$Douleur_Acup_CM)
data$Douleur_Acup_CM <- factor(Douleur_Acup_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Acup_CM <- ifelse(data$Evolution_Acup_CM == "", "0", data$Evolution_Acup_CM)
data$Evolution_Acup_CM <- factor(Evolution_Acup_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Acup_CM <- ifelse(data$Prise_Acup_CM == "", "0", data$Prise_Acup_CM)
data$Prise_Acup_CM <- factor(Prise_Acup_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Hypnose CM #
Combien_Hypnose_CM <- ifelse(data$Combien_Hypnose_CM == "", "0", data$Combien_Hypnose_CM)
data$Combien_Hypnose_CM <- factor(Combien_Hypnose_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Hypnose_CM <- ifelse(data$Douleur_Hypnose_CM == "", "0", data$Douleur_Hypnose_CM)
data$Douleur_Hypnose_CM <- factor(Douleur_Hypnose_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Hypnose_CM <- ifelse(data$Evolution_Hypnose_CM == "", "0", data$Evolution_Hypnose_CM)
data$Evolution_Hypnose_CM <- factor(Evolution_Hypnose_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Hypnose_CM <- ifelse(data$Prise_Hypnose_CM == "", "0", data$Prise_Hypnose_CM)
data$Prise_Hypnose_CM <- factor(Prise_Hypnose_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Bouillotte CM #
Combien_Bouillotte_CM <- ifelse(data$Combien_Bouillotte_CM == "", "0", data$Combien_Bouillotte_CM)
data$Combien_Bouillotte_CM <- factor(Combien_Bouillotte_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Bouillotte_CM <- ifelse(data$Douleur_Bouillotte_CM == "", "0", data$Douleur_Bouillotte_CM)
data$Douleur_Bouillotte_CM <- factor(Douleur_Bouillotte_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Bouillotte_CM <- ifelse(data$Evolution_Bouillotte_CM == "", "0", data$Evolution_Bouillotte_CM)
data$Evolution_Bouillotte_CM <- factor(Evolution_Bouillotte_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Bouillotte_CM <- ifelse(data$Prise_Bouillotte_CM == "", "0", data$Prise_Bouillotte_CM)
data$Prise_Bouillotte_CM <- factor(Prise_Bouillotte_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# CBD CM #
Combien_CBD_CM <- ifelse(data$Combien_CBD_CM == "", "0", data$Combien_CBD_CM)
data$Combien_CBD_CM <- factor(Combien_CBD_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_CBD_CM <- ifelse(data$Douleur_CBD_CM == "", "0", data$Douleur_CBD_CM)
data$Douleur_CBD_CM <- factor(Douleur_CBD_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_CBD_CM <- ifelse(data$Evolution_CBD_CM == "", "0", data$Evolution_CBD_CM)
data$Evolution_CBD_CM <- factor(Evolution_CBD_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_CBD_CM <- ifelse(data$Prise_CBD_CM == "", "0", data$Prise_CBD_CM)
data$Prise_CBD_CM <- factor(Prise_CBD_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

# Tens CM #
Combien_Tens_CM <- ifelse(data$Combien_Tens_CM == "", "0", data$Combien_Tens_CM)
data$Combien_Tens_CM <- factor(Combien_Tens_CM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Douleur_Tens_CM <- ifelse(data$Douleur_Tens_CM == "", "0", data$Douleur_Tens_CM)
data$Douleur_Tens_CM <- factor(Douleur_Tens_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Diminution de la douleur"), ordered = TRUE)

Evolution_Tens_CM <- ifelse(data$Evolution_Tens_CM == "", "0", data$Evolution_Tens_CM)
data$Evolution_Tens_CM <- factor(Evolution_Tens_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Prise_Tens_CM <- ifelse(data$Prise_Tens_CM == "", "0", data$Prise_Tens_CM)
data$Prise_Tens_CM <- factor(Prise_Tens_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Tens_CM)

### Traitements non médicamenteux seuls ###
Mobilite_NM <- ifelse(data$Mobilite_NM == "X", "1", "0")
data$Mobilite_NM <- factor(Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

Nutrition_NM <- ifelse(data$Nutrition_NM == "X", "1", "0")
data$Nutrition_NM <- factor(Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

Stress_NM <- ifelse(data$Stress_NM == "X", "1", "0")
data$Stress_NM <- factor(Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

Phyto_NM <- ifelse(data$Phyto_NM == "X", "1", "0")
data$Phyto_NM <- factor(Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

Acup_NM <- ifelse(data$Acup_NM == "X", "1", "0")
data$Acup_NM <- factor(Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

Hypnose_NM <- ifelse(data$Hypnose_NM == "X", "1", "0")
data$Hypnose_NM <- factor(Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

Bouillotte_NM <- ifelse(data$Bouillotte_NM == "X", "1", "0")
data$Bouillotte_NM <- factor(Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

CBD_NM <- ifelse(data$CBD_NM == "X", "1", "0")
data$CBD_NM <- factor(CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

Tens_NM <- ifelse(data$Tens_NM == "X", "1", "0")
data$Tens_NM <- factor(Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

Aucun_NM <- ifelse(data$Aucun_NM == "X", "1", "0")
data$Aucun_NM <- factor(Aucun_NM, levels = c("1", "0"), labels = c("1", "0"))

#str(Aucun_NM)

# Mobilité NM #
Encore_Mobilite_NM <- ifelse(data$Encore_Mobilite_NM == "", "0", data$Encore_Mobilite_NM)
data$Encore_Mobilite_NM <- factor(Encore_Mobilite_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Mobilite_NM <- ifelse(data$Debut_Mobilite_NM == "", "0", data$Debut_Mobilite_NM)
data$Debut_Mobilite_NM <- as.integer(Debut_Mobilite_NM)

Depuis_Mobilite_NM <- ifelse(data$Depuis_Mobilite_NM == "", "0", data$Depuis_Mobilite_NM)
data$Depuis_Mobilite_NM <- factor(Depuis_Mobilite_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Mobilite_NM <- ifelse(data$Combien_Mobilite_NM == "", "0", data$Combien_Mobilite_NM)
data$Combien_Mobilite_NM <- factor(Combien_Mobilite_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Mobilite_NM <- ifelse(data$Pas_efficace_Mobilite_NM == "X", "1", "0")
data$Pas_efficace_Mobilite_NM <- factor(Pas_efficace_Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Mobilite_NM <- ifelse(data$ES_Mobilite_NM == "X", "1", "0")
data$ES_Mobilite_NM <- factor(ES_Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Mobilite_NM <- ifelse(data$Cout_Mobilite_NM == "X", "1", "0")
data$Cout_Mobilite_NM <- factor(Cout_Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Mobilite_NM <- ifelse(data$Autre_Cause_Fin_Mobilite_NM == "X", "1", "0")
data$Autre_Cause_Fin_Mobilite_NM <- factor(Autre_Cause_Fin_Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Mobilite_NM <- ifelse(data$Douleur_Mobilite_NM == "", "0", data$Douleur_Mobilite_NM)
data$Douleur_Mobilite_NM <- factor(Douleur_Mobilite_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Mobilite_NM <- ifelse(data$Evolution_Mobilite_NM == "", "0", data$Evolution_Mobilite_NM)
data$Evolution_Mobilite_NM <- factor(Evolution_Mobilite_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Mobilite_NM <- ifelse(data$Pre_op_Mobilite_NM == "X", "1", "0")
data$Pre_op_Mobilite_NM <- factor(Pre_op_Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Mobilite_NM <- ifelse(data$Post_op_Mobilite_NM == "X", "1", "0")
data$Post_op_Mobilite_NM <- factor(Post_op_Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Mobilite_NM <- ifelse(data$Pas_op_Mobilite_NM == "X", "1", "0")
data$Pas_op_Mobilite_NM <- factor(Pas_op_Mobilite_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Mobilite_NM <- ifelse(data$Prise_Mobilite_NM == "", "0", data$Prise_Mobilite_NM)
data$Prise_Mobilite_NM <- factor(Prise_Mobilite_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Mobilite_NM)
#print(Prise_Mobilite_NM)

# Nutrition NM #
Encore_Nutrition_NM <- ifelse(data$Encore_Nutrition_NM == "", "0", data$Encore_Nutrition_NM)
data$Encore_Nutrition_NM <- factor(Encore_Nutrition_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Nutrition_NM <- ifelse(data$Debut_Nutrition_NM == "", "0", data$Debut_Nutrition_NM)
data$Debut_Nutrition_NM <- as.integer(Debut_Nutrition_NM)

Depuis_Nutrition_NM <- ifelse(data$Depuis_Nutrition_NM == "", "0", data$Depuis_Nutrition_NM)
data$Depuis_Nutrition_NM <- factor(Depuis_Nutrition_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Nutrition_NM <- ifelse(data$Combien_Nutrition_NM == "", "0", data$Combien_Nutrition_NM)
data$Combien_Nutrition_NM <- factor(Combien_Nutrition_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Nutrition_NM <- ifelse(data$Pas_efficace_Nutrition_NM == "X", "1", "0")
data$Pas_efficace_Nutrition_NM <- factor(Pas_efficace_Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Nutrition_NM <- ifelse(data$ES_Nutrition_NM == "X", "1", "0")
data$ES_Nutrition_NM <- factor(ES_Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Nutrition_NM <- ifelse(data$Cout_Nutrition_NM == "X", "1", "0")
data$Cout_Nutrition_NM <- factor(Cout_Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Nutrition_NM <- ifelse(data$Autre_Cause_Fin_Nutrition_NM == "X", "1", "0")
data$Autre_Cause_Fin_Nutrition_NM <- factor(Autre_Cause_Fin_Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Nutrition_NM <- ifelse(data$Douleur_Nutrition_NM == "", "0", data$Douleur_Nutrition_NM)
data$Douleur_Nutrition_NM <- factor(Douleur_Nutrition_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Nutrition_NM <- ifelse(data$Evolution_Nutrition_NM == "", "0", data$Evolution_Nutrition_NM)
data$Evolution_Nutrition_NM <- factor(Evolution_Nutrition_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Nutrition_NM <- ifelse(data$Pre_op_Nutrition_NM == "X", "1", "0")
data$Pre_op_Nutrition_NM <- factor(Pre_op_Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Nutrition_NM <- ifelse(data$Post_op_Nutrition_NM == "X", "1", "0")
data$Post_op_Nutrition_NM <- factor(Post_op_Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Nutrition_NM <- ifelse(data$Pas_op_Nutrition_NM == "X", "1", "0")
data$Pas_op_Nutrition_NM <- factor(Pas_op_Nutrition_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Nutrition_NM <- ifelse(data$Prise_Nutrition_NM == "", "0", data$Prise_Nutrition_NM)
data$Prise_Nutrition_NM <- factor(Prise_Nutrition_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Nutrition_NM)
#print(Prise_Nutrition_NM)

# Stress NM #
Encore_Stress_NM <- ifelse(data$Encore_Stress_NM == "", "0", data$Encore_Stress_NM)
data$Encore_Stress_NM <- factor(Encore_Stress_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Stress_NM <- ifelse(data$Debut_Stress_NM == "", "0", data$Debut_Stress_NM)
data$Debut_Stress_NM <- as.integer(Debut_Stress_NM)

Depuis_Stress_NM <- ifelse(data$Depuis_Stress_NM == "", "0", data$Depuis_Stress_NM)
data$Depuis_Stress_NM <- factor(Depuis_Stress_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Stress_NM <- ifelse(data$Combien_Stress_NM == "", "0", data$Combien_Stress_NM)
data$Combien_Stress_NM <- factor(Combien_Stress_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Stress_NM <- ifelse(data$Pas_efficace_Stress_NM == "X", "1", "0")
data$Pas_efficace_Stress_NM <- factor(Pas_efficace_Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Stress_NM <- ifelse(data$ES_Stress_NM == "X", "1", "0")
data$ES_Stress_NM <- factor(ES_Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Stress_NM <- ifelse(data$Cout_Stress_NM == "X", "1", "0")
data$Cout_Stress_NM <- factor(Cout_Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Stress_NM <- ifelse(data$Autre_Cause_Fin_Stress_NM == "X", "1", "0")
data$Autre_Cause_Fin_Stress_NM <- factor(Autre_Cause_Fin_Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Stress_NM <- ifelse(data$Douleur_Stress_NM == "", "0", data$Douleur_Stress_NM)
data$Douleur_Stress_NM <- factor(Douleur_Stress_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Stress_NM <- ifelse(data$Evolution_Stress_NM == "", "0", data$Evolution_Stress_NM)
data$Evolution_Stress_NM <- factor(Evolution_Stress_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Stress_NM <- ifelse(data$Pre_op_Stress_NM == "X", "1", "0")
data$Pre_op_Stress_NM <- factor(Pre_op_Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Stress_NM <- ifelse(data$Post_op_Stress_NM == "X", "1", "0")
data$Post_op_Stress_NM <- factor(Post_op_Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Stress_NM <- ifelse(data$Pas_op_Stress_NM == "X", "1", "0")
data$Pas_op_Stress_NM <- factor(Pas_op_Stress_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Stress_NM <- ifelse(data$Prise_Stress_NM == "", "0", data$Prise_Stress_NM)
data$Prise_Stress_NM <- factor(Prise_Stress_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Stress_NM)
#print(Prise_Stress_NM)

# Phyto NM #
Encore_Phyto_NM <- ifelse(data$Encore_Phyto_NM == "", "0", data$Encore_Phyto_NM)
data$Encore_Phyto_NM <- factor(Encore_Phyto_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Phyto_NM <- ifelse(data$Debut_Phyto_NM == "", "0", data$Debut_Phyto_NM)
data$Debut_Phyto_NM <- as.integer(Debut_Phyto_NM)

Depuis_Phyto_NM <- ifelse(data$Depuis_Phyto_NM == "", "0", data$Depuis_Phyto_NM)
data$Depuis_Phyto_NM <- factor(Depuis_Phyto_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Phyto_NM <- ifelse(data$Combien_Phyto_NM == "", "0", data$Combien_Phyto_NM)
data$Combien_Phyto_NM <- factor(Combien_Phyto_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Phyto_NM <- ifelse(data$Pas_efficace_Phyto_NM == "X", "1", "0")
data$Pas_efficace_Phyto_NM <- factor(Pas_efficace_Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Phyto_NM <- ifelse(data$ES_Phyto_NM == "X", "1", "0")
data$ES_Phyto_NM <- factor(ES_Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Phyto_NM <- ifelse(data$Cout_Phyto_NM == "X", "1", "0")
data$Cout_Phyto_NM <- factor(Cout_Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Phyto_NM <- ifelse(data$Autre_Cause_Fin_Phyto_NM == "X", "1", "0")
data$Autre_Cause_Fin_Phyto_NM <- factor(Autre_Cause_Fin_Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Phyto_NM <- ifelse(data$Douleur_Phyto_NM == "", "0", data$Douleur_Phyto_NM)
data$Douleur_Phyto_NM <- factor(Douleur_Phyto_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Phyto_NM <- ifelse(data$Evolution_Phyto_NM == "", "0", data$Evolution_Phyto_NM)
data$Evolution_Phyto_NM <- factor(Evolution_Phyto_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Phyto_NM <- ifelse(data$Pre_op_Phyto_NM == "X", "1", "0")
data$Pre_op_Phyto_NM <- factor(Pre_op_Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Phyto_NM <- ifelse(data$Post_op_Phyto_NM == "X", "1", "0")
data$Post_op_Phyto_NM <- factor(Post_op_Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Phyto_NM <- ifelse(data$Pas_op_Phyto_NM == "X", "1", "0")
data$Pas_op_Phyto_NM <- factor(Pas_op_Phyto_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Phyto_NM <- ifelse(data$Prise_Phyto_NM == "", "0", data$Prise_Phyto_NM)
data$Prise_Phyto_NM <- factor(Prise_Phyto_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Phyto_NM)
#print(Prise_Phyto_NM)

# Acup NM #
Encore_Acup_NM <- ifelse(data$Encore_Acup_NM == "", "0", data$Encore_Acup_NM)
data$Encore_Acup_NM <- factor(Encore_Acup_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Acup_NM <- ifelse(data$Debut_Acup_NM == "", "0", data$Debut_Acup_NM)
data$Debut_Acup_NM <- as.integer(Debut_Acup_NM)

Depuis_Acup_NM <- ifelse(data$Depuis_Acup_NM == "", "0", data$Depuis_Acup_NM)
data$Depuis_Acup_NM <- factor(Depuis_Acup_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Acup_NM <- ifelse(data$Combien_Acup_NM == "", "0", data$Combien_Acup_NM)
data$Combien_Acup_NM <- factor(Combien_Acup_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Acup_NM <- ifelse(data$Pas_efficace_Acup_NM == "X", "1", "0")
data$Pas_efficace_Acup_NM <- factor(Pas_efficace_Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Acup_NM <- ifelse(data$ES_Acup_NM == "X", "1", "0")
data$ES_Acup_NM <- factor(ES_Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Acup_NM <- ifelse(data$Cout_Acup_NM == "X", "1", "0")
data$Cout_Acup_NM <- factor(Cout_Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Acup_NM <- ifelse(data$Autre_Cause_Fin_Acup_NM == "X", "1", "0")
data$Autre_Cause_Fin_Acup_NM <- factor(Autre_Cause_Fin_Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Acup_NM <- ifelse(data$Douleur_Acup_NM == "", "0", data$Douleur_Acup_NM)
data$Douleur_Acup_NM <- factor(Douleur_Acup_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Acup_NM <- ifelse(data$Evolution_Acup_NM == "", "0", data$Evolution_Acup_NM)
data$Evolution_Acup_NM <- factor(Evolution_Acup_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Acup_NM <- ifelse(data$Pre_op_Acup_NM == "X", "1", "0")
data$Pre_op_Acup_NM <- factor(Pre_op_Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Acup_NM <- ifelse(data$Post_op_Acup_NM == "X", "1", "0")
data$Post_op_Acup_NM <- factor(Post_op_Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Acup_NM <- ifelse(data$Pas_op_Acup_NM == "X", "1", "0")
data$Pas_op_Acup_NM <- factor(Pas_op_Acup_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Acup_NM <- ifelse(data$Prise_Acup_NM == "", "0", data$Prise_Acup_NM)
data$Prise_Acup_NM <- factor(Prise_Acup_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Acup_NM)
#print(Prise_Acup_NM)

# Hypnose NM #
Encore_Hypnose_NM <- ifelse(data$Encore_Hypnose_NM == "", "0", data$Encore_Hypnose_NM)
data$Encore_Hypnose_NM <- factor(Encore_Hypnose_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Hypnose_NM <- ifelse(data$Debut_Hypnose_NM == "", "0", data$Debut_Hypnose_NM)
data$Debut_Hypnose_NM <- as.integer(Debut_Hypnose_NM)

Depuis_Hypnose_NM <- ifelse(data$Depuis_Hypnose_NM == "", "0", data$Depuis_Hypnose_NM)
data$Depuis_Hypnose_NM <- factor(Depuis_Hypnose_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Hypnose_NM <- ifelse(data$Combien_Hypnose_NM == "", "0", data$Combien_Hypnose_NM)
data$Combien_Hypnose_NM <- factor(Combien_Hypnose_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Hypnose_NM <- ifelse(data$Pas_efficace_Hypnose_NM == "X", "1", "0")
data$Pas_efficace_Hypnose_NM <- factor(Pas_efficace_Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Hypnose_NM <- ifelse(data$ES_Hypnose_NM == "X", "1", "0")
data$ES_Hypnose_NM <- factor(ES_Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Hypnose_NM <- ifelse(data$Cout_Hypnose_NM == "X", "1", "0")
data$Cout_Hypnose_NM <- factor(Cout_Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Hypnose_NM <- ifelse(data$Autre_Cause_Fin_Hypnose_NM == "X", "1", "0")
data$Autre_Cause_Fin_Hypnose_NM <- factor(Autre_Cause_Fin_Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Hypnose_NM <- ifelse(data$Douleur_Hypnose_NM == "", "0", data$Douleur_Hypnose_NM)
data$Douleur_Hypnose_NM <- factor(Douleur_Hypnose_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Hypnose_NM <- ifelse(data$Evolution_Hypnose_NM == "", "0", data$Evolution_Hypnose_NM)
data$Evolution_Hypnose_NM <- factor(Evolution_Hypnose_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Hypnose_NM <- ifelse(data$Pre_op_Hypnose_NM == "X", "1", "0")
data$Pre_op_Hypnose_NM <- factor(Pre_op_Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Hypnose_NM <- ifelse(data$Post_op_Hypnose_NM == "X", "1", "0")
data$Post_op_Hypnose_NM <- factor(Post_op_Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Hypnose_NM <- ifelse(data$Pas_op_Hypnose_NM == "X", "1", "0")
data$Pas_op_Hypnose_NM <- factor(Pas_op_Hypnose_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Hypnose_NM <- ifelse(data$Prise_Hypnose_NM == "", "0", data$Prise_Hypnose_NM)
data$Prise_Hypnose_NM <- factor(Prise_Hypnose_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Hypnose_NM)
#print(Prise_Hypnose_NM)

# Bouillotte NM #
Encore_Bouillotte_NM <- ifelse(data$Encore_Bouillotte_NM == "", "0", data$Encore_Bouillotte_NM)
data$Encore_Bouillotte_NM <- factor(Encore_Bouillotte_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Bouillotte_NM <- ifelse(data$Debut_Bouillotte_NM == "", "0", data$Debut_Bouillotte_NM)
data$Debut_Bouillotte_NM <- as.integer(Debut_Bouillotte_NM)

Depuis_Bouillotte_NM <- ifelse(data$Depuis_Bouillotte_NM == "", "0", data$Depuis_Bouillotte_NM)
data$Depuis_Bouillotte_NM <- factor(Depuis_Bouillotte_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Bouillotte_NM <- ifelse(data$Combien_Bouillotte_NM == "", "0", data$Combien_Bouillotte_NM)
data$Combien_Bouillotte_NM <- factor(Combien_Bouillotte_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Bouillotte_NM <- ifelse(data$Pas_efficace_Bouillotte_NM == "X", "1", "0")
data$Pas_efficace_Bouillotte_NM <- factor(Pas_efficace_Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Bouillotte_NM <- ifelse(data$ES_Bouillotte_NM == "X", "1", "0")
data$ES_Bouillotte_NM <- factor(ES_Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Bouillotte_NM <- ifelse(data$Cout_Bouillotte_NM == "X", "1", "0")
data$Cout_Bouillotte_NM <- factor(Cout_Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Bouillotte_NM <- ifelse(data$Autre_Cause_Fin_Bouillotte_NM == "X", "1", "0")
data$Autre_Cause_Fin_Bouillotte_NM <- factor(Autre_Cause_Fin_Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Bouillotte_NM <- ifelse(data$Douleur_Bouillotte_NM == "", "0", data$Douleur_Bouillotte_NM)
data$Douleur_Bouillotte_NM <- factor(Douleur_Bouillotte_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Bouillotte_NM <- ifelse(data$Evolution_Bouillotte_NM == "", "0", data$Evolution_Bouillotte_NM)
data$Evolution_Bouillotte_NM <- factor(Evolution_Bouillotte_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Bouillotte_NM <- ifelse(data$Pre_op_Bouillotte_NM == "X", "1", "0")
data$Pre_op_Bouillotte_NM <- factor(Pre_op_Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Bouillotte_NM <- ifelse(data$Post_op_Bouillotte_NM == "X", "1", "0")
data$Post_op_Bouillotte_NM <- factor(Post_op_Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Bouillotte_NM <- ifelse(data$Pas_op_Bouillotte_NM == "X", "1", "0")
data$Pas_op_Bouillotte_NM <- factor(Pas_op_Bouillotte_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Bouillotte_NM <- ifelse(data$Prise_Bouillotte_NM == "", "0", data$Prise_Bouillotte_NM)
data$Prise_Bouillotte_NM <- factor(Prise_Bouillotte_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Bouillotte_NM)
#print(Prise_Bouillotte_NM)

# CBD NM #
Encore_CBD_NM <- ifelse(data$Encore_CBD_NM == "", "0", data$Encore_CBD_NM)
data$Encore_CBD_NM <- factor(Encore_CBD_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_CBD_NM <- ifelse(data$Debut_CBD_NM == "", "0", data$Debut_CBD_NM)
data$Debut_CBD_NM <- as.integer(Debut_CBD_NM)

Depuis_CBD_NM <- ifelse(data$Depuis_CBD_NM == "", "0", data$Depuis_CBD_NM)
data$Depuis_CBD_NM <- factor(Depuis_CBD_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_CBD_NM <- ifelse(data$Combien_CBD_NM == "", "0", data$Combien_CBD_NM)
data$Combien_CBD_NM <- factor(Combien_CBD_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_CBD_NM <- ifelse(data$Pas_efficace_CBD_NM == "X", "1", "0")
data$Pas_efficace_CBD_NM <- factor(Pas_efficace_CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_CBD_NM <- ifelse(data$ES_CBD_NM == "X", "1", "0")
data$ES_CBD_NM <- factor(ES_CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_CBD_NM <- ifelse(data$Cout_CBD_NM == "X", "1", "0")
data$Cout_CBD_NM <- factor(Cout_CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_CBD_NM <- ifelse(data$Autre_Cause_Fin_CBD_NM == "X", "1", "0")
data$Autre_Cause_Fin_CBD_NM <- factor(Autre_Cause_Fin_CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_CBD_NM <- ifelse(data$Douleur_CBD_NM == "", "0", data$Douleur_CBD_NM)
data$Douleur_CBD_NM <- factor(Douleur_CBD_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_CBD_NM <- ifelse(data$Evolution_CBD_NM == "", "0", data$Evolution_CBD_NM)
data$Evolution_CBD_NM <- factor(Evolution_CBD_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_CBD_NM <- ifelse(data$Pre_op_CBD_NM == "X", "1", "0")
data$Pre_op_CBD_NM <- factor(Pre_op_CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_CBD_NM <- ifelse(data$Post_op_CBD_NM == "X", "1", "0")
data$Post_op_CBD_NM <- factor(Post_op_CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_CBD_NM <- ifelse(data$Pas_op_CBD_NM == "X", "1", "0")
data$Pas_op_CBD_NM <- factor(Pas_op_CBD_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_CBD_NM <- ifelse(data$Prise_CBD_NM == "", "0", data$Prise_CBD_NM)
data$Prise_CBD_NM <- factor(Prise_CBD_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_CBD_NM)
#print(Prise_CBD_NM)

# Tens NM #
Encore_Tens_NM <- ifelse(data$Encore_Tens_NM == "", "0", data$Encore_Tens_NM)
data$Encore_Tens_NM <- factor(Encore_Tens_NM, levels = c("Oui", "Non"), ordered = TRUE)

Debut_Tens_NM <- ifelse(data$Debut_Tens_NM == "", "0", data$Debut_Tens_NM)
data$Debut_Tens_NM <- as.integer(Debut_Tens_NM)

Depuis_Tens_NM <- ifelse(data$Depuis_Tens_NM == "", "0", data$Depuis_Tens_NM)
data$Depuis_Tens_NM <- factor(Depuis_Tens_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Combien_Tens_NM <- ifelse(data$Combien_Tens_NM == "", "0", data$Combien_Tens_NM)
data$Combien_Tens_NM <- factor(Combien_Tens_NM, levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), ordered = TRUE)

Pas_efficace_Tens_NM <- ifelse(data$Pas_efficace_Tens_NM == "X", "1", "0")
data$Pas_efficace_Tens_NM <- factor(Pas_efficace_Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

ES_Tens_NM <- ifelse(data$ES_Tens_NM == "X", "1", "0")
data$ES_Tens_NM <- factor(ES_Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

Cout_Tens_NM <- ifelse(data$Cout_Tens_NM == "X", "1", "0")
data$Cout_Tens_NM <- factor(Cout_Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

Autre_Cause_Fin_Tens_NM <- ifelse(data$Autre_Cause_Fin_Tens_NM == "X", "1", "0")
data$Autre_Cause_Fin_Tens_NM <- factor(Autre_Cause_Fin_Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

Douleur_Tens_NM <- ifelse(data$Douleur_Tens_NM == "", "0", data$Douleur_Tens_NM)
data$Douleur_Tens_NM <- factor(Douleur_Tens_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

Evolution_Tens_NM <- ifelse(data$Evolution_Tens_NM == "", "0", data$Evolution_Tens_NM)
data$Evolution_Tens_NM <- factor(Evolution_Tens_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

Pre_op_Tens_NM <- ifelse(data$Pre_op_Tens_NM == "X", "1", "0")
data$Pre_op_Tens_NM <- factor(Pre_op_Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

Post_op_Tens_NM <- ifelse(data$Post_op_Tens_NM == "X", "1", "0")
data$Post_op_Tens_NM <- factor(Post_op_Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

Pas_op_Tens_NM <- ifelse(data$Pas_op_Tens_NM == "X", "1", "0")
data$Pas_op_Tens_NM <- factor(Pas_op_Tens_NM, levels = c("1", "0"), labels = c("1", "0"))

Prise_Tens_NM <- ifelse(data$Prise_Tens_NM == "", "0", data$Prise_Tens_NM)
data$Prise_Tens_NM <- factor(Prise_Tens_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), ordered = TRUE)

#str(Prise_Tens_NM)
#print(Prise_Tens_NM)

# Autres NM #
data$Autres_NM <- factor(data$Autres_NM, levels = c("Oui", "Non"), ordered = TRUE)

data$Lesquels_NM <- ifelse(data$Lesquels_NM == "", "0", data$Lesquels_NM)
# "Lesquels_NM" à traiter dans un second temps

#print(Lesquels_NM)
#str(Autres_NM)

### Questions finales ###
data$Remarques <- ifelse(data$Remarques == "", "0", data$Remarques)
# "Remarques" à traiter dans un second temps

data$Email <- ifelse(data$Email == "", "0", data$Email)
# "Email" à traiter dans un second temps

#print(Email)

### Supression de la case Aucun_NM cochée par erreur ###
for (i in 1:nrow(data)) {
  if (data[i, "Aucun_NM"] == 1 & data[i, "Hypnose_NM"] == 1 & data[i, "Bouillotte_NM"] == 1) {
    data[i, "Aucun_NM"] = 0
    break  # Sortir de la boucle une fois que la ligne est trouvée
  }
}

### Création des 3 dataframes ###

#Premier data frame

data1 <- data[which(data$TH == 1), 11:94]
#head(data1)
#print(nrow(data1))

#Second data frame

data2 <- data[which(data$CM == 1), 95:178]
#head(data2)
#print(nrow(data2))

#Troisième data frame

data3 <- data[which(data$Aucun_NM == 0), 179:314]
head(data3)
print(nrow(data3))
```


# Analyse Exploratoire


## Âge

### Pyramide des âges de la bdd
```{r}
### Age ###

# Compter le nombre d'occurrences pour chaque âge
age_counts <- table(data$Age)

# Créer un dataframe à partir des résultats du comptage
df_age_counts <- data.frame(age = as.numeric(names(age_counts)),
                             count = as.numeric(age_counts))

options(repr.plot.width = 10, repr.plot.height = 8)

ggplot(df_age_counts, aes(x = age, y = count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Âge", y = "Nombre d'occurrences", title = "Pyramide des âges dans la base de données") +
  theme_minimal()
```

### Pyramide des âges de la pop française 
```{r}
# Lecture du fichier Excel et importation en tant que data frame
data_pop <- read_excel("demo-pop-pyram.xlsx")

data_pop <- data_pop[-c(1,2,103,104,105,106,107), ]

names(data_pop)[names(data_pop) == "Pyramide des âges en 2024"] <-"Annee_Naissance"
names(data_pop)[names(data_pop) == "...2"] <-"Age_revolu"
names(data_pop)[names(data_pop) == "...3"] <-"Nb_femmes"
names(data_pop)[names(data_pop) == "...4"] <-"Nb_hommes"
names(data_pop)[names(data_pop) == "...5"] <-"Ensemble"


data_pop$Annee_Naissance <- as.factor(data_pop$Annee_Naissance)
data_pop$Age_revolu <- as.numeric(data_pop$Age_revolu)
data_pop$Nb_femmes <- as.numeric(data_pop$Nb_femmes)
data_pop$Nb_hommes <- as.numeric(data_pop$Nb_hommes)
data_pop$Ensemble <- as.numeric(data_pop$Ensemble)

df_age_counts_bis <- data.frame(age = data_pop$Age_revolu,
                             count = data_pop$Nb_femmes)

ggplot(df_age_counts_bis, aes(x = age, y = count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Âge", y = "Nombre d'occurrences", title = "Pyramide des âges des femmes de la population française en 2024") +
  theme_minimal()
```

### Pyramides des âges côte à côte
```{r}
library(gridExtra)


plot1 <- ggplot(df_age_counts, aes(x = age, y = count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Âge", y = "Nombre d'occurrences", title = "Pyramide des âges dans la base de données") +
  theme_minimal()

df_age_counts_bis_filtre <- subset(df_age_counts_bis, age >= 17 & age <= 53)

plot2 <- ggplot(df_age_counts_bis_filtre, aes(x = age, y = count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Âge", y = "Nombre d'occurrences", title = "Pyramide des âges des femmes de la population française en 2024 (âges 18-53)") +
  theme_minimal()

grid.arrange(plot1, plot2, nrow = 1)
```

### Regroupement tranches d'age
```{r}
### Création des tranches d'age ###
bornes <- c(0, 25, 30, 35, 40, Inf)
labels <- c(" - de 25 ans", "26-30 ans", "31-35 ans", "36-40 ans", "+ de 40 ans")
df_age_counts$Tranches_age <- cut(df_age_counts$age, breaks = bornes, labels = labels, right = FALSE)
df_age_counts_bis_filtre$Tranches_age <- cut(df_age_counts_bis_filtre$age, breaks = bornes, labels = labels, right = FALSE)

# Histogramme pour df_age_counts
ggplot(df_age_counts, aes(x = Tranches_age, y = count)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Distribution des âges (Sondage)", x = "Tranches d'âge", y = "Nombre d'occurrences")

# Histogramme pour df_age_counts_bis_filtre
ggplot(df_age_counts_bis_filtre, aes(x = Tranches_age, y = count)) +
  geom_bar(stat = "identity", fill = "lightgreen") +
  labs(title = "Distribution des âges (Population française)", x = "Tranches d'âge", y = "Nombre d'occurrences")


```

### Regroupement en tranches d'âges bis
```{r}
#tranches_age <- cut(data$Age, breaks = 5)
#tranches_age_pyramide = cut(df_age_counts_bis_filtre$count, breaks = 5)

#plot(tranches_age)
#plot(tranches_age_pyramide)

#plot1 <- ggplot(tranches_age, aes(x = age, y = count)) +
#  geom_bar(stat = "identity", fill = "skyblue") +
#  labs(x = "Âge", y = "Nombre d'occurrences", title = "Pyramide des âges dans la base de données") +
#  theme_minimal()

#plot2 <- ggplot(tranches_age_pyramide, aes(x = age, y = count)) +
#  geom_bar(stat = "identity", fill = "skyblue") +
#  labs(x = "Âge", y = "Nombre d'occurrences", title = "Pyramide des âges des femmes de la population française en 2024 #(âges 18-53)") +
#  theme_minimal()

#grid.arrange(plot1, plot2, nrow = 1)

#length(df_age_counts_bis_filtre$age)
```

### Test khi2 d'adéquation des âges et des tranches d'âge
```{r}
# Effectuer un test du khi-deux pour comparer les distributions d'âge

print("Avec les ages bruts :")

chisq.test(df_age_counts$age, df_age_counts_bis$age[17:53])

print("----------------")
print("Avec les tranches d'age :")

chisq.test(df_age_counts$Tranches_age, df_age_counts_bis_filtre$Tranches_age)


####### "Chi-squared approximation may be incorrect" ????
```
Premier test :
p-value = 0.2376 > 0.05 (alpha=5%)

Il ne semble donc pas y avoir de différence significative entre les distributions d'âge des deux groupes (ie les femmes ayant répondu au sondage et l'ensemble des Françaises recensées en 2024).

Deuxième test :
p-value = 2,2.10e-16 < 0.05

=> Ages sont representatifs





## Evolution de la douleur en fonction de la durée de prise du traitement (Mosaic plots)

```{r}
##### Evolution de la douleur en fonction de la duree de prise du traitement TH (qu'il y ait eu arrêt ou non) #####

Duree_TH <- factor(ifelse(data1$Depuis_TH == "0", as.character(data1$Combien_TH), as.character(data1$Depuis_TH)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_TH <- table(Duree_TH, data1$Douleur_TH[data1$Douleur_TH != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_TH, main = "Mosaïque Douleur x Duree TH", cex.axis = 0.8, col = terrain.colors(length(unique(data1$Douleur_TH))), las=4, xlab = "")


##### Evolution de la douleur en fonction de la duree de prise du traitement CM (qu'il y ait eu arrêt ou non) #####

Duree_CM <- factor(ifelse(data2$Depuis_CM == "0", as.character(data2$Combien_CM), as.character(data2$Depuis_CM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_CM <- table(Duree_CM, data2$Douleur_CM[data2$Douleur_CM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_CM, main = "Mosaïque Douleur x Duree CM", cex.axis = 0.8, col = terrain.colors(length(unique(data2$Douleur_CM))), las=4, xlab = "")


##### Evolution de la douleur en fonction de la duree de prise du traitement Mobilite #####

dataM <- data3[which(data3$Mobilite_NM==1),] #Récupération de tous les individus ayant expérimenté la mobilité hors traitement médicamenteux

Duree_M <- factor(ifelse(dataM$Depuis_Mobilite == "0", as.character(dataM$Combien_Mobilite_NM), as.character(dataM$Depuis_Mobilite_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_M <- table(Duree_M, dataM$Douleur_Mobilite_NM[dataM$Douleur_Mobilite_NM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_M, main = "Mosaïque Douleur x Duree Mobilite", cex.axis = 0.8, col = terrain.colors(length(unique(dataM$Douleur_Mobilite_NM))), las=4, xlab = "")


##### Evolution de la douleur en fonction de la duree de prise du traitement Nutrition #####

dataN <- data3[which(data3$Nutrition_NM==1),] # Récupération de tous les individus ayant expérimenté la nutrition hors traitement médicamenteux

Duree_N <- factor(ifelse(dataN$Depuis_Nutrition == "0", as.character(dataN$Combien_Nutrition_NM), as.character(dataN$Depuis_Nutrition_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_N <- table(Duree_N, dataN$Douleur_Nutrition_NM[dataN$Douleur_Nutrition_NM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_N, main = "Mosaïque Douleur x Duree Nutrition", cex.axis = 0.8, col = terrain.colors(length(unique(dataN$Douleur_Nutrition_NM))), las=4, xlab="")


##### Evolution de la douleur en fonction de la duree de prise du traitement Gestion du stress #####

dataS <- data3[which(data3$Stress_NM==1),] # Récupération de tous les individus ayant expérimenté la gestion du stress hors traitement médicamenteux

Duree_S <- factor(ifelse(dataS$Depuis_Stress == "0", as.character(dataS$Combien_Stress_NM), as.character(dataS$Depuis_Stress_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

Douleur_S <- factor(dataS$Douleur_Stress_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur\n\n", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_duree_douleur_S <- table(Duree_S, Douleur_S)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_S, main = "Mosaïque Douleur x Duree Stress", cex.axis = 0.8, col = terrain.colors(length(unique(dataS$Douleur_Stress_NM))), las=4, xlab="", ylab="")


##### Evolution de la douleur en fonction de la duree de prise du traitement Phytothérapie #####

dataP <- data3[which(data3$Phyto_NM==1),] # Récupération de tous les individus ayant expérimenté la phytothérapie hors traitement médicamenteux

Duree_P <- factor(ifelse(dataP$Depuis_Phyto == "0", as.character(dataP$Combien_Phyto_NM), as.character(dataP$Depuis_Phyto_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_P <- table(Duree_P, dataP$Douleur_Phyto_NM[dataP$Douleur_Phyto_NM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_P, main = "Mosaïque Douleur x Duree Phyto", cex.axis = 0.8, col = terrain.colors(length(unique(dataP$Douleur_Phyto_NM))), las=4, xlab="")


##### Evolution de la douleur en fonction de la duree de prise du traitement Acupuncture #####

dataA <- data3[which(data3$Acup_NM==1),] # Récupération de tous les individus ayant expérimenté l'acupuncture hors traitement médicamenteux

Duree_A <- factor(ifelse(dataA$Depuis_Acup_NM == "0", as.character(dataA$Combien_Acup_NM), as.character(dataA$Depuis_Acup_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_A <- table(Duree_A, dataA$Douleur_Acup_NM[dataA$Douleur_Acup_NM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_A, main = "Mosaïque Douleur x Duree Acupuncture", cex.axis = 0.8, col = terrain.colors(length(unique(dataA$Douleur_Acup_NM))), las=4, xlab="")


##### Evolution de la douleur en fonction de la duree de prise du traitement Hypnose #####

dataH <- data3[which(data3$Hypnose_NM==1),] # Récupération de tous les individus ayant expérimenté l'hypnose hors traitement médicamenteux

Duree_H <- factor(ifelse(dataH$Depuis_Hypnose_NM == "0", as.character(dataH$Combien_Hypnose_NM),as.character(dataH$Depuis_Hypnose_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

Douleur_H <- factor(dataH$Douleur_Hypnose_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "\nPas d'impact sur la douleur", "\n\nRéduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_duree_douleur_H <- table(Duree_H,Douleur_H)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_H, main = "Mosaïque Douleur x Duree Hypnose", cex.axis = 0.8, col = terrain.colors(length(unique(dataH$Douleur_Hypnose_NM))), las=4, xlab="", ylab="")


##### Evolution de la douleur en fonction de la duree de prise du traitement Bouillotte #####

dataB <- data3[which(data3$Bouillotte_NM==1),] # Récupération de tous les individus ayant expérimenté la bouillotte hors traitement médicamenteux

Duree_B <- factor(ifelse(dataB$Depuis_Bouillotte == "0", as.character(dataB$Combien_Bouillotte_NM), as.character(dataB$Depuis_Bouillotte_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_B <- table(Duree_B, dataB$Douleur_Bouillotte_NM[dataB$Douleur_Bouillotte_NM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_B, main = "Mosaïque Douleur x Duree Bouillotte", cex.axis = 0.8, col = terrain.colors(length(unique(dataB$Douleur_Bouillotte_NM))), las=4, xlab="")


##### Evolution de la douleur en fonction de la duree de prise du traitement CBD #####

dataC <- data3[which(data3$CBD_NM==1),] # Récupération de tous les individus ayant expérimenté le CBD hors traitement médicamenteux

Duree_C <- factor(ifelse(dataC$Depuis_CBD == "0", as.character(dataC$Combien_CBD_NM), as.character(dataC$Depuis_CBD_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_C <- table(Duree_C, dataC$Douleur_CBD_NM[dataC$Douleur_CBD_NM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_C, main = "Mosaïque Douleur x Duree CBD", cex.axis = 0.8, col = terrain.colors(length(unique(dataC$Douleur_CBD_NM))), las=4, xlab="")


##### Evolution de la douleur en fonction de la duree de prise du traitement TENS #####

dataT <- data3[which(data3$Tens_NM==1),] # Récupération de tous les individus ayant expérimenté le TENS hors traitement médicamenteux

Duree_T <- factor(ifelse(dataT$Depuis_Tens == "0", as.character(dataT$Combien_Tens_NM), as.character(dataT$Depuis_Tens_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

table_contingence_duree_douleur_T <- table(Duree_T, dataT$Douleur_Tens_NM[dataT$Douleur_Tens_NM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_douleur_T, main = "Mosaïque Douleur x Duree TENS", cex.axis = 0.8, col = terrain.colors(length(unique(dataT$Douleur_Tens_NM))), las=4, xlab="")

```

Pour TH, CM, Mobilite?, Phyto, Tens : prendre le traitement + de 6 mois semble augmenter l'efficacité du traitement sur la douleur.
Pour CBD : il semble que plus le traitement est pris, + il y a réduction de la douleur
Pour les autres : pas de déduction par rapport à la durée de prise du traitement



## Evolution de la maladie en fonction de la durée de prise du traitement (Mosaic plots)

```{r}
##### Evolution de la maladie en fonction de la duree de prise du traitement TH (qu'il y ait eu arrêt ou non) #####

Duree_Evol_TH <- factor(ifelse(data1$Depuis_TH == "0", as.character(data1$Combien_TH), as.character(data1$Depuis_TH)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois", "\n3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

Evolution_TH <- factor(data1$Evolution_TH, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_TH <- table(Duree_Evol_TH, Evolution_TH)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_TH[,1:5], main = "Mosaïque Evolution x Duree TH", cex.axis = 0.8, col = terrain.colors(length(unique(data1$Evolution_TH))),las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement CM (qu'il y ait eu arrêt ou non) #####

Duree_Evol_CM <- factor(ifelse(data2$Depuis_CM == "0", as.character(data2$Combien_CM), as.character(data2$Depuis_CM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois\n", "3 mois /\n6 mois  ", "6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

Evolution_CM <- factor(data2$Evolution_CM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "\n\nPas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_CM <- table(Duree_Evol_CM, Evolution_CM)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_CM[,1:5], main = "Mosaïque Evolution x Duree CM", cex.axis = 0.8, col = terrain.colors(length(unique(data2$Evolution_CM))),las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Mobilite (qu'il y ait eu arrêt ou non) #####

Evolution_M <- factor(dataM$Evolution_Mobilite_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Mobilite <- table(Duree_M, Evolution_M)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Mobilite[,1:5], main = "Mosaïque Evolution x Duree Mobilite", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Mobilite_NM))),las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Nutrition (qu'il y ait eu arrêt ou non) #####

Evolution_N <- factor(dataN$Evolution_Nutrition_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Nutrition <- table(Duree_N, Evolution_N)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Nutrition[,1:5], main = "Mosaïque Evolution x Duree Nutrition", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Nutrition_NM))), las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Stress (qu'il y ait eu arrêt ou non) #####

Evolution_S <- factor(dataS$Evolution_Stress_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Stress <- table(Duree_S, Evolution_S)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Stress[,1:5], main = "Mosaïque Evolution x Duree Stress", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Stress_NM))), las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Phyto (qu'il y ait eu arrêt ou non) #####

Evolution_P <- factor(dataP$Evolution_Phyto_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Phyto <- table(Duree_P, Evolution_P)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Phyto[,1:5], main = "Mosaïque Evolution x Duree Phyto", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Phyto_NM))), las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Acup (qu'il y ait eu arrêt ou non) #####

Evolution_A <- factor(dataA$Evolution_Acup_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Acup <- table(Duree_A, Evolution_A)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Acup[,1:5], main = "Mosaïque Evolution x Duree Acup", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Acup_NM))), las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Hypnose (qu'il y ait eu arrêt ou non) #####

Evolution_H <- factor(dataH$Evolution_Hypnose_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Hypnose <- table(Duree_H, Evolution_H)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Hypnose[,1:5], main = "Mosaïque Evolution x Duree Hypnose", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Hypnose_NM))), las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Bouillotte (qu'il y ait eu arrêt ou non) #####

Duree_Evol_B <- factor(ifelse(dataB$Depuis_Bouillotte_NM == "0", as.character(dataB$Combien_Bouillotte_NM), as.character(dataB$Depuis_Bouillotte_NM)), levels = c("Moins de 3 mois", "Entre 3 et 6 mois", "Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans"), labels = c(".          - 3 mois\n", "3 mois /\n6 mois  ", "\n6 mois /\n2 ans  ", "2 ans /\n5 ans  ", ".          + 5 ans"), ordered = TRUE)

Evolution_B <- factor(dataB$Evolution_Bouillotte_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Bouillotte <- table(Duree_Evol_B, Evolution_B)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Bouillotte[,1:5], main = "Mosaïque Evolution x Duree Bouillotte", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Bouillotte_NM))), las = 4, xlab="", ylab="")


##### Evolution de la maladie en fonction de la duree de prise du traitement Tens (qu'il y ait eu arrêt ou non) #####

Evolution_T <- factor(dataT$Evolution_Tens_NM, levels = c("Apparition de nouvelles lésions", "Grossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions", "Réduction importante voire disparition des lésions", "Ne sais pas"), labels = c("Apparition de nouvelles lésions", "\nGrossissement des lésions déjà présentes", "Pas d'évolution", "Réduction modérée des lésions\n", "Réduction importante voire disparition des lésions", "Ne sais pas"), ordered = TRUE)

table_contingence_duree_evol_Tens <- table(Duree_T, Evolution_T)

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_duree_evol_Tens[,1:5], main = "Mosaïque Evolution x Duree Tens", cex.axis = 0.8, col = terrain.colors(length(unique(data3$Evolution_Tens_NM))), las = 4, xlab="", ylab="")

```

Pour TH : semble avoir une inluence positive sur la résorption des lésions au-delà de 6 mois



## Evolution de la douleur en fonction de la consommation de tabac (Mosaic plots)
```{r}
##### Efficacite douleur TH Tabac #####

Tabac_TH <- factor(data$Tabac[which(data$TH == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_TH <- table(Tabac_TH, data1$Douleur_TH[data1$Douleur_TH != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_TH, main = "Mosaïque Douleur x Tabac TH", cex.axis = 0.7, col = terrain.colors(length(unique(data1$Douleur_TH))),las=1, xlab="")


##### Efficacite douleur CM Tabac #####

Tabac_CM <- factor(data$Tabac[which(data$CM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_CM <- table(Tabac_CM, data2$Douleur_CM[data2$Douleur_CM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_CM, main = "Mosaïque Douleur x Tabac CM", cex.axis = 0.7, col = terrain.colors(length(unique(data2$Douleur_CM))), las=1, xlab="")


##### Efficacite douleur Mobilite Tabac #####

Tabac_M <- factor(data$Tabac[which(data$Mobilite_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_Mobilite <- table(Tabac_M, dataM$Douleur_Mobilite_NM[dataM$Douleur_Mobilite_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)
par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Mobilite, main = "Mosaïque Douleur x Tabac Mobilite", cex.axis = 0.7, col = terrain.colors(length(unique(dataM$Douleur_Mobilite_NM))), las=1, xlab="")

##### Efficacite douleur Nutrition Tabac #####


Tabac_N <- factor(data$Tabac[which(data$Nutrition_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)
Douleur_Tabac_N <- factor(dataN$Douleur_Nutrition_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "\nPas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_tabac_douleur_Nutrition <- table(Tabac_N, Douleur_Tabac_N)

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)
par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Nutrition, main = "Mosaïque Douleur x Tabac Nutrition", cex.axis = 0.7, col = terrain.colors(length(unique(dataN$Douleur_Nutrition_NM))), las=1, xlab="", ylab="")

##### Efficacite douleur Stress Tabac #####

Tabac_S <- factor(data$Tabac[which(data$Stress_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_Stress <- table(Tabac_S, dataS$Douleur_Stress_NM[dataS$Douleur_Stress_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Stress, main = "Mosaïque Douleur x Tabac Stress", cex.axis = 0.7, col = terrain.colors(length(unique(dataS$Douleur_Stress_NM))), las=1, xlab="")


##### Efficacite douleur Phyto Tabac #####

Tabac_P <- factor(data$Tabac[which(data$Phyto_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_Phyto <- table(Tabac_P, dataP$Douleur_Phyto_NM[dataP$Douleur_Phyto_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Phyto, main = "Mosaïque Douleur x Tabac Phyto", cex.axis = 0.7, col = terrain.colors(length(unique(dataP$Douleur_Phyto_NM))), las=1, xlab="")


##### Efficacite douleur Acup Tabac #####

Tabac_A <- factor(data$Tabac[which(data$Acup_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_Acup <- table(Tabac_A, dataA$Douleur_Acup_NM[dataA$Douleur_Acup_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Acup, main = "Mosaïque Douleur x Tabac Acupuncture", cex.axis = 0.7, col = terrain.colors(length(unique(dataA$Douleur_Acup_NM))), las=1, xlab="")


##### Efficacite douleur Hypnose Tabac #####

Tabac_H <- factor(data$Tabac[which(data$Hypnose_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_Hypnose <- table(Tabac_H, dataH$Douleur_Hypnose_NM[dataH$Douleur_Hypnose_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Hypnose, main = "Mosaïque Douleur x Tabac Hypnose", cex.axis = 0.7, col = terrain.colors(length(unique(dataH$Douleur_Hypnose_NM))), las=1, xlab="")


##### Efficacite douleur Bouillotte Tabac #####

Tabac_B <- factor(data$Tabac[which(data$Bouillotte_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

Douleur_Tabac_B <- factor(dataB$Douleur_Bouillotte_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "\nPas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_tabac_douleur_Bouillotte <- table(Tabac_B, Douleur_Tabac_B)

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Bouillotte, main = "Mosaïque Douleur x Tabac Bouillotte", cex.axis = 0.7, col = terrain.colors(length(unique(dataB$Douleur_Bouillotte_NM))), las=1, xlab="", ylab="")


##### Efficacite douleur CBD Tabac #####

Tabac_C <- factor(data$Tabac[which(data$CBD_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_CBD <- table(Tabac_C, dataC$Douleur_CBD_NM[dataC$Douleur_CBD_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_CBD, main = "Mosaïque Douleur x Tabac CBD", cex.axis = 0.7, col = terrain.colors(length(unique(dataC$Douleur_CBD_NM))), las=1, xlab="")


##### Efficacite douleur Tens Tabac #####

Tabac_T <- factor(data$Tabac[which(data$Tens_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_tabac_douleur_Tens <- table(Tabac_T, dataT$Douleur_Tens_NM[dataT$Douleur_Tens_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_tabac_douleur_Tens, main = "Mosaïque Douleur x Tabac Tens", cex.axis = 0.7, col = terrain.colors(length(unique(dataT$Douleur_Tens_NM))), las=1, xlab="")

```



## Evolution de la douleur en fonction de la consommation d'alcool (Mosaic plots)
```{r}
##### Efficacite douleur TH Alcool #####

Alcool_TH <- factor(data$Alcool[which(data$TH == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_alcool_douleur_TH <- table(Alcool_TH, data1$Douleur_TH[data1$Douleur_TH != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_TH, main = "Mosaïque Douleur x Alcool TH", cex.axis = 0.7, col = terrain.colors(length(unique(data1$Douleur_TH))), las=1, xlab="")


##### Efficacite douleur CM Alcool #####

Alcool_CM <- factor(data$Alcool[which(data$CM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

Douleur_Alcool_CM <- factor(data2$Douleur_CM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "\nPas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_alcool_douleur_CM <- table(Alcool_CM, Douleur_Alcool_CM)

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_CM, main = "Mosaïque Douleur x Alcool CM", cex.axis = 0.7, col = terrain.colors(length(unique(data2$Douleur_CM))), las=1, xlab="", ylab="")


##### Efficacite douleur Mobilite Alcool #####

Alcool_M <- factor(data$Alcool[which(data$Mobilite_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_alcool_douleur_Mobilite <- table(Alcool_M, dataM$Douleur_Mobilite_NM[dataM$Douleur_Mobilite_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Mobilite, main = "Mosaïque Douleur x Alcool Mobilite", cex.axis = 0.7, col = terrain.colors(length(unique(dataM$Douleur_Mobilite_NM))), las=1, xlab="")

##### Efficacite douleur Nutrition Alcool #####

Alcool_N <- factor(data$Alcool[which(data$Nutrition_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

Douleur_Alcool_N <- factor(dataN$Douleur_Nutrition_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "\nPas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_alcool_douleur_Nutrition <- table(Alcool_N, Douleur_Alcool_N)

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Nutrition, main = "Mosaïque Douleur x Alcool Nutrition", cex.axis = 0.7, col = terrain.colors(length(unique(dataN$Douleur_Nutrition_NM))), las=1, xlab="", ylab="")


##### Efficacite douleur Stress Alcool #####

Alcool_S <- factor(data$Alcool[which(data$Stress_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_alcool_douleur_Stress <- table(Alcool_S, dataS$Douleur_Stress_NM[dataS$Douleur_Stress_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Stress, main = "Mosaïque Douleur x Alcool Stress", cex.axis = 0.7, col = terrain.colors(length(unique(dataS$Douleur_Stress_NM))), las=1, xlab="")


##### Efficacite douleur Phyto Alcool #####

Alcool_P <- factor(data$Alcool[which(data$Phyto_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_alcool_douleur_Phyto <- table(Alcool_P, dataP$Douleur_Phyto_NM[dataP$Douleur_Phyto_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Phyto, main = "Mosaïque Douleur x Alcool Phyto", cex.axis = 0.7, col = terrain.colors(length(unique(dataP$Douleur_Phyto_NM))), las=1, xlab="")


##### Efficacite douleur Acup Alcool #####

Alcool_A <- factor(data$Alcool[which(data$Acup_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_alcool_douleur_Acup <- table(Alcool_A, dataA$Douleur_Acup_NM[dataA$Douleur_Acup_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Acup, main = "Mosaïque Douleur x Alcool Acup", cex.axis = 0.7, col = terrain.colors(length(unique(dataA$Douleur_Acup_NM))), las=1, xlab="")


##### Efficacite douleur Hypnose Alcool #####

Alcool_H <- factor(data$Alcool[which(data$Hypnose_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_alcool_douleur_Hypnose <- table(Alcool_H, dataH$Douleur_Hypnose_NM[dataH$Douleur_Hypnose_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Hypnose, main = "Mosaïque Douleur x Alcool Hypnose", cex.axis = 0.7, col = terrain.colors(length(unique(dataH$Douleur_Hypnose_NM))), las=1, xlab="")


##### Efficacite douleur Bouillotte Alcool #####

Alcool_B <- factor(data$Alcool[which(data$Bouillotte_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

Douleur_Alcool_B <- factor(dataB$Douleur_Bouillotte_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "\nPas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_alcool_douleur_Bouillotte <- table(Alcool_B, Douleur_Alcool_B)

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Bouillotte, main = "Mosaïque Douleur x Alcool Bouillotte", cex.axis = 0.7, col = terrain.colors(length(unique(dataB$Douleur_Bouillotte_NM))), las=1, xlab="", ylab="")


##### Efficacite douleur CBD Alcool #####

Alcool_C <- factor(data$Alcool[which(data$CBD_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

table_contingence_alcool_douleur_CBD <- table(Alcool_C, dataC$Douleur_CBD_NM[dataC$Douleur_CBD_NM != "0"])

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_CBD, main = "Mosaïque Douleur x Alcool CBD", cex.axis = 0.7, col = terrain.colors(length(unique(dataC$Douleur_CBD_NM))), las=1, xlab="")


##### Efficacite douleur Tens Alcool #####

Alcool_T <- factor(data$Alcool[which(data$Tens_NM == 1)], levels = c("Régulièrement (consommation hebdomadaire)", "Parfois (en certaines occasions)", "Jamais"), labels = c("Régulier", "Parfois", "Jamais"), ordered = TRUE)

Douleur_Alcool_T <- factor(dataT$Douleur_Tens_NM, levels = c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), labels = c("Augmentation de la douleur", "\nPas d'impact sur la douleur", "Réduction légère de la douleur", "Réduction importante de la douleur"), ordered = TRUE)

table_contingence_alcool_douleur_Tens <- table(Alcool_T, Douleur_Alcool_T)

margins <- par()$mar
margins[3] <- 3  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_alcool_douleur_Tens, main = "Mosaïque Douleur x Alcool Tens", cex.axis = 0.7, col = terrain.colors(length(unique(dataT$Douleur_Tens_NM))), las=1, xlab="", ylab="")

```

=> Ni alcool, ni tabac ne semblent avoir d'influence significative sur l'efficacité du TH.
(Seulement pour CM la conso d'alcool ou de tabac semble bénéfique ???)



## Evolution de la douleur en fonction de la fréquence de prise du traitement (Mosaic-plots)
```{r}
##### Evolution de la douleur sous TH en fonction de la prise #####

Prise_TH <- factor(data1$Prise_TH, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "   Occasionnelle\n\n"), ordered = TRUE)

table_contingence_prise_douleur_TH <- table(Prise_TH, data1$Douleur_TH[data1$Douleur_TH != "0"])

options(repr.plot.width = 8, repr.plot.height = 10)


margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_TH, main = "Mosaïque Douleur x Prise TH", cex.axis = 0.7, col = terrain.colors(length(unique(data1$Douleur_TH))), las=1, xlab="")


##### Evolution de la douleur sous CM en fonction de la prise #####

Prise_CM <- factor(data2$Prise_CM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_CM <- table(Prise_CM, data2$Douleur_CM[data2$Douleur_CM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_CM, main = "Mosaïque Douleur x Prise CM", cex.axis = 0.7, col = terrain.colors(length(unique(data2$Douleur_CM))), las=1, xlab="")


##### Evolution de la douleur sous Mobilite en fonction de la prise #####

Prise_M <- factor(dataM$Prise_Mobilite_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_Mobilite <- table(Prise_M, dataM$Douleur_Mobilite_NM[dataM$Douleur_Mobilite_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Mobilite, main = "Mosaïque Douleur x Prise Mobilite", cex.axis = 0.7, col = terrain.colors(length(unique(dataM$Douleur_Mobilite_NM))), las=1, xlab="")


##### Evolution de la douleur sous Nutrition en fonction de la prise #####

Prise_N <- factor(dataN$Prise_Nutrition_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle\n\n"), ordered = TRUE)

table_contingence_prise_douleur_Nutrition <- table(Prise_N, dataN$Douleur_Nutrition_NM[dataN$Douleur_Nutrition_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Nutrition, main = "Mosaïque Douleur x Prise Nutrition", cex.axis = 0.7, col = terrain.colors(length(unique(dataN$Douleur_Nutrition_NM))), las=1, xlab="")


##### Evolution de la douleur sous Stress en fonction de la prise #####

Prise_S <- factor(dataS$Prise_Stress_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_Stress <- table(Prise_S, dataS$Douleur_Stress_NM[dataS$Douleur_Stress_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Stress, main = "Mosaïque Douleur x Prise Stress", cex.axis = 0.7, col = terrain.colors(length(unique(dataS$Douleur_Stress_NM))), las=1, xlab="")


##### Evolution de la douleur sous Phyto en fonction de la prise #####

Prise_P <- factor(dataP$Prise_Phyto_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_Phyto <- table(Prise_P, dataP$Douleur_Phyto_NM[dataP$Douleur_Phyto_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Phyto, main = "Mosaïque Douleur x Prise Phyto", cex.axis = 0.7, col = terrain.colors(length(unique(dataP$Douleur_Phyto_NM))), las=1, xlab="")


##### Evolution de la douleur sous Acup en fonction de la prise #####

Prise_A <- factor(dataA$Prise_Acup_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_Acup <- table(Prise_A, dataA$Douleur_Acup_NM[dataA$Douleur_Acup_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Acup, main = "Mosaïque Douleur x Prise Acup", cex.axis = 0.7, col = terrain.colors(length(unique(dataA$Douleur_Acup_NM))), las=1, xlab="")


##### Evolution de la douleur sous Hypnose en fonction de la prise #####

Prise_H <- factor(dataH$Prise_Hypnose_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_Hypnose <- table(Prise_H, dataH$Douleur_Hypnose_NM[dataH$Douleur_Hypnose_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Hypnose, main = "Mosaïque Douleur x Prise Hypnose", cex.axis = 0.7, col = terrain.colors(length(unique(dataH$Douleur_Hypnose_NM))), las=1, xlab="")


##### Evolution de la douleur sous Bouillotte en fonction de la prise #####

Prise_B <- factor(dataB$Prise_Bouillotte_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_Bouillotte <- table(Prise_B, dataB$Douleur_Bouillotte_NM[dataB$Douleur_Bouillotte_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Bouillotte, main = "Mosaïque Douleur x Prise Bouillotte", cex.axis = 0.7, col = terrain.colors(length(unique(dataB$Douleur_Bouillotte_NM))), las=1, xlab="")


##### Evolution de la douleur sous CBD en fonction de la prise #####

Prise_C <- factor(dataC$Prise_CBD_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_CBD <- table(Prise_C, dataC$Douleur_CBD_NM[dataC$Douleur_CBD_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_CBD, main = "Mosaïque Douleur x Prise CBD", cex.axis = 0.7, col = terrain.colors(length(unique(dataC$Douleur_CBD_NM))), las=1, xlab="")


##### Evolution de la douleur sous Tens en fonction de la prise #####

Prise_T <- factor(dataT$Prise_Tens_NM, levels = c("Continue (toute l'année)", "Cyclique (ex : pendant 1 mois tous les ans)", "Occasionnelle"), labels = c("Continue", "Cyclique", "Occasionnelle"), ordered = TRUE)

table_contingence_prise_douleur_Tens <- table(Prise_T, dataT$Douleur_Tens_NM[dataT$Douleur_Tens_NM != "0"])

margins <- par()$mar
margins[3] <- 2  # Augmente la marge supérieure (la troisième valeur dans margins)

par(mar = margins)

mosaicplot(table_contingence_prise_douleur_Tens, main = "Mosaïque Douleur x Prise Tens", cex.axis = 0.7, col = terrain.colors(length(unique(dataT$Douleur_Tens_NM))), las=1, xlab="")

```
Pour TH : pas ultra pertinent car trop de prises continues en proportion pour être significatif.
Pour CM : type de prise ne semble pas trop impacter efficacité sur la douleur
Pour les TNM : same as CM



## Apparition des effets secondaires en fonction de la durée du traitement (Mosaic-plots)
```{r}
#Ont subi des effets secondaires en fonction duree traitement (TH)

table_contingence_duree_ES_TH <- table(Duree_TH, data1$Subi_ES_TH[data1$Subi_ES_TH != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

mosaicplot(table_contingence_duree_ES_TH, main = "Graphique de Mosaïque", cex.axis = 0.8, col = terrain.colors(length(unique(data1$Subi_ES_TH))), las = 4, xlab="")


#Ont subi des effets secondaires en fonction duree traitement (CM)

table_contingence_duree_ES_CM <- table(Duree_CM, data2$Subi_ES_CM[data2$Subi_ES_CM != "0"])

options(repr.plot.width = 12, repr.plot.height = 8)

mosaicplot(table_contingence_duree_ES_CM, main = "Graphique de Mosaïque", cex.axis = 0.8, col = terrain.colors(length(unique(data2$Subi_ES_CM))), las = 4, xlab="")

```
La durée de prise du traitement, que ce soit TH ou CM, ne semble pas influencer l'apparition des effets secondaires.



## Douleur TH / Douleur CM (Pie charts)
```{r}
library(RColorBrewer)

options(repr.plot.width = 16, repr.plot.height = 10)
par(mfrow = c(1, 2))

##### Choix des couleurs #####
colors_pastels_data1 <- brewer.pal(length(levels(data1$Douleur_TH)), "Pastel1")
colors_pastels_data2 <- brewer.pal(length(levels(data2$Douleur_CM)), "Pastel1")

##### Pie chart pour data1$Douleur_TH #####

data1_table <- table(data1$Douleur_TH)
data1_table <- data1_table[data1_table != 0]  # Filtrer les zéros

percentage_labels1 <- paste0(round(100 * prop.table(data1_table), 1), "%")
percentage_labels1 <- percentage_labels1[percentage_labels1 != "0%"]  # Filtrer les 0%

pie(data1_table, main = "Échelles de douleur sous Traitement Hormonal", labels = percentage_labels1, col = colors_pastels_data1, cex.main = 0.75)
legend("bottom", legend = names(data1_table), fill = colors_pastels_data1, title = "Douleur_TH", cex = 0.75, xpd = TRUE, inset = c(0, -0.3))

pie_table_TH <- table(data1$Douleur_TH)
text(0, 0, paste("Total:", sum(pie_table_TH)), cex = 0.8, pos = 2)

##### Pie chart pour data2$Douleur_CM ####
data2_table <- table(data2$Douleur_CM)
data2_table <- data2_table[data2_table != 0]  # Filtrer les zéros

percentage_labels2 <- paste0(round(100 * prop.table(data2_table), 1), "%")
percentage_labels2 <- percentage_labels2[percentage_labels2 != "0%"]  # Filtrer les 0%

pie(data2_table, main = "Échelles de douleur sous Cure de Ménopause", labels = percentage_labels2, col = colors_pastels_data2, cex.main = 0.75)
legend("bottom", legend = names(data2_table), fill = colors_pastels_data2, title = "Douleur_CM", cex = 0.75, xpd = TRUE, inset = c(0, -0.3))

pie_table_CM <- table(data2$Douleur_CM)
text(0, 0, paste("Total:", sum(pie_table_CM)), cex = 0.8, pos = 2)
```



## Évolution TH / Évolution CM (Pie charts)
```{r}
options(repr.plot.width = 16, repr.plot.height = 10)
par(mfrow = c(1, 2))

##### Choix des couleurs #####
colors_pastels_data1 <- brewer.pal(length(levels(data1$Evolution_TH)), "Pastel1")
colors_pastels_data2 <- brewer.pal(length(levels(data2$Evolution_CM)), "Pastel1")

##### Pie chart pour data1$Evolution_TH #####
data1_table <- table(data1$Evolution_TH)
data1_table <- data1_table[data1_table != 0]  # Filtrer les zéros

percentage_labels1 <- paste0(round(100 * prop.table(data1_table), 1), "%")
percentage_labels1 <- percentage_labels1[percentage_labels1 != "0%"]  # Filtrer les 0%

pie(data1_table, main = "Échelles d'évolution sous Traitement Hormonal", labels = percentage_labels1, col = colors_pastels_data1, cex.main = 0.75)
legend("bottom", legend = names(data1_table), fill = colors_pastels_data1, title = "Evolution_TH", cex = 0.7, xpd = TRUE, inset = c(0, -0.37))

pie_table_TH <- table(data1$Evolution_TH)
text(0, 0, paste("Total:", sum(pie_table_TH)), cex = 0.8, pos = 2)

##### Pie chart pour data2$Evolution_CM #####
data2_table <- table(data2$Evolution_CM)
data2_table <- data2_table[data2_table != 0]  # Filtrer les zéros

percentage_labels2 <- paste0(round(100 * prop.table(data2_table), 1), "%")
percentage_labels2 <- percentage_labels2[percentage_labels2 != "0%"]  # Filtrer les 0%

pie(data2_table, main = "Échelles d'évolution sous Cure de Ménopause", labels = percentage_labels2, col = colors_pastels_data2, cex.main = 0.75)
legend("bottom", legend = names(data2_table), fill = colors_pastels_data2, title = "Evolution_CM", cex = 0.7, xpd = TRUE, inset = c(0, -0.37))

pie_table_CM <- table(data2$Evolution_CM)
text(0, 0, paste("Total:", sum(pie_table_CM)), cex = 0.8, pos = 2)

```



## Rôle des TNM pris en combo avec TH sur la douleur

### Pie charts : indique l'évolution de la douleur grâce au TNM pris en combo avec TH
```{r}
##### Combo traitements non médicamenteux avec TH #####

library(RColorBrewer)

options(repr.plot.width = 20, repr.plot.height = 12)
par(mfrow = c(1, 3))

##### Camembert pour Traitement Hormonal x Mobilite #####

data1_MTH <- data1$Douleur_Mobilite_TH[data1$Mobilite_TH == 1]
colors_pastels_data_MTH <- brewer.pal(length(levels(data1_MTH)), "Pastel1")

data1_MTH_table <- table(data1_MTH)
data1_MTH_table <- data1_MTH_table[data1_MTH_table != 0]

percentage_labels_MTH <- paste0(round(100 * prop.table(data1_MTH_table), 1), "%")
percentage_labels_MTH <- percentage_labels_MTH[percentage_labels_MTH != "0%"]  # Filtrer les 0%

pie(data1_MTH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Mobilite", labels = percentage_labels_MTH, col = colors_pastels_data_MTH)
legend("bottom", legend = names(data1_MTH_table), fill = colors_pastels_data_MTH, title = "Douleur TH x Mobilite", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_MTH_table)), cex = 0.8, pos = 2)


##### Camembert pour Traitement Hormonal x Nutrition #####

data1_NTH <- data1$Douleur_Nutrition_TH[data1$Nutrition_TH == 1]
colors_pastels_data_NTH <- brewer.pal(length(levels(data1_NTH)), "Pastel1")

data1_NTH_table <- table(data1_NTH)
data1_NTH_table <- data1_NTH_table[data1_NTH_table != 0]

percentage_labels_NTH <- paste0(round(100 * prop.table(data1_NTH_table), 1), "%")
percentage_labels_NTH <- percentage_labels_NTH[percentage_labels_NTH != "0%"]  # Filtrer les 0%

pie(data1_NTH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Nutrition", labels = percentage_labels_NTH, col = colors_pastels_data_NTH)
legend("bottom", legend = names(data1_NTH_table), fill = colors_pastels_data_NTH, title = "Douleur TH x Nutrition", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_NTH_table)), cex = 0.8, pos = 2)


##### Camembert pour Traitement Hormonal x Stress #####

data1_STH <- data1$Douleur_Stress_TH[data1$Stress_TH == 1]
colors_pastels_data_STH <- brewer.pal(length(levels(data1_STH)), "Pastel1")

data1_STH_table <- table(data1_STH)
data1_STH_table <- data1_STH_table[data1_STH_table != 0]

percentage_labels_STH <- paste0(round(100 * prop.table(data1_STH_table), 1), "%")
percentage_labels_STH <- percentage_labels_STH[percentage_labels_STH != "0%"]  # Filtrer les 0%

pie(data1_STH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Stress", labels = percentage_labels_STH, col = colors_pastels_data_STH)
legend("bottom", legend = names(data1_STH_table), fill = colors_pastels_data_STH, title = "Douleur TH x Stress", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_STH_table)), cex = 0.8, pos = 2)
```

```{r}
options(repr.plot.width = 20, repr.plot.height = 15)
par(mfrow = c(1, 3))

##### Camembert pour Traitement Hormonal x Phyto #####

data1_PTH <- data1$Douleur_Phyto_TH[data1$Phyto_TH == 1]
colors_pastels_data_PTH <- brewer.pal(length(levels(data1_PTH)), "Pastel1")

data1_PTH_table <- table(data1_PTH)
data1_PTH_table <- data1_PTH_table[data1_PTH_table != 0]  # Filtrer les zéros

percentage_labels_PTH <- paste0(round(100 * prop.table(data1_PTH_table), 1), "%")
percentage_labels_PTH <- percentage_labels_PTH[percentage_labels_PTH != "0%"]  # Filtrer les 0%

pie(data1_PTH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Phyto", labels = percentage_labels_PTH, col = colors_pastels_data_PTH)
legend("bottom", legend = names(data1_PTH_table), fill = colors_pastels_data_PTH, title = "Douleur TH x Phyto", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_PTH_table)), cex = 0.8, pos = 2)


##### Camembert pour Traitement Hormonal x Acup #####

data1_ATH <- data1$Douleur_Acup_TH[data1$Acup_TH == 1]
colors_pastels_data_ATH <- brewer.pal(length(levels(data1_ATH)), "Pastel1")

data1_ATH_table <- table(data1_ATH)
data1_ATH_table <- data1_ATH_table[data1_ATH_table != 0]  # Filtrer les zéros

percentage_labels_ATH <- paste0(round(100 * prop.table(data1_ATH_table), 1), "%")
percentage_labels_ATH <- percentage_labels_ATH[percentage_labels_ATH != "0%"]  # Filtrer les 0%

pie(data1_ATH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Acup", labels = percentage_labels_ATH, col = colors_pastels_data_ATH)
legend("bottom", legend = names(data1_ATH_table), fill = colors_pastels_data_ATH, title = "Douleur TH x Acup", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_ATH_table)), cex = 0.8, pos = 2)


##### Camembert pour Traitement Hormonal x Hypnose #####

data1_HTH <- data1$Douleur_Hypnose_TH[data1$Hypnose_TH == 1]
colors_pastels_data_HTH <- brewer.pal(length(levels(data1_HTH)), "Pastel1")

data1_HTH_table <- table(data1_HTH)
data1_HTH_table <- data1_HTH_table[data1_HTH_table != 0]  # Filtrer les zéros

percentage_labels_HTH <- paste0(round(100 * prop.table(data1_HTH_table), 1), "%")
percentage_labels_HTH <- percentage_labels_HTH[percentage_labels_HTH != "0%"]  # Filtrer les 0%

pie(data1_HTH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Hypnose", labels = percentage_labels_HTH, col = colors_pastels_data_HTH)
legend("bottom", legend = names(data1_HTH_table), fill = colors_pastels_data_HTH, title = "Douleur TH x Hypnose", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_HTH_table)), cex = 0.8, pos = 2)

```

```{r}
options(repr.plot.width = 20, repr.plot.height = 15)
par(mfrow = c(1, 3))

# Camembert pour Traitement Hormonal x Bouillotte
data1_BTH <- data1$Douleur_Bouillotte_TH[data1$Bouillotte_TH == 1]
colors_pastels_data_BTH <- brewer.pal(length(levels(data1_BTH)), "Pastel1")

data1_BTH_table <- table(data1_BTH)
data1_BTH_table <- data1_BTH_table[data1_BTH_table != 0]  # Filtrer les zéros

percentage_labels_BTH <- paste0(round(100 * prop.table(data1_BTH_table), 1), "%")
percentage_labels_BTH <- percentage_labels_BTH[percentage_labels_BTH != "0%"]  # Filtrer les 0%

pie(data1_BTH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Bouillotte", labels = percentage_labels_BTH, col = colors_pastels_data_BTH)
legend("bottom", legend = names(data1_BTH_table), fill = colors_pastels_data_BTH, title = "Douleur TH x Bouillotte", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_BTH_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Hormonal x CBD
data1_CTH <- data1$Douleur_CBD_TH[data1$CBD_TH == 1]
colors_pastels_data_CTH <- brewer.pal(length(levels(data1_CTH)), "Pastel1")

data1_CTH_table <- table(data1_CTH)
data1_CTH_table <- data1_CTH_table[data1_CTH_table != 0]  # Filtrer les zéros

percentage_labels_CTH <- paste0(round(100 * prop.table(data1_CTH_table), 1), "%")
percentage_labels_CTH <- percentage_labels_CTH[percentage_labels_CTH != "0%"]  # Filtrer les 0%

pie(data1_CTH_table, main = "Échelles de douleur sous\nTraitement Hormonal x CBD", labels = percentage_labels_CTH, col = colors_pastels_data_CTH)
legend("bottom", legend = names(data1_CTH_table), fill = colors_pastels_data_CTH, title = "Douleur TH x CBD", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_CTH_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Hormonal x Tens
data1_TTH <- data1$Douleur_Tens_TH[data1$Tens_TH == 1]
colors_pastels_data_TTH <- brewer.pal(length(levels(data1_TTH)), "Pastel1")

data1_TTH_table <- table(data1_TTH)
data1_TTH_table <- data1_TTH_table[data1_TTH_table != 0]  # Filtrer les zéros

percentage_labels_TTH <- paste0(round(100 * prop.table(data1_TTH_table), 1), "%")
percentage_labels_TTH <- percentage_labels_TTH[percentage_labels_TTH != "0%"]  # Filtrer les 0%

pie(data1_TTH_table, main = "Échelles de douleur sous\nTraitement Hormonal x Tens", labels = percentage_labels_TTH, col = colors_pastels_data_TTH)
legend("bottom", legend = names(data1_TTH_table), fill = colors_pastels_data_TTH, title = "Douleur TH x Tens", cex = 0.9)

text(0, 0, paste("Total:", sum(data1_TTH_table)), cex = 0.8, pos = 2)

```


### Classement des combos par efficacité en pourcentage (barplots)
Trie les TNM de celui ayant le plus permis de réduire davantage la douleur en prise conjointe avec TH à celui y contribuant le moins

```{r}
options(repr.plot.width = 15, repr.plot.height = 8)

# Créer un vecteur contenant les noms des variables Douleur_qqch_TH
noms_variables <- c("Mobilite", "Nutrition", "Stress", "Phyto", "Acup", "Hypnose", "Bouillotte", "CBD", "Tens")

# Initialiser une liste pour stocker les pourcentages
pourcentages <- numeric(length(noms_variables))

# Calculer les pourcentages de "Diminution de la douleur" pour chaque variable
for (i in seq_along(noms_variables)) {
  variable <- paste0("Douleur_", noms_variables[i], "_TH")
  filtered_data <- data1[data1[[paste0(noms_variables[i], "_TH")]] == 1, ]
  pourcentages[i] <- sum(filtered_data[[variable]] == "Diminution de la douleur") / nrow(filtered_data) * 100
}

total1 = c(sum(data1_MTH_table), sum(data1_NTH_table), sum(data1_STH_table), sum(data1_PTH_table), sum(data1_ATH_table), sum(data1_HTH_table), sum(data1_BTH_table), sum(data1_CTH_table), sum(data1_TTH_table))

# Créer un dataframe pour stocker les résultats
resultats1 <- data.frame(Variable = noms_variables, Pourcentage = pourcentages, Total = total1)

# Trier le dataframe par ordre décroissant des pourcentages
resultats1 <- resultats1[order(resultats1$Pourcentage, decreasing = TRUE), ]

# Afficher les pourcentages avec les noms des variables
bp <- barplot(resultats1$Pourcentage, names.arg = resultats1$Variable,
        xlab = "Variable", ylab = "Pourcentage de 'Diminution de la douleur' ",
        main = "Pourcentage de 'Diminution de la douleur' par variable\npour chaque traitement non médicamenteux associé à TH",
        col = brewer.pal(length(noms_variables), "Pastel1"),
        ylim=c(0,100),
        cex.main = 1,
        cex.lab = 1,
        cex.names = 0.75)

# Ajouter les totaux sur chaque bâton
text(x = bp, y = 1, labels = resultats1$Total, pos = 3)

# Ajouter une barre horizontale en pointillés rouge à hauteur de 50
abline(h = 50, col = "red", lty = 2)

# Ajouter une barre horizontale en pointillés violet à hauteur de 75
abline(h = 75, col = "purple", lty = 2)

# Ajouter une barre horizontale en pointillés verte à hauteur de 25
abline(h = 25, col = "green", lty = 2)
```



## Rôle des TNM pris en combo avec CM sur la douleur

### Pie charts : indique l'évolution de la douleur grâce au TNM pris en combo avec CM
```{r}
# Combo traitements non médicamenteux avec CM

options(repr.plot.width = 20, repr.plot.height = 12)
par(mfrow = c(1, 3))

# Camembert pour Ménopause artificielle x Mobilite
data2_MCM <- data2$Douleur_Mobilite_CM[data2$Mobilite_CM == 1]
colors_pastels_data_MCM <- brewer.pal(length(levels(data2_MCM)), "Pastel1")

data2_MCM_table <- table(data2_MCM)
data2_MCM_table <- data2_MCM_table[data2_MCM_table != 0]  # Filtrer les zéros

percentage_labels_MCM <- paste0(round(100 * prop.table(data2_MCM_table), 1), "%")
percentage_labels_MCM <- percentage_labels_MCM[percentage_labels_MCM != "0%"]  # Filtrer les 0%

pie(data2_MCM_table, main = "Échelles de douleur sous\nMénopause artificielle x Mobilite", labels = percentage_labels_MCM, col = colors_pastels_data_MCM)
legend("bottom", legend = names(data2_MCM_table), fill = colors_pastels_data_MCM, title = "Douleur CM x Mobilite", cex = 0.9)

text(0, 0, paste("Total:", sum(data2_MCM_table)), cex = 0.8, pos = 2)

# Camembert pour Ménopause artificielle x Nutrition
data2_NCM <- data2$Douleur_Nutrition_CM[data2$Nutrition_CM == 1]
colors_pastels_data_NCM <- brewer.pal(length(levels(data2_NCM)), "Pastel1")

data2_NCM_table <- table(data2_NCM)
data2_NCM_table <- data2_NCM_table[data2_NCM_table != 0]  # Filtrer les zéros

percentage_labels_NCM <- paste0(round(100 * prop.table(data2_NCM_table), 1), "%")
percentage_labels_NCM <- percentage_labels_NCM[percentage_labels_NCM != "0%"]  # Filtrer les 0%

pie(data2_NCM_table, main = "Échelles de douleur sous\nMénopause artificielle x Nutrition", labels = percentage_labels_NCM, col = colors_pastels_data_NCM)
legend("bottom", legend = names(data2_NCM_table), fill = colors_pastels_data_NCM, title = "Douleur CM x Nutrition", cex = 0.9)

text(0, 0, paste("Total:", sum(data2_NCM_table)), cex = 0.8, pos = 2)

# Camembert pour Ménopause artificielle x Stress
data2_SCM <- data2$Douleur_Stress_CM[data2$Stress_CM == 1]
colors_pastels_data_SCM <- brewer.pal(length(levels(data2_SCM)), "Pastel1")

data2_SCM_table <- table(data2_SCM)
data2_SCM_table <- data2_SCM_table[data2_SCM_table != 0]  # Filtrer les zéros

percentage_labels_SCM <- paste0(round(100 * prop.table(data2_SCM_table), 1), "%")
percentage_labels_SCM <- percentage_labels_SCM[percentage_labels_SCM != "0%"]  # Filtrer les 0%

pie(data2_SCM_table, main = "Échelles de douleur sous\nMénopause artificielle x Stress", labels = percentage_labels_SCM, col = colors_pastels_data_SCM)
legend("bottom", legend = names(data2_SCM_table), fill = colors_pastels_data_SCM, title = "Douleur CM x Stress", cex = 0.9)

text(0, 0, paste("Total:", sum(data2_SCM_table)), cex = 0.8, pos = 2)

```

```{r}
options(repr.plot.width = 20, repr.plot.height = 15)
par(mfrow = c(1, 2))

# Camembert pour Traitement Hormonal x Phyto
data2_PCM <- data2$Douleur_Phyto_CM[data2$Phyto_CM == 1]
colors_pastels_data_PCM <- brewer.pal(length(levels(data2_PCM)), "Pastel1")  # Utilisation de Set2 pour plus de couleurs

data2_PCM_table <- table(data2_PCM)
data2_PCM_table <- data2_PCM_table[data2_PCM_table != 0]  # Filtrer les zéros

percentage_labels_PCM <- paste0(round(100 * prop.table(data2_PCM_table), 1), "%")
percentage_labels_PCM <- percentage_labels_PCM[percentage_labels_PCM != "0%"]  # Filtrer les 0%

pie(data2_PCM_table, main = "Échelles de douleur sous\nMénopause artificielle x Phyto", labels = percentage_labels_PCM, col = colors_pastels_data_PCM, cex.main = 0.9)
legend("bottom", legend = names(data2_PCM_table), fill = colors_pastels_data_PCM, title = "Douleur CM x Phyto", cex = 0.75, xpd = TRUE, inset = c(0, -0.3))

text(0, 0, paste("Total:", sum(data2_PCM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Hormonal x Acup
data2_ACM <- data2$Douleur_Acup_CM[data2$Acup_CM == 1]
colors_pastels_data_ACM <- brewer.pal(length(levels(data2_ACM)), "Pastel1")  # Utilisation de Set2 pour plus de couleurs

data2_ACM_table <- table(data2_ACM)
data2_ACM_table <- data2_ACM_table[data2_ACM_table != 0]  # Filtrer les zéros

percentage_labels_ACM <- paste0(round(100 * prop.table(data2_ACM_table), 1), "%")
percentage_labels_ACM <- percentage_labels_ACM[percentage_labels_ACM != "0%"]  # Filtrer les 0%

pie(data2_ACM_table, main = "Échelles de douleur sous\nMénopause artificielle x Acup", labels = percentage_labels_ACM, col = colors_pastels_data_ACM, cex.main = 0.9)
legend("bottom", legend = names(data2_ACM_table), fill = colors_pastels_data_ACM, title = "Douleur CM x Acup", cex = 0.75, xpd = TRUE, inset = c(0, -0.3))

text(0, 0, paste("Total:", sum(data2_ACM_table)), cex = 0.8, pos = 2)

```

```{r}
options(repr.plot.width = 20, repr.plot.height = 15)
par(mfrow = c(1, 3))

# Camembert pour Traitement Hormonal x Bouillotte
data2_BCM <- data2$Douleur_Bouillotte_CM[data2$Bouillotte_CM == 1]
colors_pastels_data_BCM <- brewer.pal(length(levels(data2_BCM)), "Pastel1")

data2_BCM_table <- table(data2_BCM)
data2_BCM_table <- data2_BCM_table[data2_BCM_table != 0]

percentage_labels_BCM <- paste0(round(100 * prop.table(data2_BCM_table), 1), "%")
percentage_labels_BCM <- percentage_labels_BCM[percentage_labels_BCM != "0%"]

pie(data2_BCM_table, main = "Échelles de douleur sous\nMénopause artificielle x Bouillotte", labels = percentage_labels_BCM, col = colors_pastels_data_BCM)
legend("bottom", legend = names(data2_BCM_table), fill = colors_pastels_data_BCM, title = "Douleur CM x Bouillotte", cex = 0.9)

text(0, 0, paste("Total:", sum(data2_BCM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Hormonal x CBD
data2_CCM <- data2$Douleur_CBD_CM[data2$CBD_CM == 1]
colors_pastels_data_CCM <- brewer.pal(length(levels(data2_CCM)), "Pastel1")

data2_CCM_table <- table(data2_CCM)
data2_CCM_table <- data2_CCM_table[data2_CCM_table != 0]

percentage_labels_CCM <- paste0(round(100 * prop.table(data2_CCM_table), 1), "%")
percentage_labels_CCM <- percentage_labels_CCM[percentage_labels_CCM != "0%"]

pie(data2_CCM_table, main = "Échelles de douleur sous\nMénopause artificielle x CBD", labels = percentage_labels_CCM, col = colors_pastels_data_CCM)
legend("bottom", legend = names(data2_CCM_table), fill = colors_pastels_data_CCM, title = "Douleur CM x CBD", cex = 0.9)

text(0, 0, paste("Total:", sum(data2_CCM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Hormonal x Tens
data2_TCM <- data2$Douleur_Tens_CM[data2$Tens_CM == 1]
colors_pastels_data_TCM <- brewer.pal(length(levels(data2_TCM)), "Pastel1")

data2_TCM_table <- table(data2_TCM)
data2_TCM_table <- data2_TCM_table[data2_TCM_table != 0]

percentage_labels_TCM <- paste0(round(100 * prop.table(data2_TCM_table), 1), "%")
percentage_labels_TCM <- percentage_labels_TCM[percentage_labels_TCM != "0%"]

pie(data2_TCM_table, main = "Échelles de douleur sous\nMénopause artificielle x Tens", labels = percentage_labels_TCM, col = colors_pastels_data_TCM)
legend("bottom", legend = names(data2_TCM_table), fill = colors_pastels_data_TCM, title = "Douleur CM x Tens", cex = 0.9)

text(0, 0, paste("Total:", sum(data2_TCM_table)), cex = 0.8, pos = 2)

```


### Classement des combos par efficacité en pourcentage (barplots)
Trie les TNM de celui ayant le plus permis de réduire davantage la douleur en prise conjointe avec CM à celui y contribuant le moins
```{r}
options(repr.plot.width = 15, repr.plot.height = 8)

# Créer un vecteur contenant les noms des variables Douleur_qqch_TH
noms_variables2 <- c("Mobilite", "Nutrition", "Stress", "Phyto", "Acup", "Bouillotte", "CBD", "Tens")

# Initialiser une liste pour stocker les pourcentages
pourcentages2 <- numeric(length(noms_variables2))

# Calculer les pourcentages de "Diminution de la douleur" pour chaque variable
for (i in seq_along(noms_variables2)) {
  variable2 <- paste0("Douleur_", noms_variables2[i], "_CM")
  filtered_data2 <- data2[data2[[paste0(noms_variables2[i], "_CM")]] == 1, ]
  pourcentages2[i] <- sum(filtered_data2[[variable2]] == "Diminution de la douleur") / nrow(filtered_data2) * 100
}

total2 = c(sum(data2_MCM_table), sum(data2_NCM_table), sum(data2_SCM_table), sum(data2_PCM_table), sum(data2_ACM_table), sum(data2_BCM_table), sum(data2_CCM_table), sum(data2_TCM_table))

# Créer un dataframe pour stocker les résultats
resultats2 <- data.frame(Variable = noms_variables2, Pourcentage = pourcentages2, Total = total2)

# Trier le dataframe par ordre décroissant des pourcentages
resultats2 <- resultats2[order(resultats2$Pourcentage, decreasing = TRUE), ]

# Afficher les résultats
#print(resultats)

# Afficher les pourcentages avec les noms des variables
bp <- barplot(resultats2$Pourcentage, names.arg = resultats2$Variable,
              xlab = "Variable", ylab = "Pourcentage de 'Diminution de la douleur' ",
              main = "Pourcentage de 'Diminution de la douleur' par variable\npour chaque traitement non médicamenteux associé à CM",
              col = brewer.pal(length(noms_variables2), "Pastel1"),
              ylim=c(0,100),
              cex.main = 1,
              cex.lab = 1,
              cex.names = 0.75)

# Ajouter les totaux sur chaque bâton
text(x = bp, y = 1, labels = resultats2$Total, pos = 3)

# Ajouter une barre horizontale en pointillés rouge à hauteur de 50
abline(h = 50, col = "red", lty = 2)

# Ajouter une barre horizontale en pointillés violet à hauteur de 75
abline(h = 75, col = "purple", lty = 2)

# Ajouter une barre horizontale en pointillés verte à hauteur de 25
abline(h = 25, col = "green", lty = 2)

```

Attention niveau interpretation : acupunture à 100% car peu de cas relevés



## Efficacité des TNM pris seuls sur la douleur

### Pie charts : indique l'évolution de la douleur en prenant le TNM 
```{r}
# Traitements non médicamenteux seuls : Pie chart

#install.packages("RColorBrewer")
library(RColorBrewer)

options(repr.plot.width = 20, repr.plot.height = 12)
par(mfrow = c(1, 3))

categoriesDNM <- c("Augmentation de la douleur", "Pas d'impact sur la douleur", "Réduction légère de la douleur","Réduction importante de la douleur")

# Camembert pour Traitement Non Médicamenteux x Mobilite
data3_MNM <- data3$Douleur_Mobilite_NM[data3$Mobilite_NM == 1]
colors_pastels_data_MNM <- brewer.pal(length(levels(data3_MNM)), "Pastel1")

data3_MNM_table <- table(data3_MNM)
data3_MNM_table <- data3_MNM_table[data3_MNM_table != 0]

percentage_labels_MNM <- paste0(round(100 * prop.table(data3_MNM_table), 1), "%")
percentage_labels_MNM <- percentage_labels_MNM[percentage_labels_MNM != "0%"]  # Filtrer les 0%

pie(data3_MNM_table, main = "Échelles de douleur sous\nMobilite du corps", labels = percentage_labels_MNM, col = colors_pastels_data_MNM)
legend("bottom", legend = names(data3_MNM_table), fill = colors_pastels_data_MNM, title = "Douleur sous Mobilite du corps", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_MNM_table)), cex = 0.8, pos = 2)

#print(data3_MNM_table)

# Camembert pour Traitement Non Médicamenteux x Nutrition
data3_NNM <- data3$Douleur_Nutrition_NM[data3$Nutrition_NM == 1]
colors_pastels_data_NNM <- brewer.pal(length(levels(data3_NNM)), "Pastel1")

data3_NNM_table <- table(data3_NNM)
data3_NNM_table <- data3_NNM_table[data3_NNM_table != 0]

percentage_labels_NNM <- paste0(round(100 * prop.table(data3_NNM_table), 1), "%")
percentage_labels_NNM <- percentage_labels_NNM[percentage_labels_NNM != "0%"]  # Filtrer les 0%

pie(data3_NNM_table, main = "Échelles de douleur sous\nSuivi nutritionnel", labels = percentage_labels_NNM, col = colors_pastels_data_NNM)
legend("bottom", legend = names(data3_NNM_table), fill = colors_pastels_data_NNM, title = "Douleur sous Suivi nutritionnel", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_NNM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Non Médicamenteux x Stress
data3_SNM <- data3$Douleur_Stress_NM[data3$Stress_NM == 1]
colors_pastels_data_SNM <- brewer.pal(length(levels(data3_SNM)), "Pastel1")

data3_SNM_table <- table(data3_SNM)
data3_SNM_table <- data3_SNM_table[data3_SNM_table != 0]

percentage_labels_SNM <- paste0(round(100 * prop.table(data3_SNM_table), 1), "%")
percentage_labels_SNM <- percentage_labels_SNM[percentage_labels_SNM != "0%"]  # Filtrer les 0%

pie(data3_SNM_table, main = "Échelles de douleur sous\nGestion du stress", labels = percentage_labels_SNM, col = colors_pastels_data_SNM)
legend("bottom", legend = names(data3_SNM_table), fill = colors_pastels_data_SNM, title = "Douleur sous Gestion du stress", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_SNM_table)), cex = 0.8, pos = 2)
```

```{r}
options(repr.plot.width = 20, repr.plot.height = 15)
par(mfrow = c(1, 3))

# Camembert pour Traitement Non Médicamenteux x Phyto
data3_PNM <- data3$Douleur_Phyto_NM[data3$Phyto_NM == 1]
colors_pastels_data_PNM <- brewer.pal(length(levels(data3_PNM)), "Pastel1")

data3_PNM_table <- table(data3_PNM)
data3_PNM_table <- data3_PNM_table[data3_PNM_table != 0]  # Filtrer les zéros

percentage_labels_PNM <- paste0(round(100 * prop.table(data3_PNM_table), 1), "%")
percentage_labels_PNM <- percentage_labels_PNM[percentage_labels_PNM != "0%"]  # Filtrer les 0%

pie(data3_PNM_table, main = "Échelles de douleur sous\nPhytothérapie", labels = percentage_labels_PNM, col = colors_pastels_data_PNM)
legend("bottom", legend = names(data3_PNM_table), fill = colors_pastels_data_PNM, title = "Douleur sous Phytothérapie", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_PNM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Non Médicamenteux x Acup
data3_ANM <- data3$Douleur_Acup_NM[data3$Acup_NM == 1]
colors_pastels_data_ANM <- brewer.pal(length(levels(data3_ANM)), "Pastel1")

data3_ANM_table <- table(data3_ANM)
data3_ANM_table <- data3_ANM_table[data3_ANM_table != 0]  # Filtrer les zéros

percentage_labels_ANM <- paste0(round(100 * prop.table(data3_ANM_table), 1), "%")
percentage_labels_ANM <- percentage_labels_ANM[percentage_labels_ANM != "0%"]  # Filtrer les 0%

pie(data3_ANM_table, main = "Échelles de douleur sous\nAcupuncture", labels = percentage_labels_ANM, col = colors_pastels_data_ANM)
legend("bottom", legend = names(data3_ANM_table), fill = colors_pastels_data_ANM, title = "Douleur sous Acupuncture", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_ANM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Non Médicamenteux x Hypnose
data3_HNM <- data3$Douleur_Hypnose_NM[data3$Hypnose_NM == 1]
colors_pastels_data_HNM <- brewer.pal(length(levels(data3_HNM)), "Pastel1")

data3_HNM_table <- table(data3_HNM)
data3_HNM_table <- data3_HNM_table[data3_HNM_table != 0]  # Filtrer les zéros

percentage_labels_HNM <- paste0(round(100 * prop.table(data3_HNM_table), 1), "%")
percentage_labels_HNM <- percentage_labels_HNM[percentage_labels_HNM != "0%"]  # Filtrer les 0%

pie(data3_HNM_table, main = "Échelles de douleur sous\nHypnose", labels = percentage_labels_HNM, col = colors_pastels_data_HNM)
legend("bottom", legend = names(data3_HNM_table), fill = colors_pastels_data_HNM, title = "Douleur sous Hypnose", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_HNM_table)), cex = 0.8, pos = 2)

```

```{r}
options(repr.plot.width = 20, repr.plot.height = 15)
par(mfrow = c(1, 3))

# Camembert pour Traitement Non Médicamenteux x Bouillotte
data3_BNM <- data3$Douleur_Bouillotte_NM[data3$Bouillotte_NM == 1]
colors_pastels_data_BNM <- brewer.pal(length(levels(data3_BNM)), "Pastel1")

data3_BNM_table <- table(data3_BNM)
data3_BNM_table <- data3_BNM_table[data3_BNM_table != 0]  # Filtrer les zéros

percentage_labels_BNM <- paste0(round(100 * prop.table(data3_BNM_table), 1), "%")
percentage_labels_BNM <- percentage_labels_BNM[percentage_labels_BNM != "0%"]  # Filtrer les 0%

pie(data3_BNM_table, main = "Échelles de douleur sous\nBouillotte", labels = percentage_labels_BNM, col = colors_pastels_data_BNM)
legend("bottom", legend = names(data3_BNM_table), fill = colors_pastels_data_BNM, title = "Douleur sous Bouillotte", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_BNM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Non Médicamenteux x CBD
data3_CNM <- data3$Douleur_CBD_NM[data3$CBD_NM == 1]
colors_pastels_data_CNM <- brewer.pal(length(levels(data3_CNM)), "Pastel1")

data3_CNM_table <- table(data3_CNM)
data3_CNM_table <- data3_CNM_table[data3_CNM_table != 0]  # Filtrer les zéros

percentage_labels_CNM <- paste0(round(100 * prop.table(data3_CNM_table), 1), "%")
percentage_labels_CNM <- percentage_labels_CNM[percentage_labels_CNM != "0%"]  # Filtrer les 0%

pie(data3_CNM_table, main = "Échelles de douleur sous\nCBD", labels = percentage_labels_CNM, col = colors_pastels_data_CNM)
legend("bottom", legend = names(data3_CNM_table), fill = colors_pastels_data_CNM, title = "Douleur sous CBD", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_CNM_table)), cex = 0.8, pos = 2)

# Camembert pour Traitement Non Médicamenteux x Tens
data3_TNM <- data3$Douleur_Tens_NM[data3$Tens_NM == 1]
colors_pastels_data_TNM <- brewer.pal(length(levels(data3_TNM)), "Pastel1")

data3_TNM_table <- table(data3_TNM)
data3_TNM_table <- data3_TNM_table[data3_TNM_table != 0]  # Filtrer les zéros

percentage_labels_TNM <- paste0(round(100 * prop.table(data3_TNM_table), 1), "%")
percentage_labels_TNM <- percentage_labels_TNM[percentage_labels_TNM != "0%"]  # Filtrer les 0%

pie(data3_TNM_table, main = "Échelles de douleur sous\nTens", labels = percentage_labels_TNM, col = colors_pastels_data_TNM)
legend("bottom", legend = names(data3_TNM_table), fill = colors_pastels_data_TNM, title = "Douleur sous Tens", cex = 0.75)

text(0, 0, paste("Total:", sum(data3_TNM_table)), cex = 0.8, pos = 2)
```


### Classement des combos par efficacité en pourcentage (barplots)
```{r}
options(repr.plot.width = 15, repr.plot.height = 8)

# Créer un vecteur contenant les noms des variables Douleur_qqch_TH
noms_variables3 <- c("Mobilite", "Nutrition", "Stress", "Phyto", "Acup", "Hypnose", "Bouillotte", "CBD", "Tens")

# Initialiser une liste pour stocker les pourcentages
pourcentages3 <- numeric(length(noms_variables3))

# Calculer les pourcentages de "Diminution de la douleur" pour chaque variable
for (i in seq_along(noms_variables3)) {
  variable3 <- paste0("Douleur_", noms_variables3[i], "_NM")
  filtered_data3 <- data3[data3[[paste0(noms_variables3[i], "_NM")]] == 1, ]
  pourcentages3[i] <- (sum(filtered_data3[[variable3]] == "Réduction légère de la douleur") + sum(filtered_data3[[variable3]] == "Réduction importante de la douleur")) / nrow(filtered_data3) * 100
}

total3 = c(sum(data3_MNM_table), sum(data3_NNM_table), sum(data3_SNM_table), sum(data3_PNM_table), sum(data3_ANM_table), sum(data3_HNM_table),sum(data3_BNM_table), sum(data3_CNM_table), sum(data3_TNM_table))

# Créer un dataframe pour stocker les résultats
resultats3 <- data.frame(Variable = noms_variables3, Pourcentage = pourcentages3, Total = total3)

# Trier le dataframe par ordre décroissant des pourcentages
resultats3 <- resultats3[order(resultats3$Pourcentage, decreasing = TRUE), ]

# Afficher les résultats
#print(resultats3)

# Afficher les pourcentages avec les noms des variables
bp <- barplot(resultats3$Pourcentage, names.arg = resultats3$Variable,
              xlab = "Variable", ylab = "Pourcentage de 'Diminution de la douleur' ",
              main = "Pourcentage de 'Diminution de la douleur' par variable pour chaque traitement non médicamenteux seul",
              col = brewer.pal(length(noms_variables3), "Pastel1"),
              ylim=c(0,100),
              cex.main = 0.75,
              cex.lab = 0.75,
              cex.names = 0.75)

# Ajouter les totaux sur chaque bâton
text(x = bp, y = 1, labels = resultats3$Total, pos = 3)

# Ajouter une barre horizontale en pointillés rouge à hauteur de 50
abline(h = 50, col = "red", lty = 2)

# Ajouter une barre horizontale en pointillés violet à hauteur de 75
abline(h = 75, col = "purple", lty = 2)

# Ajouter une barre horizontale en pointillés verte à hauteur de 25
abline(h = 25, col = "green", lty = 2)

```




## Tests de Chi_deux

### Test de Chi_deux Duree x Douleur

```{r}
######### Duree x Douleur TH ##########

## Nouvelle table
Duree_TH_sans_label <- factor(ifelse(is.na(data1$Depuis_TH), as.character(data1$Combien_TH), as.character(data1$Depuis_TH)))

Duree_TH_grouped <- case_when(
  Duree_TH_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_TH_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_TH_grouped <- table(data1$Douleur_TH[data1$Douleur_TH != "0"], Duree_TH_grouped)
print(table_contingence_duree_douleur_TH_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_TH_grouped))

######### Duree x Douleur CM ##########

## Nouvelle table
Duree_CM_sans_label <- factor(ifelse(is.na(data2$Depuis_CM), as.character(data2$Combien_CM), as.character(data2$Depuis_CM)))

Duree_CM_grouped <- case_when(
  Duree_CM_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_CM_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_CM_grouped <- table(data2$Douleur_CM[data2$Douleur_CM != "0"], Duree_CM_grouped)
print(table_contingence_duree_douleur_CM_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_CM_grouped))


######### Duree x Douleur Traitements médicameteux réunis ##########

table_contingence_duree_douleur_TM_grouped <- table_contingence_duree_douleur_TH_grouped + table_contingence_duree_douleur_CM_grouped

print(table_contingence_duree_douleur_TM_grouped)
print(chisq.test(table_contingence_duree_douleur_TM_grouped))


######### Duree x Douleur Mobilite ##########

## Nouvelle table
Duree_Mobilite_sans_label <- factor(ifelse(is.na(data3$Depuis_Mobilite_NM), as.character(data3$Combien_Mobilite_NM), as.character(data3$Depuis_Mobilite_NM)))

Duree_Mobilite_grouped <- case_when(
  Duree_Mobilite_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Mobilite_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Mobilite_grouped <- table(data3$Douleur_Mobilite_NM[data3$Douleur_Mobilite_NM != "0"], Duree_Mobilite_grouped)
print(table_contingence_duree_douleur_Mobilite_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Mobilite_grouped))

######### Duree x Douleur Nutrition ##########

## Nouvelle table
Duree_Nutrition_sans_label <- factor(ifelse(is.na(data3$Depuis_Nutrition_NM), as.character(data3$Combien_Nutrition_NM), as.character(data3$Depuis_Nutrition_NM)))

Duree_Nutrition_grouped <- case_when(
  Duree_Nutrition_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Nutrition_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Nutrition_grouped <- table(data3$Douleur_Nutrition_NM[data3$Douleur_Nutrition_NM != "0"], Duree_Nutrition_grouped)
print(table_contingence_duree_douleur_Nutrition_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Nutrition_grouped))


### Cas où absence d'augmentation de la douleur
table_contingence_duree_douleur_Nutrition_grouped_bis <- table_contingence_duree_douleur_Nutrition_grouped[-1, ]
print(table_contingence_duree_douleur_Nutrition_grouped_bis)
print(chisq.test(table_contingence_duree_douleur_Nutrition_grouped_bis))


######### Duree x Douleur Stress ##########

## Nouvelle table
Duree_Stress_sans_label <- factor(ifelse(is.na(data3$Depuis_Stress_NM), as.character(data3$Combien_Stress_NM), as.character(data3$Depuis_Stress_NM)))

Duree_Stress_grouped <- case_when(
  Duree_Stress_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Stress_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Stress_grouped <- table(data3$Douleur_Stress_NM[data3$Douleur_Stress_NM != "0"], Duree_Stress_grouped)
print(table_contingence_duree_douleur_Stress_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Stress_grouped))

### Cas où absence d'augmentation de la douleur
table_contingence_duree_douleur_Stress_grouped_bis <- table_contingence_duree_douleur_Stress_grouped[-1, ]
print(table_contingence_duree_douleur_Stress_grouped_bis)
print(chisq.test(table_contingence_duree_douleur_Stress_grouped_bis))


######### Duree x Douleur Phyto ##########

## Nouvelle table
Duree_Phyto_sans_label <- factor(ifelse(is.na(data3$Depuis_Phyto_NM), as.character(data3$Combien_Phyto_NM), as.character(data3$Depuis_Phyto_NM)))

Duree_Phyto_grouped <- case_when(
  Duree_Phyto_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Phyto_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Phyto_grouped <- table(data3$Douleur_Phyto_NM[data3$Douleur_Phyto_NM != "0"], Duree_Phyto_grouped)
print(table_contingence_duree_douleur_Phyto_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Phyto_grouped))

### Cas où absence d'augmentation de la douleur
table_contingence_duree_douleur_Phyto_grouped_bis <- table_contingence_duree_douleur_Phyto_grouped[-1, ]
print(table_contingence_duree_douleur_Phyto_grouped_bis)
print(chisq.test(table_contingence_duree_douleur_Phyto_grouped_bis))


######### Duree x Douleur Hypnose ##########

## Nouvelle table
Duree_Hypnose_sans_label <- factor(ifelse(is.na(data3$Depuis_Hypnose_NM), as.character(data3$Combien_Hypnose_NM), as.character(data3$Depuis_Hypnose_NM)))

Duree_Hypnose_grouped <- case_when(
  Duree_Hypnose_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Hypnose_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Hypnose_grouped <- table(data3$Douleur_Hypnose_NM[data3$Douleur_Hypnose_NM != "0"], Duree_Hypnose_grouped)
print(table_contingence_duree_douleur_Hypnose_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Hypnose_grouped))

### Cas où absence d'augmentation de la douleur
table_contingence_duree_douleur_Hypnose_grouped_bis <- table_contingence_duree_douleur_Hypnose_grouped[-1, ]
print(table_contingence_duree_douleur_Hypnose_grouped_bis)
print(chisq.test(table_contingence_duree_douleur_Hypnose_grouped_bis))


######### Duree x Douleur Acup ##########

## Nouvelle table
Duree_Acup_sans_label <- factor(ifelse(is.na(data3$Depuis_Acup_NM), as.character(data3$Combien_Acup_NM), as.character(data3$Depuis_Acup_NM)))

Duree_Acup_grouped <- case_when(
  Duree_Acup_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Acup_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Acup_grouped <- table(data3$Douleur_Acup_NM[data3$Douleur_Acup_NM != "0"], Duree_Acup_grouped)
print(table_contingence_duree_douleur_Acup_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Acup_grouped))


######### Duree x Douleur Bouillotte ##########

## Nouvelle table
Duree_Bouillotte_sans_label <- factor(ifelse(is.na(data3$Depuis_Bouillotte_NM), as.character(data3$Combien_Bouillotte_NM), as.character(data3$Depuis_Bouillotte_NM)))

Duree_Bouillotte_grouped <- case_when(
  Duree_Bouillotte_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Bouillotte_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Bouillotte_grouped <- table(data3$Douleur_Bouillotte_NM[data3$Douleur_Bouillotte_NM != "0"], Duree_Bouillotte_grouped)
print(table_contingence_duree_douleur_Bouillotte_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Bouillotte_grouped))

### Cas où absence d'augmentation de la douleur
table_contingence_duree_douleur_Bouillotte_grouped_bis <- table_contingence_duree_douleur_Bouillotte_grouped[-1, ]
print(table_contingence_duree_douleur_Bouillotte_grouped_bis)
print(chisq.test(table_contingence_duree_douleur_Bouillotte_grouped_bis))


######### Duree x Douleur CBD ##########

## Nouvelle table
Duree_CBD_sans_label <- factor(ifelse(is.na(data3$Depuis_CBD_NM), as.character(data3$Combien_CBD_NM), as.character(data3$Depuis_CBD_NM)))

Duree_CBD_grouped <- case_when(
  Duree_CBD_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_CBD_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois")


table_contingence_duree_douleur_CBD_grouped <- table(data3$Douleur_CBD_NM[data3$Douleur_CBD_NM != "0"], Duree_CBD_grouped)
print(table_contingence_duree_douleur_CBD_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_CBD_grouped))

### Cas où absence d'augmentation de la douleur
table_contingence_duree_douleur_CBD_grouped_bis <- table_contingence_duree_douleur_CBD_grouped[-1, ]
print(table_contingence_duree_douleur_CBD_grouped_bis)
print(chisq.test(table_contingence_duree_douleur_CBD_grouped_bis))


######### Duree x Douleur Tens ##########

## Nouvelle table
Duree_Tens_sans_label <- factor(ifelse(is.na(data3$Depuis_Tens_NM), as.character(data3$Combien_Tens_NM), as.character(data3$Depuis_Tens_NM)))

Duree_Tens_grouped <- case_when(
  Duree_Tens_sans_label %in% c("Moins de 3 mois", "Entre 3 et 6 mois") ~ "Moins de 6 mois",
  Duree_Tens_sans_label %in% c("Entre 6 mois et 2 ans", "Entre 2 et 5 ans", "Plus de 5 ans") ~ "Plus de 6 mois"
)

table_contingence_duree_douleur_Tens_grouped <- table(data3$Douleur_Tens_NM[data3$Douleur_Tens_NM != "0"], Duree_Tens_grouped)
print(table_contingence_duree_douleur_Tens_grouped)

## Test Khi-deux
print(chisq.test(table_contingence_duree_douleur_Tens_grouped))


```

Globalement permet de confirmer que TH, CM, Mobilite, Phyto et Tens + efficaces lorsqu'ils sont pris plus de 6 mois.
En revanche, aucune confirmation pour le CBD.


### Test de Chi_deux Tabac x Douleur

```{r}
# TH

print(table_contingence_tabac_douleur_TH)
print(chisq.test(table_contingence_tabac_douleur_TH))

# CM

print(table_contingence_tabac_douleur_CM)
print(chisq.test(table_contingence_tabac_douleur_CM))

# Mobilite

print(table_contingence_tabac_douleur_Mobilite)
print(chisq.test(table_contingence_tabac_douleur_Mobilite))

# Nutrition

print(table_contingence_tabac_douleur_Nutrition)
print(chisq.test(table_contingence_tabac_douleur_Nutrition))

print(table_contingence_tabac_douleur_Nutrition[,-1])
print(chisq.test(table_contingence_tabac_douleur_Nutrition[,-1]))

# Stress

print(table_contingence_tabac_douleur_Stress)
print(chisq.test(table_contingence_tabac_douleur_Stress))

print(table_contingence_tabac_douleur_Stress[,-1])
print(chisq.test(table_contingence_tabac_douleur_Stress[,-1]))

# Phyto

print(table_contingence_tabac_douleur_Phyto)
print(chisq.test(table_contingence_tabac_douleur_Phyto))

print(table_contingence_tabac_douleur_Phyto[,-1])
print(chisq.test(table_contingence_tabac_douleur_Phyto[,-1]))

# Hypnose

print(table_contingence_tabac_douleur_Hypnose)
print(chisq.test(table_contingence_tabac_douleur_Hypnose))

print(table_contingence_tabac_douleur_Hypnose[,-1])
print(chisq.test(table_contingence_tabac_douleur_Hypnose[,-1]))

# Acup

print(table_contingence_tabac_douleur_Acup)
print(chisq.test(table_contingence_tabac_douleur_Acup))

# Bouillotte

print(table_contingence_tabac_douleur_Bouillotte)
print(chisq.test(table_contingence_tabac_douleur_Bouillotte))

print(table_contingence_tabac_douleur_Bouillotte[,-1])
print(chisq.test(table_contingence_tabac_douleur_Bouillotte[,-1]))

# CBD

print(table_contingence_tabac_douleur_CBD)
print(chisq.test(table_contingence_tabac_douleur_CBD))

print(table_contingence_tabac_douleur_CBD[,-1])
print(chisq.test(table_contingence_tabac_douleur_CBD[,-1]))

# Tens

print(table_contingence_tabac_douleur_Tens)
print(chisq.test(table_contingence_tabac_douleur_Tens))
```

Pour tous : test de Khi-2 confirment que la consommation de tabac et la douleur ressentie au cours du traitement sont indépendantes.


### Test de Chi_deux Alcool x Douleur

```{r}
# TH

print(table_contingence_alcool_douleur_TH)
print(chisq.test(table_contingence_alcool_douleur_TH))

# CM

print(table_contingence_alcool_douleur_CM)
print(chisq.test(table_contingence_alcool_douleur_CM))

# Mobilite

print(table_contingence_alcool_douleur_Mobilite)
print(chisq.test(table_contingence_alcool_douleur_Mobilite))

# Nutrition

print(table_contingence_alcool_douleur_Nutrition)
print(chisq.test(table_contingence_alcool_douleur_Nutrition))

print(table_contingence_alcool_douleur_Nutrition[,-1])
print(chisq.test(table_contingence_alcool_douleur_Nutrition[,-1]))

# Stress

print(table_contingence_alcool_douleur_Stress)
print(chisq.test(table_contingence_alcool_douleur_Stress))

print(table_contingence_alcool_douleur_Stress[,-1])
print(chisq.test(table_contingence_alcool_douleur_Stress[,-1]))

# Phyto

print(table_contingence_alcool_douleur_Phyto)
print(chisq.test(table_contingence_alcool_douleur_Phyto))

print(table_contingence_alcool_douleur_Phyto[,-1])
print(chisq.test(table_contingence_alcool_douleur_Phyto[,-1]))

# Hypnose

print(table_contingence_alcool_douleur_Hypnose)
print(chisq.test(table_contingence_alcool_douleur_Hypnose))

print(table_contingence_alcool_douleur_Hypnose[,-1])
print(chisq.test(table_contingence_alcool_douleur_Hypnose[,-1]))

# Acup

print(table_contingence_alcool_douleur_Acup)
print(chisq.test(table_contingence_alcool_douleur_Acup))

# Bouillotte

print(table_contingence_alcool_douleur_Bouillotte)
print(chisq.test(table_contingence_alcool_douleur_Bouillotte))

print(table_contingence_alcool_douleur_Bouillotte[,-1])
print(chisq.test(table_contingence_alcool_douleur_Bouillotte[,-1]))

# CBD

print(table_contingence_alcool_douleur_CBD)
print(chisq.test(table_contingence_alcool_douleur_CBD))

print(table_contingence_alcool_douleur_CBD[,-1])
print(chisq.test(table_contingence_alcool_douleur_CBD[,-1]))

# Tens

print(table_contingence_alcool_douleur_Tens)
print(chisq.test(table_contingence_alcool_douleur_Tens))


```

Pour tous : test de Khi-2 confirment que la consommation d'alcool et la douleur ressentie au cours du traitement sont indépendantes.


### Test Chi_deux Apparition effets secondaires en fonction duree du traitement

```{r}
print(table_contingence_duree_ES_TH)
print(chisq.test(table_contingence_duree_ES_TH))

print(table_contingence_duree_ES_CM)
print(chisq.test(table_contingence_duree_ES_CM))

```

=> Comme prevu durée du traitement n'influence pas l'apparition des effets secondaires


### Test de Chi_deux Prise x Douleur

```{r}
print(table_contingence_prise_douleur_TH)
print(chisq.test(table_contingence_prise_douleur_TH))

print(table_contingence_prise_douleur_CM)
print(chisq.test(table_contingence_prise_douleur_CM))

print(table_contingence_prise_douleur_Mobilite)
print(chisq.test(table_contingence_prise_douleur_Mobilite))

print(table_contingence_prise_douleur_Nutrition)
print(chisq.test(table_contingence_prise_douleur_Nutrition))

print(table_contingence_prise_douleur_Stress)
print(chisq.test(table_contingence_prise_douleur_Stress))

print(table_contingence_prise_douleur_Phyto)
print(chisq.test(table_contingence_prise_douleur_Phyto))

print(table_contingence_prise_douleur_Hypnose)
print(chisq.test(table_contingence_prise_douleur_Hypnose))

print(table_contingence_prise_douleur_Acup)
print(chisq.test(table_contingence_prise_douleur_Acup))

print(table_contingence_prise_douleur_Bouillotte)
print(chisq.test(table_contingence_prise_douleur_Bouillotte))

print(table_contingence_prise_douleur_CBD)
print(chisq.test(table_contingence_prise_douleur_CBD))

print(table_contingence_prise_douleur_Tens)
print(chisq.test(table_contingence_prise_douleur_Tens))


```

Trop peu diversité des prises


### Test de Chi_deux Age x Douleur

```{r}

########## Creation des tranches d'age : 18-20 ; 21-25 ; 26-30 ...###########
bornes <- c(0, 25, 30, 35, 40, Inf)
labels <- c(" - de 25 ans", "26-30 ans", "31-35 ans", "36-40 ans", "+ de 40 ans")
Tranches_age <- cut(data$Age, breaks = bornes, labels = labels, right = FALSE)


###################### Age x Douleur TH #############################

table_contingence_age_douleur_TH <- table(Tranches_age[which(data$TH == 1)], data1$Douleur_TH[data1$Douleur_TH != "0"])
print(table_contingence_age_douleur_TH)

mosaicplot(table_contingence_age_douleur_TH)

print(chisq.test(table_contingence_age_douleur_TH))



###################### Age x Douleur CM ############################

table_contingence_age_douleur_CM <- table(Tranches_age[which(data$CM == 1)], data2$Douleur_CM[data2$Douleur_CM != "0"])
print(table_contingence_age_douleur_CM)

mosaicplot(table_contingence_age_douleur_CM)

print(chisq.test(table_contingence_age_douleur_CM))


###################### Age x Douleur Mobilite ############################

table_contingence_age_douleur_Mobilite <- table(Tranches_age[which(data$Mobilite_NM == 1)], dataM$Douleur_Mobilite_NM[dataM$Douleur_Mobilite_NM != "0"])
print(table_contingence_age_douleur_Mobilite)

mosaicplot(table_contingence_age_douleur_Mobilite)

print(chisq.test(table_contingence_age_douleur_Mobilite))


###################### Age x Douleur Nutrition ############################

table_contingence_age_douleur_Nutrition <- table(Tranches_age[which(data$Nutrition_NM == 1)], dataN$Douleur_Nutrition_NM[dataN$Douleur_Nutrition_NM != "0"])
print(table_contingence_age_douleur_Nutrition)

mosaicplot(table_contingence_age_douleur_Nutrition)

print(chisq.test(table_contingence_age_douleur_Nutrition))


###################### Age x Douleur Stress ############################

table_contingence_age_douleur_Stress <- table(Tranches_age[which(data$Stress_NM == 1)], dataS$Douleur_Stress_NM[dataS$Douleur_Stress_NM != "0"])
print(table_contingence_age_douleur_Stress)

mosaicplot(table_contingence_age_douleur_Stress)

print(chisq.test(table_contingence_age_douleur_Stress))


###################### Age x Douleur Phyto ############################

table_contingence_age_douleur_Phyto <- table(Tranches_age[which(data$Phyto_NM == 1)], dataP$Douleur_Phyto_NM[dataP$Douleur_Phyto_NM != "0"])
print(table_contingence_age_douleur_Phyto)

mosaicplot(table_contingence_age_douleur_Phyto)

print(chisq.test(table_contingence_age_douleur_Phyto))


###################### Age x Douleur Hypnose ############################

#table_contingence_age_douleur_Hypnose <- table(Tranches_age[which(data$Hypnose_NM == 1)], dataH$Douleur_Hypnose_NM[dataH$Douleur_Hypnose_NM != "0"])
#print(table_contingence_age_douleur_Hypnose)

#mosaicplot(table_contingence_age_douleur_Hypnose)

#print(chisq.test(table_contingence_age_douleur_Hypnose))


###################### Age x Douleur Acup ############################

table_contingence_age_douleur_Acup <- table(Tranches_age[which(data$Acup_NM == 1)], dataA$Douleur_Acup_NM[dataA$Douleur_Acup_NM != "0"])
print(table_contingence_age_douleur_Acup)

mosaicplot(table_contingence_age_douleur_Acup)

print(chisq.test(table_contingence_age_douleur_Acup))


###################### Age x Douleur Bouillotte ############################

#table_contingence_age_douleur_Bouillotte <- table(Tranches_age[which(data$Bouillotte_NM == 1)], dataB$Douleur_Bouillotte_NM[dataB$Douleur_Bouillotte_NM != "0"])
#print(table_contingence_age_douleur_Bouillotte)

#mosaicplot(table_contingence_age_douleur_Bouillotte)

#print(chisq.test(table_contingence_age_douleur_Bouillotte))


###################### Age x Douleur CBD ############################

table_contingence_age_douleur_CBD <- table(Tranches_age[which(data$CBD_NM == 1)], dataC$Douleur_CBD_NM[dataC$Douleur_CBD_NM != "0"])
print(table_contingence_age_douleur_CBD)

mosaicplot(table_contingence_age_douleur_CBD)

print(chisq.test(table_contingence_age_douleur_CBD))


###################### Age x Douleur Tens ############################

table_contingence_age_douleur_Tens <- table(Tranches_age[which(data$Tens_NM == 1)], dataT$Douleur_Tens_NM[dataT$Douleur_Tens_NM != "0"])
print(table_contingence_age_douleur_Tens)

mosaicplot(table_contingence_age_douleur_Tens)

print(chisq.test(table_contingence_age_douleur_Tens))

```

### Test de Chi_deux Age x ES

```{r}
########## Age x Effets secondaires TH ##########

table_contingence_age_ES_TH <- table(Tranches_age[which(data$Subi_ES_TH != "0")], data1$Subi_ES_TH[data1$Subi_ES_TH != "0"])
print(table_contingence_age_ES_TH)

mosaicplot(table_contingence_age_ES_TH)

print(chisq.test(table_contingence_age_ES_TH))


########## Age x Effets secondaires CM ##########

table_contingence_age_ES_CM <- table(Tranches_age[which(data$Subi_ES_CM != "0")], data2$Subi_ES_CM[data2$Subi_ES_CM != "0"])
print(table_contingence_age_ES_CM)

mosaicplot(table_contingence_age_ES_CM)

print(chisq.test(table_contingence_age_ES_CM))


```


Non probleme sur age : il faut age au moment du traitement si jms il y a eu arrêt



## AMC sur TOUTES les variables

```{r}

# Convertir toutes les variables en facteurs
data_facteurs <- lapply(data, function(x) {
  if(is.factor(x) || is.ordered(x)) {
    as.factor(x)
  } else if (is.numeric(x) || is.character(x)) {
    as.factor(as.character(x))
  } else {
    x
  }
})

data_facteurs <- as.data.frame(data_facteurs, stringsAsFactors = TRUE)
data_facteurs_subset <- data_facteurs[, -c(10, (ncol(data_facteurs)-2):ncol(data_facteurs))] #Colonnes à exclure


res.mca <- MCA(data_facteurs_subset, graph = FALSE)
print(res.mca)

head(res.mca$eig)

fviz_screeplot(res.mca, addlabels=TRUE, ncp=20)

fviz_mca_biplot(res.mca,select.var = list(cos2=0.5, contrib =10), repel = TRUE, label = "var")

fviz_mca_var(res.mca, choice="mca.cor")

help(fviz_mca_biplot)
```



